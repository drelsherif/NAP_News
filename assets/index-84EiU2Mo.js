(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function dx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ux={exports:{}},Ac={},fx={exports:{}},Q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tl=Symbol.for("react.element"),hS=Symbol.for("react.portal"),mS=Symbol.for("react.fragment"),gS=Symbol.for("react.strict_mode"),yS=Symbol.for("react.profiler"),xS=Symbol.for("react.provider"),vS=Symbol.for("react.context"),bS=Symbol.for("react.forward_ref"),SS=Symbol.for("react.suspense"),wS=Symbol.for("react.memo"),kS=Symbol.for("react.lazy"),rm=Symbol.iterator;function CS(t){return t===null||typeof t!="object"?null:(t=rm&&t[rm]||t["@@iterator"],typeof t=="function"?t:null)}var px={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hx=Object.assign,mx={};function vo(t,e,n){this.props=t,this.context=e,this.refs=mx,this.updater=n||px}vo.prototype.isReactComponent={};vo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gx(){}gx.prototype=vo.prototype;function ap(t,e,n){this.props=t,this.context=e,this.refs=mx,this.updater=n||px}var cp=ap.prototype=new gx;cp.constructor=ap;hx(cp,vo.prototype);cp.isPureReactComponent=!0;var im=Array.isArray,yx=Object.prototype.hasOwnProperty,dp={current:null},xx={key:!0,ref:!0,__self:!0,__source:!0};function vx(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)yx.call(e,r)&&!xx.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:tl,type:t,key:o,ref:s,props:i,_owner:dp.current}}function ES(t,e){return{$$typeof:tl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function up(t){return typeof t=="object"&&t!==null&&t.$$typeof===tl}function MS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var om=/\/+/g;function gd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MS(""+t.key):e.toString(36)}function ql(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case tl:case hS:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+gd(s,0):r,im(i)?(n="",t!=null&&(n=t.replace(om,"$&/")+"/"),ql(i,e,n,"",function(c){return c})):i!=null&&(up(i)&&(i=ES(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(om,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",im(t))for(var l=0;l<t.length;l++){o=t[l];var a=r+gd(o,l);s+=ql(o,e,n,a,i)}else if(a=CS(t),typeof a=="function")for(t=a.call(t),l=0;!(o=t.next()).done;)o=o.value,a=r+gd(o,l++),s+=ql(o,e,n,a,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function ml(t,e,n){if(t==null)return t;var r=[],i=0;return ql(t,r,"","",function(o){return e.call(n,o,i++)}),r}function TS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mt={current:null},Jl={transition:null},jS={ReactCurrentDispatcher:mt,ReactCurrentBatchConfig:Jl,ReactCurrentOwner:dp};function bx(){throw Error("act(...) is not supported in production builds of React.")}Q.Children={map:ml,forEach:function(t,e,n){ml(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ml(t,function(){e++}),e},toArray:function(t){return ml(t,function(e){return e})||[]},only:function(t){if(!up(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Q.Component=vo;Q.Fragment=mS;Q.Profiler=yS;Q.PureComponent=ap;Q.StrictMode=gS;Q.Suspense=SS;Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jS;Q.act=bx;Q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=hx({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=dp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)yx.call(e,a)&&!xx.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:tl,type:t.type,key:i,ref:o,props:r,_owner:s}};Q.createContext=function(t){return t={$$typeof:vS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xS,_context:t},t.Consumer=t};Q.createElement=vx;Q.createFactory=function(t){var e=vx.bind(null,t);return e.type=t,e};Q.createRef=function(){return{current:null}};Q.forwardRef=function(t){return{$$typeof:bS,render:t}};Q.isValidElement=up;Q.lazy=function(t){return{$$typeof:kS,_payload:{_status:-1,_result:t},_init:TS}};Q.memo=function(t,e){return{$$typeof:wS,type:t,compare:e===void 0?null:e}};Q.startTransition=function(t){var e=Jl.transition;Jl.transition={};try{t()}finally{Jl.transition=e}};Q.unstable_act=bx;Q.useCallback=function(t,e){return mt.current.useCallback(t,e)};Q.useContext=function(t){return mt.current.useContext(t)};Q.useDebugValue=function(){};Q.useDeferredValue=function(t){return mt.current.useDeferredValue(t)};Q.useEffect=function(t,e){return mt.current.useEffect(t,e)};Q.useId=function(){return mt.current.useId()};Q.useImperativeHandle=function(t,e,n){return mt.current.useImperativeHandle(t,e,n)};Q.useInsertionEffect=function(t,e){return mt.current.useInsertionEffect(t,e)};Q.useLayoutEffect=function(t,e){return mt.current.useLayoutEffect(t,e)};Q.useMemo=function(t,e){return mt.current.useMemo(t,e)};Q.useReducer=function(t,e,n){return mt.current.useReducer(t,e,n)};Q.useRef=function(t){return mt.current.useRef(t)};Q.useState=function(t){return mt.current.useState(t)};Q.useSyncExternalStore=function(t,e,n){return mt.current.useSyncExternalStore(t,e,n)};Q.useTransition=function(){return mt.current.useTransition()};Q.version="18.3.1";fx.exports=Q;var S=fx.exports;const ee=dx(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DS=S,AS=Symbol.for("react.element"),IS=Symbol.for("react.fragment"),RS=Object.prototype.hasOwnProperty,zS=DS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$S={key:!0,ref:!0,__self:!0,__source:!0};function Sx(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)RS.call(e,r)&&!$S.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:AS,type:t,key:o,ref:s,props:i,_owner:zS.current}}Ac.Fragment=IS;Ac.jsx=Sx;Ac.jsxs=Sx;ux.exports=Ac;var d=ux.exports,Mu={},wx={exports:{}},Nt={},kx={exports:{}},Cx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,U){var W=N.length;N.push(U);e:for(;0<W;){var X=W-1>>>1,Z=N[X];if(0<i(Z,U))N[X]=U,N[W]=Z,W=X;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var U=N[0],W=N.pop();if(W!==U){N[0]=W;e:for(var X=0,Z=N.length,tt=Z>>>1;X<tt;){var Ue=2*(X+1)-1,tn=N[Ue],ye=Ue+1,nn=N[ye];if(0>i(tn,W))ye<Z&&0>i(nn,tn)?(N[X]=nn,N[ye]=W,X=ye):(N[X]=tn,N[Ue]=W,X=Ue);else if(ye<Z&&0>i(nn,W))N[X]=nn,N[ye]=W,X=ye;else break e}}return U}function i(N,U){var W=N.sortIndex-U.sortIndex;return W!==0?W:N.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var a=[],c=[],u=1,f=null,p=3,h=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(N){for(var U=n(c);U!==null;){if(U.callback===null)r(c);else if(U.startTime<=N)r(c),U.sortIndex=U.expirationTime,e(a,U);else break;U=n(c)}}function w(N){if(g=!1,b(N),!m)if(n(a)!==null)m=!0,Ee(C);else{var U=n(c);U!==null&&ue(w,U.startTime-N)}}function C(N,U){m=!1,g&&(g=!1,y(M),M=-1),h=!0;var W=p;try{for(b(U),f=n(a);f!==null&&(!(f.expirationTime>U)||N&&!_());){var X=f.callback;if(typeof X=="function"){f.callback=null,p=f.priorityLevel;var Z=X(f.expirationTime<=U);U=t.unstable_now(),typeof Z=="function"?f.callback=Z:f===n(a)&&r(a),b(U)}else r(a);f=n(a)}if(f!==null)var tt=!0;else{var Ue=n(c);Ue!==null&&ue(w,Ue.startTime-U),tt=!1}return tt}finally{f=null,p=W,h=!1}}var E=!1,k=null,M=-1,$=5,O=-1;function _(){return!(t.unstable_now()-O<$)}function oe(){if(k!==null){var N=t.unstable_now();O=N;var U=!0;try{U=k(!0,N)}finally{U?ae():(E=!1,k=null)}}else E=!1}var ae;if(typeof x=="function")ae=function(){x(oe)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Oe=me.port2;me.port1.onmessage=oe,ae=function(){Oe.postMessage(null)}}else ae=function(){v(oe,0)};function Ee(N){k=N,E||(E=!0,ae())}function ue(N,U){M=v(function(){N(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,Ee(C))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(N){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var W=p;p=U;try{return N()}finally{p=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var W=p;p=N;try{return U()}finally{p=W}},t.unstable_scheduleCallback=function(N,U,W){var X=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?X+W:X):W=X,N){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=W+Z,N={id:u++,callback:U,priorityLevel:N,startTime:W,expirationTime:Z,sortIndex:-1},W>X?(N.sortIndex=W,e(c,N),n(a)===null&&N===n(c)&&(g?(y(M),M=-1):g=!0,ue(w,W-X))):(N.sortIndex=Z,e(a,N),m||h||(m=!0,Ee(C))),N},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(N){var U=p;return function(){var W=p;p=U;try{return N.apply(this,arguments)}finally{p=W}}}})(Cx);kx.exports=Cx;var OS=kx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NS=S,$t=OS;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ex=new Set,bs={};function Si(t,e){oo(t,e),oo(t+"Capture",e)}function oo(t,e){for(bs[t]=e,t=0;t<e.length;t++)Ex.add(e[t])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tu=Object.prototype.hasOwnProperty,LS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sm={},lm={};function PS(t){return Tu.call(lm,t)?!0:Tu.call(sm,t)?!1:LS.test(t)?lm[t]=!0:(sm[t]=!0,!1)}function FS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function BS(t,e,n,r){if(e===null||typeof e>"u"||FS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gt(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xe[t]=new gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xe[e]=new gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xe[t]=new gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xe[t]=new gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xe[t]=new gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xe[t]=new gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xe[t]=new gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xe[t]=new gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xe[t]=new gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var fp=/[\-:]([a-z])/g;function pp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fp,pp);Xe[e]=new gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fp,pp);Xe[e]=new gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fp,pp);Xe[e]=new gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xe[t]=new gt(t,1,!1,t.toLowerCase(),null,!1,!1)});Xe.xlinkHref=new gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xe[t]=new gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function hp(t,e,n,r){var i=Xe.hasOwnProperty(e)?Xe[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(BS(e,n,i,r)&&(n=null),r||i===null?PS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gn=NS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gl=Symbol.for("react.element"),Ni=Symbol.for("react.portal"),Li=Symbol.for("react.fragment"),mp=Symbol.for("react.strict_mode"),ju=Symbol.for("react.profiler"),Mx=Symbol.for("react.provider"),Tx=Symbol.for("react.context"),gp=Symbol.for("react.forward_ref"),Du=Symbol.for("react.suspense"),Au=Symbol.for("react.suspense_list"),yp=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),jx=Symbol.for("react.offscreen"),am=Symbol.iterator;function Io(t){return t===null||typeof t!="object"?null:(t=am&&t[am]||t["@@iterator"],typeof t=="function"?t:null)}var be=Object.assign,yd;function Ho(t){if(yd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yd=e&&e[1]||""}return`
`+yd+t}var xd=!1;function vd(t,e){if(!t||xd)return"";xd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=s&&0<=l);break}}}finally{xd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ho(t):""}function _S(t){switch(t.tag){case 5:return Ho(t.type);case 16:return Ho("Lazy");case 13:return Ho("Suspense");case 19:return Ho("SuspenseList");case 0:case 2:case 15:return t=vd(t.type,!1),t;case 11:return t=vd(t.type.render,!1),t;case 1:return t=vd(t.type,!0),t;default:return""}}function Iu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Li:return"Fragment";case Ni:return"Portal";case ju:return"Profiler";case mp:return"StrictMode";case Du:return"Suspense";case Au:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Tx:return(t.displayName||"Context")+".Consumer";case Mx:return(t._context.displayName||"Context")+".Provider";case gp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yp:return e=t.displayName||null,e!==null?e:Iu(t.type)||"Memo";case or:e=t._payload,t=t._init;try{return Iu(t(e))}catch{}}return null}function HS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iu(e);case 8:return e===mp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Dx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function US(t){var e=Dx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yl(t){t._valueTracker||(t._valueTracker=US(t))}function Ax(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Dx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ua(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ru(t,e){var n=e.checked;return be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function cm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Rr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ix(t,e){e=e.checked,e!=null&&hp(t,"checked",e,!1)}function zu(t,e){Ix(t,e);var n=Rr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$u(t,e.type,n):e.hasOwnProperty("defaultValue")&&$u(t,e.type,Rr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function dm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $u(t,e,n){(e!=="number"||ua(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Uo=Array.isArray;function Yi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Rr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ou(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function um(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(Uo(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Rr(n)}}function Rx(t,e){var n=Rr(e.value),r=Rr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function fm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var xl,$x=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(xl=xl||document.createElement("div"),xl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ss(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VS=["Webkit","ms","Moz","O"];Object.keys(Yo).forEach(function(t){VS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yo[e]=Yo[t]})});function Ox(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yo.hasOwnProperty(t)&&Yo[t]?(""+e).trim():e+"px"}function Nx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Ox(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var WS=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lu(t,e){if(e){if(WS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function Pu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fu=null;function xp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bu=null,Qi=null,Xi=null;function pm(t){if(t=il(t)){if(typeof Bu!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Oc(e),Bu(t.stateNode,t.type,e))}}function Lx(t){Qi?Xi?Xi.push(t):Xi=[t]:Qi=t}function Px(){if(Qi){var t=Qi,e=Xi;if(Xi=Qi=null,pm(t),e)for(t=0;t<e.length;t++)pm(e[t])}}function Fx(t,e){return t(e)}function Bx(){}var bd=!1;function _x(t,e,n){if(bd)return t(e,n);bd=!0;try{return Fx(t,e,n)}finally{bd=!1,(Qi!==null||Xi!==null)&&(Bx(),Px())}}function ws(t,e){var n=t.stateNode;if(n===null)return null;var r=Oc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var _u=!1;if(Wn)try{var Ro={};Object.defineProperty(Ro,"passive",{get:function(){_u=!0}}),window.addEventListener("test",Ro,Ro),window.removeEventListener("test",Ro,Ro)}catch{_u=!1}function KS(t,e,n,r,i,o,s,l,a){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Qo=!1,fa=null,pa=!1,Hu=null,qS={onError:function(t){Qo=!0,fa=t}};function JS(t,e,n,r,i,o,s,l,a){Qo=!1,fa=null,KS.apply(qS,arguments)}function GS(t,e,n,r,i,o,s,l,a){if(JS.apply(this,arguments),Qo){if(Qo){var c=fa;Qo=!1,fa=null}else throw Error(z(198));pa||(pa=!0,Hu=c)}}function wi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Hx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function hm(t){if(wi(t)!==t)throw Error(z(188))}function YS(t){var e=t.alternate;if(!e){if(e=wi(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return hm(i),t;if(o===r)return hm(i),e;o=o.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function Ux(t){return t=YS(t),t!==null?Vx(t):null}function Vx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Vx(t);if(e!==null)return e;t=t.sibling}return null}var Wx=$t.unstable_scheduleCallback,mm=$t.unstable_cancelCallback,QS=$t.unstable_shouldYield,XS=$t.unstable_requestPaint,Te=$t.unstable_now,ZS=$t.unstable_getCurrentPriorityLevel,vp=$t.unstable_ImmediatePriority,Kx=$t.unstable_UserBlockingPriority,ha=$t.unstable_NormalPriority,ew=$t.unstable_LowPriority,qx=$t.unstable_IdlePriority,Ic=null,En=null;function tw(t){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Ic,t,void 0,(t.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:iw,nw=Math.log,rw=Math.LN2;function iw(t){return t>>>=0,t===0?32:31-(nw(t)/rw|0)|0}var vl=64,bl=4194304;function Vo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ma(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var l=s&~i;l!==0?r=Vo(l):(o&=s,o!==0&&(r=Vo(o)))}else s=n&~i,s!==0?r=Vo(s):o!==0&&(r=Vo(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-dn(e),i=1<<n,r|=t[n],e&=~i;return r}function ow(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sw(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-dn(o),l=1<<s,a=i[s];a===-1?(!(l&n)||l&r)&&(i[s]=ow(l,e)):a<=e&&(t.expiredLanes|=l),o&=~l}}function Uu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Jx(){var t=vl;return vl<<=1,!(vl&4194240)&&(vl=64),t}function Sd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dn(e),t[e]=n}function lw(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-dn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function bp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-dn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var se=0;function Gx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Yx,Sp,Qx,Xx,Zx,Vu=!1,Sl=[],br=null,Sr=null,wr=null,ks=new Map,Cs=new Map,ur=[],aw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(t,e){switch(t){case"focusin":case"focusout":br=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":ks.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cs.delete(e.pointerId)}}function zo(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=il(e),e!==null&&Sp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function cw(t,e,n,r,i){switch(e){case"focusin":return br=zo(br,t,e,n,r,i),!0;case"dragenter":return Sr=zo(Sr,t,e,n,r,i),!0;case"mouseover":return wr=zo(wr,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ks.set(o,zo(ks.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Cs.set(o,zo(Cs.get(o)||null,t,e,n,r,i)),!0}return!1}function e0(t){var e=Jr(t.target);if(e!==null){var n=wi(e);if(n!==null){if(e=n.tag,e===13){if(e=Hx(n),e!==null){t.blockedOn=e,Zx(t.priority,function(){Qx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Fu=r,n.target.dispatchEvent(r),Fu=null}else return e=il(n),e!==null&&Sp(e),t.blockedOn=n,!1;e.shift()}return!0}function ym(t,e,n){Gl(t)&&n.delete(e)}function dw(){Vu=!1,br!==null&&Gl(br)&&(br=null),Sr!==null&&Gl(Sr)&&(Sr=null),wr!==null&&Gl(wr)&&(wr=null),ks.forEach(ym),Cs.forEach(ym)}function $o(t,e){t.blockedOn===e&&(t.blockedOn=null,Vu||(Vu=!0,$t.unstable_scheduleCallback($t.unstable_NormalPriority,dw)))}function Es(t){function e(i){return $o(i,t)}if(0<Sl.length){$o(Sl[0],t);for(var n=1;n<Sl.length;n++){var r=Sl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(br!==null&&$o(br,t),Sr!==null&&$o(Sr,t),wr!==null&&$o(wr,t),ks.forEach(e),Cs.forEach(e),n=0;n<ur.length;n++)r=ur[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ur.length&&(n=ur[0],n.blockedOn===null);)e0(n),n.blockedOn===null&&ur.shift()}var Zi=Gn.ReactCurrentBatchConfig,ga=!0;function uw(t,e,n,r){var i=se,o=Zi.transition;Zi.transition=null;try{se=1,wp(t,e,n,r)}finally{se=i,Zi.transition=o}}function fw(t,e,n,r){var i=se,o=Zi.transition;Zi.transition=null;try{se=4,wp(t,e,n,r)}finally{se=i,Zi.transition=o}}function wp(t,e,n,r){if(ga){var i=Wu(t,e,n,r);if(i===null)Id(t,e,r,ya,n),gm(t,r);else if(cw(i,t,e,n,r))r.stopPropagation();else if(gm(t,r),e&4&&-1<aw.indexOf(t)){for(;i!==null;){var o=il(i);if(o!==null&&Yx(o),o=Wu(t,e,n,r),o===null&&Id(t,e,r,ya,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Id(t,e,r,null,n)}}var ya=null;function Wu(t,e,n,r){if(ya=null,t=xp(r),t=Jr(t),t!==null)if(e=wi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Hx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ya=t,null}function t0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZS()){case vp:return 1;case Kx:return 4;case ha:case ew:return 16;case qx:return 536870912;default:return 16}default:return 16}}var mr=null,kp=null,Yl=null;function n0(){if(Yl)return Yl;var t,e=kp,n=e.length,r,i="value"in mr?mr.value:mr.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return Yl=i.slice(t,1<r?1-r:void 0)}function Ql(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wl(){return!0}function xm(){return!1}function Lt(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?wl:xm,this.isPropagationStopped=xm,this}return be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wl)},persist:function(){},isPersistent:wl}),e}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cp=Lt(bo),rl=be({},bo,{view:0,detail:0}),pw=Lt(rl),wd,kd,Oo,Rc=be({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ep,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Oo&&(Oo&&t.type==="mousemove"?(wd=t.screenX-Oo.screenX,kd=t.screenY-Oo.screenY):kd=wd=0,Oo=t),wd)},movementY:function(t){return"movementY"in t?t.movementY:kd}}),vm=Lt(Rc),hw=be({},Rc,{dataTransfer:0}),mw=Lt(hw),gw=be({},rl,{relatedTarget:0}),Cd=Lt(gw),yw=be({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),xw=Lt(yw),vw=be({},bo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bw=Lt(vw),Sw=be({},bo,{data:0}),bm=Lt(Sw),ww={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ew(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Cw[t])?!!e[t]:!1}function Ep(){return Ew}var Mw=be({},rl,{key:function(t){if(t.key){var e=ww[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ql(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ep,charCode:function(t){return t.type==="keypress"?Ql(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ql(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Tw=Lt(Mw),jw=be({},Rc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sm=Lt(jw),Dw=be({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ep}),Aw=Lt(Dw),Iw=be({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rw=Lt(Iw),zw=be({},Rc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$w=Lt(zw),Ow=[9,13,27,32],Mp=Wn&&"CompositionEvent"in window,Xo=null;Wn&&"documentMode"in document&&(Xo=document.documentMode);var Nw=Wn&&"TextEvent"in window&&!Xo,r0=Wn&&(!Mp||Xo&&8<Xo&&11>=Xo),wm=" ",km=!1;function i0(t,e){switch(t){case"keyup":return Ow.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pi=!1;function Lw(t,e){switch(t){case"compositionend":return o0(e);case"keypress":return e.which!==32?null:(km=!0,wm);case"textInput":return t=e.data,t===wm&&km?null:t;default:return null}}function Pw(t,e){if(Pi)return t==="compositionend"||!Mp&&i0(t,e)?(t=n0(),Yl=kp=mr=null,Pi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return r0&&e.locale!=="ko"?null:e.data;default:return null}}var Fw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Fw[t.type]:e==="textarea"}function s0(t,e,n,r){Lx(r),e=xa(e,"onChange"),0<e.length&&(n=new Cp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zo=null,Ms=null;function Bw(t){y0(t,0)}function zc(t){var e=_i(t);if(Ax(e))return t}function _w(t,e){if(t==="change")return e}var l0=!1;if(Wn){var Ed;if(Wn){var Md="oninput"in document;if(!Md){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),Md=typeof Em.oninput=="function"}Ed=Md}else Ed=!1;l0=Ed&&(!document.documentMode||9<document.documentMode)}function Mm(){Zo&&(Zo.detachEvent("onpropertychange",a0),Ms=Zo=null)}function a0(t){if(t.propertyName==="value"&&zc(Ms)){var e=[];s0(e,Ms,t,xp(t)),_x(Bw,e)}}function Hw(t,e,n){t==="focusin"?(Mm(),Zo=e,Ms=n,Zo.attachEvent("onpropertychange",a0)):t==="focusout"&&Mm()}function Uw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return zc(Ms)}function Vw(t,e){if(t==="click")return zc(e)}function Ww(t,e){if(t==="input"||t==="change")return zc(e)}function Kw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fn=typeof Object.is=="function"?Object.is:Kw;function Ts(t,e){if(fn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tu.call(e,i)||!fn(t[i],e[i]))return!1}return!0}function Tm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jm(t,e){var n=Tm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Tm(n)}}function c0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?c0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function d0(){for(var t=window,e=ua();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ua(t.document)}return e}function Tp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function qw(t){var e=d0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&c0(n.ownerDocument.documentElement,n)){if(r!==null&&Tp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=jm(n,o);var s=jm(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Jw=Wn&&"documentMode"in document&&11>=document.documentMode,Fi=null,Ku=null,es=null,qu=!1;function Dm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qu||Fi==null||Fi!==ua(r)||(r=Fi,"selectionStart"in r&&Tp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),es&&Ts(es,r)||(es=r,r=xa(Ku,"onSelect"),0<r.length&&(e=new Cp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Fi)))}function kl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bi={animationend:kl("Animation","AnimationEnd"),animationiteration:kl("Animation","AnimationIteration"),animationstart:kl("Animation","AnimationStart"),transitionend:kl("Transition","TransitionEnd")},Td={},u0={};Wn&&(u0=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function $c(t){if(Td[t])return Td[t];if(!Bi[t])return t;var e=Bi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in u0)return Td[t]=e[n];return t}var f0=$c("animationend"),p0=$c("animationiteration"),h0=$c("animationstart"),m0=$c("transitionend"),g0=new Map,Am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(t,e){g0.set(t,e),Si(e,[t])}for(var jd=0;jd<Am.length;jd++){var Dd=Am[jd],Gw=Dd.toLowerCase(),Yw=Dd[0].toUpperCase()+Dd.slice(1);Or(Gw,"on"+Yw)}Or(f0,"onAnimationEnd");Or(p0,"onAnimationIteration");Or(h0,"onAnimationStart");Or("dblclick","onDoubleClick");Or("focusin","onFocus");Or("focusout","onBlur");Or(m0,"onTransitionEnd");oo("onMouseEnter",["mouseout","mouseover"]);oo("onMouseLeave",["mouseout","mouseover"]);oo("onPointerEnter",["pointerout","pointerover"]);oo("onPointerLeave",["pointerout","pointerover"]);Si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Si("onBeforeInput",["compositionend","keypress","textInput","paste"]);Si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function Im(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,GS(r,e,void 0,t),t.currentTarget=null}function y0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,c=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;Im(i,l,c),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,c=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;Im(i,l,c),o=a}}}if(pa)throw t=Hu,pa=!1,Hu=null,t}function fe(t,e){var n=e[Xu];n===void 0&&(n=e[Xu]=new Set);var r=t+"__bubble";n.has(r)||(x0(e,t,2,!1),n.add(r))}function Ad(t,e,n){var r=0;e&&(r|=4),x0(n,t,r,e)}var Cl="_reactListening"+Math.random().toString(36).slice(2);function js(t){if(!t[Cl]){t[Cl]=!0,Ex.forEach(function(n){n!=="selectionchange"&&(Qw.has(n)||Ad(n,!1,t),Ad(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cl]||(e[Cl]=!0,Ad("selectionchange",!1,e))}}function x0(t,e,n,r){switch(t0(e)){case 1:var i=uw;break;case 4:i=fw;break;default:i=wp}n=i.bind(null,e,n,t),i=void 0,!_u||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Id(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Jr(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}_x(function(){var c=o,u=xp(n),f=[];e:{var p=g0.get(t);if(p!==void 0){var h=Cp,m=t;switch(t){case"keypress":if(Ql(n)===0)break e;case"keydown":case"keyup":h=Tw;break;case"focusin":m="focus",h=Cd;break;case"focusout":m="blur",h=Cd;break;case"beforeblur":case"afterblur":h=Cd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=mw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Aw;break;case f0:case p0:case h0:h=xw;break;case m0:h=Rw;break;case"scroll":h=pw;break;case"wheel":h=$w;break;case"copy":case"cut":case"paste":h=bw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Sm}var g=(e&4)!==0,v=!g&&t==="scroll",y=g?p!==null?p+"Capture":null:p;g=[];for(var x=c,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,y!==null&&(w=ws(x,y),w!=null&&g.push(Ds(x,w,b)))),v)break;x=x.return}0<g.length&&(p=new h(p,m,null,n,u),f.push({event:p,listeners:g}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",p&&n!==Fu&&(m=n.relatedTarget||n.fromElement)&&(Jr(m)||m[Kn]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Jr(m):null,m!==null&&(v=wi(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=c),h!==m)){if(g=vm,w="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=Sm,w="onPointerLeave",y="onPointerEnter",x="pointer"),v=h==null?p:_i(h),b=m==null?p:_i(m),p=new g(w,x+"leave",h,n,u),p.target=v,p.relatedTarget=b,w=null,Jr(u)===c&&(g=new g(y,x+"enter",m,n,u),g.target=b,g.relatedTarget=v,w=g),v=w,h&&m)t:{for(g=h,y=m,x=0,b=g;b;b=Ai(b))x++;for(b=0,w=y;w;w=Ai(w))b++;for(;0<x-b;)g=Ai(g),x--;for(;0<b-x;)y=Ai(y),b--;for(;x--;){if(g===y||y!==null&&g===y.alternate)break t;g=Ai(g),y=Ai(y)}g=null}else g=null;h!==null&&Rm(f,p,h,g,!1),m!==null&&v!==null&&Rm(f,v,m,g,!0)}}e:{if(p=c?_i(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var C=_w;else if(Cm(p))if(l0)C=Ww;else{C=Uw;var E=Hw}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=Vw);if(C&&(C=C(t,c))){s0(f,C,n,u);break e}E&&E(t,p,c),t==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&$u(p,"number",p.value)}switch(E=c?_i(c):window,t){case"focusin":(Cm(E)||E.contentEditable==="true")&&(Fi=E,Ku=c,es=null);break;case"focusout":es=Ku=Fi=null;break;case"mousedown":qu=!0;break;case"contextmenu":case"mouseup":case"dragend":qu=!1,Dm(f,n,u);break;case"selectionchange":if(Jw)break;case"keydown":case"keyup":Dm(f,n,u)}var k;if(Mp)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Pi?i0(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(r0&&n.locale!=="ko"&&(Pi||M!=="onCompositionStart"?M==="onCompositionEnd"&&Pi&&(k=n0()):(mr=u,kp="value"in mr?mr.value:mr.textContent,Pi=!0)),E=xa(c,M),0<E.length&&(M=new bm(M,t,null,n,u),f.push({event:M,listeners:E}),k?M.data=k:(k=o0(n),k!==null&&(M.data=k)))),(k=Nw?Lw(t,n):Pw(t,n))&&(c=xa(c,"onBeforeInput"),0<c.length&&(u=new bm("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:c}),u.data=k))}y0(f,e)})}function Ds(t,e,n){return{instance:t,listener:e,currentTarget:n}}function xa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=ws(t,n),o!=null&&r.unshift(Ds(t,o,i)),o=ws(t,e),o!=null&&r.push(Ds(t,o,i))),t=t.return}return r}function Ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rm(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var l=n,a=l.alternate,c=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&c!==null&&(l=c,i?(a=ws(n,o),a!=null&&s.unshift(Ds(n,a,l))):i||(a=ws(n,o),a!=null&&s.push(Ds(n,a,l)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var Xw=/\r\n?/g,Zw=/\u0000|\uFFFD/g;function zm(t){return(typeof t=="string"?t:""+t).replace(Xw,`
`).replace(Zw,"")}function El(t,e,n){if(e=zm(e),zm(t)!==e&&n)throw Error(z(425))}function va(){}var Ju=null,Gu=null;function Yu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qu=typeof setTimeout=="function"?setTimeout:void 0,ek=typeof clearTimeout=="function"?clearTimeout:void 0,$m=typeof Promise=="function"?Promise:void 0,tk=typeof queueMicrotask=="function"?queueMicrotask:typeof $m<"u"?function(t){return $m.resolve(null).then(t).catch(nk)}:Qu;function nk(t){setTimeout(function(){throw t})}function Rd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Es(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Es(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Om(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var So=Math.random().toString(36).slice(2),kn="__reactFiber$"+So,As="__reactProps$"+So,Kn="__reactContainer$"+So,Xu="__reactEvents$"+So,rk="__reactListeners$"+So,ik="__reactHandles$"+So;function Jr(t){var e=t[kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kn]||n[kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Om(t);t!==null;){if(n=t[kn])return n;t=Om(t)}return e}t=n,n=t.parentNode}return null}function il(t){return t=t[kn]||t[Kn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _i(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Oc(t){return t[As]||null}var Zu=[],Hi=-1;function Nr(t){return{current:t}}function he(t){0>Hi||(t.current=Zu[Hi],Zu[Hi]=null,Hi--)}function de(t,e){Hi++,Zu[Hi]=t.current,t.current=e}var zr={},lt=Nr(zr),bt=Nr(!1),ci=zr;function so(t,e){var n=t.type.contextTypes;if(!n)return zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function St(t){return t=t.childContextTypes,t!=null}function ba(){he(bt),he(lt)}function Nm(t,e,n){if(lt.current!==zr)throw Error(z(168));de(lt,e),de(bt,n)}function v0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,HS(t)||"Unknown",i));return be({},n,r)}function Sa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zr,ci=lt.current,de(lt,t),de(bt,bt.current),!0}function Lm(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=v0(t,e,ci),r.__reactInternalMemoizedMergedChildContext=t,he(bt),he(lt),de(lt,t)):he(bt),de(bt,n)}var Pn=null,Nc=!1,zd=!1;function b0(t){Pn===null?Pn=[t]:Pn.push(t)}function ok(t){Nc=!0,b0(t)}function Lr(){if(!zd&&Pn!==null){zd=!0;var t=0,e=se;try{var n=Pn;for(se=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Pn=null,Nc=!1}catch(i){throw Pn!==null&&(Pn=Pn.slice(t+1)),Wx(vp,Lr),i}finally{se=e,zd=!1}}return null}var Ui=[],Vi=0,wa=null,ka=0,Wt=[],Kt=0,di=null,Fn=1,Bn="";function Ur(t,e){Ui[Vi++]=ka,Ui[Vi++]=wa,wa=t,ka=e}function S0(t,e,n){Wt[Kt++]=Fn,Wt[Kt++]=Bn,Wt[Kt++]=di,di=t;var r=Fn;t=Bn;var i=32-dn(r)-1;r&=~(1<<i),n+=1;var o=32-dn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Fn=1<<32-dn(e)+i|n<<i|r,Bn=o+t}else Fn=1<<o|n<<i|r,Bn=t}function jp(t){t.return!==null&&(Ur(t,1),S0(t,1,0))}function Dp(t){for(;t===wa;)wa=Ui[--Vi],Ui[Vi]=null,ka=Ui[--Vi],Ui[Vi]=null;for(;t===di;)di=Wt[--Kt],Wt[Kt]=null,Bn=Wt[--Kt],Wt[Kt]=null,Fn=Wt[--Kt],Wt[Kt]=null}var Rt=null,It=null,ge=!1,ln=null;function w0(t,e){var n=Jt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Pm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Rt=t,It=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Rt=t,It=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=di!==null?{id:Fn,overflow:Bn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Rt=t,It=null,!0):!1;default:return!1}}function ef(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tf(t){if(ge){var e=It;if(e){var n=e;if(!Pm(t,e)){if(ef(t))throw Error(z(418));e=kr(n.nextSibling);var r=Rt;e&&Pm(t,e)?w0(r,n):(t.flags=t.flags&-4097|2,ge=!1,Rt=t)}}else{if(ef(t))throw Error(z(418));t.flags=t.flags&-4097|2,ge=!1,Rt=t}}}function Fm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rt=t}function Ml(t){if(t!==Rt)return!1;if(!ge)return Fm(t),ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yu(t.type,t.memoizedProps)),e&&(e=It)){if(ef(t))throw k0(),Error(z(418));for(;e;)w0(t,e),e=kr(e.nextSibling)}if(Fm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){It=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}It=null}}else It=Rt?kr(t.stateNode.nextSibling):null;return!0}function k0(){for(var t=It;t;)t=kr(t.nextSibling)}function lo(){It=Rt=null,ge=!1}function Ap(t){ln===null?ln=[t]:ln.push(t)}var sk=Gn.ReactCurrentBatchConfig;function No(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Tl(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bm(t){var e=t._init;return e(t._payload)}function C0(t){function e(y,x){if(t){var b=y.deletions;b===null?(y.deletions=[x],y.flags|=16):b.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function r(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function i(y,x){return y=Tr(y,x),y.index=0,y.sibling=null,y}function o(y,x,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<x?(y.flags|=2,x):b):(y.flags|=2,x)):(y.flags|=1048576,x)}function s(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,x,b,w){return x===null||x.tag!==6?(x=Bd(b,y.mode,w),x.return=y,x):(x=i(x,b),x.return=y,x)}function a(y,x,b,w){var C=b.type;return C===Li?u(y,x,b.props.children,w,b.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===or&&Bm(C)===x.type)?(w=i(x,b.props),w.ref=No(y,x,b),w.return=y,w):(w=ia(b.type,b.key,b.props,null,y.mode,w),w.ref=No(y,x,b),w.return=y,w)}function c(y,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=_d(b,y.mode,w),x.return=y,x):(x=i(x,b.children||[]),x.return=y,x)}function u(y,x,b,w,C){return x===null||x.tag!==7?(x=ri(b,y.mode,w,C),x.return=y,x):(x=i(x,b),x.return=y,x)}function f(y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Bd(""+x,y.mode,b),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case gl:return b=ia(x.type,x.key,x.props,null,y.mode,b),b.ref=No(y,null,x),b.return=y,b;case Ni:return x=_d(x,y.mode,b),x.return=y,x;case or:var w=x._init;return f(y,w(x._payload),b)}if(Uo(x)||Io(x))return x=ri(x,y.mode,b,null),x.return=y,x;Tl(y,x)}return null}function p(y,x,b,w){var C=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:l(y,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case gl:return b.key===C?a(y,x,b,w):null;case Ni:return b.key===C?c(y,x,b,w):null;case or:return C=b._init,p(y,x,C(b._payload),w)}if(Uo(b)||Io(b))return C!==null?null:u(y,x,b,w,null);Tl(y,b)}return null}function h(y,x,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(b)||null,l(x,y,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case gl:return y=y.get(w.key===null?b:w.key)||null,a(x,y,w,C);case Ni:return y=y.get(w.key===null?b:w.key)||null,c(x,y,w,C);case or:var E=w._init;return h(y,x,b,E(w._payload),C)}if(Uo(w)||Io(w))return y=y.get(b)||null,u(x,y,w,C,null);Tl(x,w)}return null}function m(y,x,b,w){for(var C=null,E=null,k=x,M=x=0,$=null;k!==null&&M<b.length;M++){k.index>M?($=k,k=null):$=k.sibling;var O=p(y,k,b[M],w);if(O===null){k===null&&(k=$);break}t&&k&&O.alternate===null&&e(y,k),x=o(O,x,M),E===null?C=O:E.sibling=O,E=O,k=$}if(M===b.length)return n(y,k),ge&&Ur(y,M),C;if(k===null){for(;M<b.length;M++)k=f(y,b[M],w),k!==null&&(x=o(k,x,M),E===null?C=k:E.sibling=k,E=k);return ge&&Ur(y,M),C}for(k=r(y,k);M<b.length;M++)$=h(k,y,M,b[M],w),$!==null&&(t&&$.alternate!==null&&k.delete($.key===null?M:$.key),x=o($,x,M),E===null?C=$:E.sibling=$,E=$);return t&&k.forEach(function(_){return e(y,_)}),ge&&Ur(y,M),C}function g(y,x,b,w){var C=Io(b);if(typeof C!="function")throw Error(z(150));if(b=C.call(b),b==null)throw Error(z(151));for(var E=C=null,k=x,M=x=0,$=null,O=b.next();k!==null&&!O.done;M++,O=b.next()){k.index>M?($=k,k=null):$=k.sibling;var _=p(y,k,O.value,w);if(_===null){k===null&&(k=$);break}t&&k&&_.alternate===null&&e(y,k),x=o(_,x,M),E===null?C=_:E.sibling=_,E=_,k=$}if(O.done)return n(y,k),ge&&Ur(y,M),C;if(k===null){for(;!O.done;M++,O=b.next())O=f(y,O.value,w),O!==null&&(x=o(O,x,M),E===null?C=O:E.sibling=O,E=O);return ge&&Ur(y,M),C}for(k=r(y,k);!O.done;M++,O=b.next())O=h(k,y,M,O.value,w),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?M:O.key),x=o(O,x,M),E===null?C=O:E.sibling=O,E=O);return t&&k.forEach(function(oe){return e(y,oe)}),ge&&Ur(y,M),C}function v(y,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Li&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case gl:e:{for(var C=b.key,E=x;E!==null;){if(E.key===C){if(C=b.type,C===Li){if(E.tag===7){n(y,E.sibling),x=i(E,b.props.children),x.return=y,y=x;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===or&&Bm(C)===E.type){n(y,E.sibling),x=i(E,b.props),x.ref=No(y,E,b),x.return=y,y=x;break e}n(y,E);break}else e(y,E);E=E.sibling}b.type===Li?(x=ri(b.props.children,y.mode,w,b.key),x.return=y,y=x):(w=ia(b.type,b.key,b.props,null,y.mode,w),w.ref=No(y,x,b),w.return=y,y=w)}return s(y);case Ni:e:{for(E=b.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(y,x.sibling),x=i(x,b.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=_d(b,y.mode,w),x.return=y,y=x}return s(y);case or:return E=b._init,v(y,x,E(b._payload),w)}if(Uo(b))return m(y,x,b,w);if(Io(b))return g(y,x,b,w);Tl(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(y,x.sibling),x=i(x,b),x.return=y,y=x):(n(y,x),x=Bd(b,y.mode,w),x.return=y,y=x),s(y)):n(y,x)}return v}var ao=C0(!0),E0=C0(!1),Ca=Nr(null),Ea=null,Wi=null,Ip=null;function Rp(){Ip=Wi=Ea=null}function zp(t){var e=Ca.current;he(Ca),t._currentValue=e}function nf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function eo(t,e){Ea=t,Ip=Wi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vt=!0),t.firstContext=null)}function Zt(t){var e=t._currentValue;if(Ip!==t)if(t={context:t,memoizedValue:e,next:null},Wi===null){if(Ea===null)throw Error(z(308));Wi=t,Ea.dependencies={lanes:0,firstContext:t}}else Wi=Wi.next=t;return e}var Gr=null;function $p(t){Gr===null?Gr=[t]:Gr.push(t)}function M0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,$p(e)):(n.next=i.next,i.next=n),e.interleaved=n,qn(t,r)}function qn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var sr=!1;function Op(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function T0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Cr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,te&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,qn(t,n)}return i=r.interleaved,i===null?(e.next=e,$p(r)):(e.next=i.next,i.next=e),r.interleaved=e,qn(t,n)}function Xl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bp(t,n)}}function _m(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ma(t,e,n,r){var i=t.updateQueue;sr=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,c=a.next;a.next=null,s===null?o=c:s.next=c,s=a;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==s&&(l===null?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,u=c=a=null,l=o;do{var p=l.lane,h=l.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,g=l;switch(p=e,h=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(h,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(h,f,p):m,p==null)break e;f=be({},f,p);break e;case 2:sr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(c=u=h,a=f):u=u.next=h,s|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(a=f),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);fi|=s,t.lanes=s,t.memoizedState=f}}function Hm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var ol={},Mn=Nr(ol),Is=Nr(ol),Rs=Nr(ol);function Yr(t){if(t===ol)throw Error(z(174));return t}function Np(t,e){switch(de(Rs,e),de(Is,t),de(Mn,ol),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Nu(e,t)}he(Mn),de(Mn,e)}function co(){he(Mn),he(Is),he(Rs)}function j0(t){Yr(Rs.current);var e=Yr(Mn.current),n=Nu(e,t.type);e!==n&&(de(Is,t),de(Mn,n))}function Lp(t){Is.current===t&&(he(Mn),he(Is))}var xe=Nr(0);function Ta(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $d=[];function Pp(){for(var t=0;t<$d.length;t++)$d[t]._workInProgressVersionPrimary=null;$d.length=0}var Zl=Gn.ReactCurrentDispatcher,Od=Gn.ReactCurrentBatchConfig,ui=0,ve=null,Ae=null,Ne=null,ja=!1,ts=!1,zs=0,lk=0;function rt(){throw Error(z(321))}function Fp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!fn(t[n],e[n]))return!1;return!0}function Bp(t,e,n,r,i,o){if(ui=o,ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zl.current=t===null||t.memoizedState===null?uk:fk,t=n(r,i),ts){o=0;do{if(ts=!1,zs=0,25<=o)throw Error(z(301));o+=1,Ne=Ae=null,e.updateQueue=null,Zl.current=pk,t=n(r,i)}while(ts)}if(Zl.current=Da,e=Ae!==null&&Ae.next!==null,ui=0,Ne=Ae=ve=null,ja=!1,e)throw Error(z(300));return t}function _p(){var t=zs!==0;return zs=0,t}function vn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ne===null?ve.memoizedState=Ne=t:Ne=Ne.next=t,Ne}function en(){if(Ae===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=Ae.next;var e=Ne===null?ve.memoizedState:Ne.next;if(e!==null)Ne=e,Ae=t;else{if(t===null)throw Error(z(310));Ae=t,t={memoizedState:Ae.memoizedState,baseState:Ae.baseState,baseQueue:Ae.baseQueue,queue:Ae.queue,next:null},Ne===null?ve.memoizedState=Ne=t:Ne=Ne.next=t}return Ne}function $s(t,e){return typeof e=="function"?e(t):e}function Nd(t){var e=en(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=Ae,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,c=o;do{var u=c.lane;if((ui&u)===u)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(l=a=f,s=r):a=a.next=f,ve.lanes|=u,fi|=u}c=c.next}while(c!==null&&c!==o);a===null?s=r:a.next=l,fn(r,e.memoizedState)||(vt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,ve.lanes|=o,fi|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ld(t){var e=en(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);fn(o,e.memoizedState)||(vt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function D0(){}function A0(t,e){var n=ve,r=en(),i=e(),o=!fn(r.memoizedState,i);if(o&&(r.memoizedState=i,vt=!0),r=r.queue,Hp(z0.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ne!==null&&Ne.memoizedState.tag&1){if(n.flags|=2048,Os(9,R0.bind(null,n,r,i,e),void 0,null),Fe===null)throw Error(z(349));ui&30||I0(n,e,i)}return i}function I0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function R0(t,e,n,r){e.value=n,e.getSnapshot=r,$0(e)&&O0(t)}function z0(t,e,n){return n(function(){$0(e)&&O0(t)})}function $0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fn(t,n)}catch{return!0}}function O0(t){var e=qn(t,1);e!==null&&un(e,t,1,-1)}function Um(t){var e=vn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:t},e.queue=t,t=t.dispatch=dk.bind(null,ve,t),[e.memoizedState,t]}function Os(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function N0(){return en().memoizedState}function ea(t,e,n,r){var i=vn();ve.flags|=t,i.memoizedState=Os(1|e,n,void 0,r===void 0?null:r)}function Lc(t,e,n,r){var i=en();r=r===void 0?null:r;var o=void 0;if(Ae!==null){var s=Ae.memoizedState;if(o=s.destroy,r!==null&&Fp(r,s.deps)){i.memoizedState=Os(e,n,o,r);return}}ve.flags|=t,i.memoizedState=Os(1|e,n,o,r)}function Vm(t,e){return ea(8390656,8,t,e)}function Hp(t,e){return Lc(2048,8,t,e)}function L0(t,e){return Lc(4,2,t,e)}function P0(t,e){return Lc(4,4,t,e)}function F0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function B0(t,e,n){return n=n!=null?n.concat([t]):null,Lc(4,4,F0.bind(null,e,t),n)}function Up(){}function _0(t,e){var n=en();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function H0(t,e){var n=en();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function U0(t,e,n){return ui&21?(fn(n,e)||(n=Jx(),ve.lanes|=n,fi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vt=!0),t.memoizedState=n)}function ak(t,e){var n=se;se=n!==0&&4>n?n:4,t(!0);var r=Od.transition;Od.transition={};try{t(!1),e()}finally{se=n,Od.transition=r}}function V0(){return en().memoizedState}function ck(t,e,n){var r=Mr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},W0(t))K0(e,n);else if(n=M0(t,e,n,r),n!==null){var i=ut();un(n,t,r,i),q0(n,e,r)}}function dk(t,e,n){var r=Mr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(W0(t))K0(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,n);if(i.hasEagerState=!0,i.eagerState=l,fn(l,s)){var a=e.interleaved;a===null?(i.next=i,$p(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=M0(t,e,i,r),n!==null&&(i=ut(),un(n,t,r,i),q0(n,e,r))}}function W0(t){var e=t.alternate;return t===ve||e!==null&&e===ve}function K0(t,e){ts=ja=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function q0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bp(t,n)}}var Da={readContext:Zt,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useInsertionEffect:rt,useLayoutEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useMutableSource:rt,useSyncExternalStore:rt,useId:rt,unstable_isNewReconciler:!1},uk={readContext:Zt,useCallback:function(t,e){return vn().memoizedState=[t,e===void 0?null:e],t},useContext:Zt,useEffect:Vm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ea(4194308,4,F0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ea(4194308,4,t,e)},useInsertionEffect:function(t,e){return ea(4,2,t,e)},useMemo:function(t,e){var n=vn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=vn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ck.bind(null,ve,t),[r.memoizedState,t]},useRef:function(t){var e=vn();return t={current:t},e.memoizedState=t},useState:Um,useDebugValue:Up,useDeferredValue:function(t){return vn().memoizedState=t},useTransition:function(){var t=Um(!1),e=t[0];return t=ak.bind(null,t[1]),vn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ve,i=vn();if(ge){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),Fe===null)throw Error(z(349));ui&30||I0(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Vm(z0.bind(null,r,o,t),[t]),r.flags|=2048,Os(9,R0.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=vn(),e=Fe.identifierPrefix;if(ge){var n=Bn,r=Fn;n=(r&~(1<<32-dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=zs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fk={readContext:Zt,useCallback:_0,useContext:Zt,useEffect:Hp,useImperativeHandle:B0,useInsertionEffect:L0,useLayoutEffect:P0,useMemo:H0,useReducer:Nd,useRef:N0,useState:function(){return Nd($s)},useDebugValue:Up,useDeferredValue:function(t){var e=en();return U0(e,Ae.memoizedState,t)},useTransition:function(){var t=Nd($s)[0],e=en().memoizedState;return[t,e]},useMutableSource:D0,useSyncExternalStore:A0,useId:V0,unstable_isNewReconciler:!1},pk={readContext:Zt,useCallback:_0,useContext:Zt,useEffect:Hp,useImperativeHandle:B0,useInsertionEffect:L0,useLayoutEffect:P0,useMemo:H0,useReducer:Ld,useRef:N0,useState:function(){return Ld($s)},useDebugValue:Up,useDeferredValue:function(t){var e=en();return Ae===null?e.memoizedState=t:U0(e,Ae.memoizedState,t)},useTransition:function(){var t=Ld($s)[0],e=en().memoizedState;return[t,e]},useMutableSource:D0,useSyncExternalStore:A0,useId:V0,unstable_isNewReconciler:!1};function on(t,e){if(t&&t.defaultProps){e=be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Pc={isMounted:function(t){return(t=t._reactInternals)?wi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ut(),i=Mr(t),o=Hn(r,i);o.payload=e,n!=null&&(o.callback=n),e=Cr(t,o,i),e!==null&&(un(e,t,i,r),Xl(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ut(),i=Mr(t),o=Hn(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Cr(t,o,i),e!==null&&(un(e,t,i,r),Xl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ut(),r=Mr(t),i=Hn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Cr(t,i,r),e!==null&&(un(e,t,r,n),Xl(e,t,r))}};function Wm(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Ts(n,r)||!Ts(i,o):!0}function J0(t,e,n){var r=!1,i=zr,o=e.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(i=St(e)?ci:lt.current,r=e.contextTypes,o=(r=r!=null)?so(t,i):zr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Km(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Pc.enqueueReplaceState(e,e.state,null)}function of(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Op(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Zt(o):(o=St(e)?ci:lt.current,i.context=so(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(rf(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Pc.enqueueReplaceState(i,i.state,null),Ma(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function uo(t,e){try{var n="",r=e;do n+=_S(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Pd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hk=typeof WeakMap=="function"?WeakMap:Map;function G0(t,e,n){n=Hn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ia||(Ia=!0,gf=r),sf(t,e)},n}function Y0(t,e,n){n=Hn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){sf(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){sf(t,e),typeof r!="function"&&(Er===null?Er=new Set([this]):Er.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function qm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=jk.bind(null,t,e,n),e.then(t,t))}function Jm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Gm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hn(-1,1),e.tag=2,Cr(n,e,1))),n.lanes|=1),t)}var mk=Gn.ReactCurrentOwner,vt=!1;function dt(t,e,n,r){e.child=t===null?E0(e,null,n,r):ao(e,t.child,n,r)}function Ym(t,e,n,r,i){n=n.render;var o=e.ref;return eo(e,i),r=Bp(t,e,n,r,o,i),n=_p(),t!==null&&!vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jn(t,e,i)):(ge&&n&&jp(e),e.flags|=1,dt(t,e,r,i),e.child)}function Qm(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Qp(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Q0(t,e,o,r,i)):(t=ia(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ts,n(s,r)&&t.ref===e.ref)return Jn(t,e,i)}return e.flags|=1,t=Tr(o,r),t.ref=e.ref,t.return=e,e.child=t}function Q0(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Ts(o,r)&&t.ref===e.ref)if(vt=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(vt=!0);else return e.lanes=t.lanes,Jn(t,e,i)}return lf(t,e,n,r,i)}function X0(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},de(qi,Dt),Dt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,de(qi,Dt),Dt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,de(qi,Dt),Dt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,de(qi,Dt),Dt|=r;return dt(t,e,i,n),e.child}function Z0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lf(t,e,n,r,i){var o=St(n)?ci:lt.current;return o=so(e,o),eo(e,i),n=Bp(t,e,n,r,o,i),r=_p(),t!==null&&!vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jn(t,e,i)):(ge&&r&&jp(e),e.flags|=1,dt(t,e,n,i),e.child)}function Xm(t,e,n,r,i){if(St(n)){var o=!0;Sa(e)}else o=!1;if(eo(e,i),e.stateNode===null)ta(t,e),J0(e,n,r),of(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Zt(c):(c=St(n)?ci:lt.current,c=so(e,c));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==c)&&Km(e,s,r,c),sr=!1;var p=e.memoizedState;s.state=p,Ma(e,r,s,i),a=e.memoizedState,l!==r||p!==a||bt.current||sr?(typeof u=="function"&&(rf(e,n,u,r),a=e.memoizedState),(l=sr||Wm(e,n,l,r,p,a,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=c,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,T0(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:on(e.type,l),s.props=c,f=e.pendingProps,p=s.context,a=n.contextType,typeof a=="object"&&a!==null?a=Zt(a):(a=St(n)?ci:lt.current,a=so(e,a));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||p!==a)&&Km(e,s,r,a),sr=!1,p=e.memoizedState,s.state=p,Ma(e,r,s,i);var m=e.memoizedState;l!==f||p!==m||bt.current||sr?(typeof h=="function"&&(rf(e,n,h,r),m=e.memoizedState),(c=sr||Wm(e,n,c,r,p,m,a)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=a,r=c):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return af(t,e,n,r,o,i)}function af(t,e,n,r,i,o){Z0(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Lm(e,n,!1),Jn(t,e,o);r=e.stateNode,mk.current=e;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ao(e,t.child,null,o),e.child=ao(e,null,l,o)):dt(t,e,l,o),e.memoizedState=r.state,i&&Lm(e,n,!0),e.child}function e1(t){var e=t.stateNode;e.pendingContext?Nm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Nm(t,e.context,!1),Np(t,e.containerInfo)}function Zm(t,e,n,r,i){return lo(),Ap(i),e.flags|=256,dt(t,e,n,r),e.child}var cf={dehydrated:null,treeContext:null,retryLane:0};function df(t){return{baseLanes:t,cachePool:null,transitions:null}}function t1(t,e,n){var r=e.pendingProps,i=xe.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),de(xe,i&1),t===null)return tf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=_c(s,r,0,null),t=ri(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=df(n),e.memoizedState=cf,t):Vp(e,s));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return gk(t,e,s,r,l,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Tr(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=Tr(l,o):(o=ri(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?df(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=cf,r}return o=t.child,t=o.sibling,r=Tr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Vp(t,e){return e=_c({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jl(t,e,n,r){return r!==null&&Ap(r),ao(e,t.child,null,n),t=Vp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gk(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Pd(Error(z(422))),jl(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=_c({mode:"visible",children:r.children},i,0,null),o=ri(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ao(e,t.child,null,s),e.child.memoizedState=df(s),e.memoizedState=cf,o);if(!(e.mode&1))return jl(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(z(419)),r=Pd(o,r,void 0),jl(t,e,s,r)}if(l=(s&t.childLanes)!==0,vt||l){if(r=Fe,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,qn(t,i),un(r,t,i,-1))}return Yp(),r=Pd(Error(z(421))),jl(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Dk.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,It=kr(i.nextSibling),Rt=e,ge=!0,ln=null,t!==null&&(Wt[Kt++]=Fn,Wt[Kt++]=Bn,Wt[Kt++]=di,Fn=t.id,Bn=t.overflow,di=e),e=Vp(e,r.children),e.flags|=4096,e)}function eg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nf(t.return,e,n)}function Fd(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function n1(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(dt(t,e,r.children,n),r=xe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eg(t,n,e);else if(t.tag===19)eg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(de(xe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ta(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Fd(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ta(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Fd(e,!0,n,null,o);break;case"together":Fd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ta(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),fi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=Tr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Tr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yk(t,e,n){switch(e.tag){case 3:e1(e),lo();break;case 5:j0(e);break;case 1:St(e.type)&&Sa(e);break;case 4:Np(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;de(Ca,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(de(xe,xe.current&1),e.flags|=128,null):n&e.child.childLanes?t1(t,e,n):(de(xe,xe.current&1),t=Jn(t,e,n),t!==null?t.sibling:null);de(xe,xe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return n1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),de(xe,xe.current),r)break;return null;case 22:case 23:return e.lanes=0,X0(t,e,n)}return Jn(t,e,n)}var r1,uf,i1,o1;r1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uf=function(){};i1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Yr(Mn.current);var o=null;switch(n){case"input":i=Ru(t,i),r=Ru(t,r),o=[];break;case"select":i=be({},i,{value:void 0}),r=be({},r,{value:void 0}),o=[];break;case"textarea":i=Ou(t,i),r=Ou(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=va)}Lu(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(bs.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var a=r[c];if(l=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&a!==l&&(a!=null||l!=null))if(c==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(n||(n={}),n[s]=a[s])}else n||(o||(o=[]),o.push(c,n)),n=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(bs.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&fe("scroll",t),o||l===a||(o=[])):(o=o||[]).push(c,a))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};o1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lo(t,e){if(!ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function it(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function xk(t,e,n){var r=e.pendingProps;switch(Dp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(e),null;case 1:return St(e.type)&&ba(),it(e),null;case 3:return r=e.stateNode,co(),he(bt),he(lt),Pp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ml(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ln!==null&&(vf(ln),ln=null))),uf(t,e),it(e),null;case 5:Lp(e);var i=Yr(Rs.current);if(n=e.type,t!==null&&e.stateNode!=null)i1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return it(e),null}if(t=Yr(Mn.current),Ml(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[kn]=e,r[As]=o,t=(e.mode&1)!==0,n){case"dialog":fe("cancel",r),fe("close",r);break;case"iframe":case"object":case"embed":fe("load",r);break;case"video":case"audio":for(i=0;i<Wo.length;i++)fe(Wo[i],r);break;case"source":fe("error",r);break;case"img":case"image":case"link":fe("error",r),fe("load",r);break;case"details":fe("toggle",r);break;case"input":cm(r,o),fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},fe("invalid",r);break;case"textarea":um(r,o),fe("invalid",r)}Lu(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&El(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&El(r.textContent,l,t),i=["children",""+l]):bs.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&fe("scroll",r)}switch(n){case"input":yl(r),dm(r,o,!0);break;case"textarea":yl(r),fm(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=va)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[kn]=e,t[As]=r,r1(t,e,!1,!1),e.stateNode=t;e:{switch(s=Pu(n,r),n){case"dialog":fe("cancel",t),fe("close",t),i=r;break;case"iframe":case"object":case"embed":fe("load",t),i=r;break;case"video":case"audio":for(i=0;i<Wo.length;i++)fe(Wo[i],t);i=r;break;case"source":fe("error",t),i=r;break;case"img":case"image":case"link":fe("error",t),fe("load",t),i=r;break;case"details":fe("toggle",t),i=r;break;case"input":cm(t,r),i=Ru(t,r),fe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=be({},r,{value:void 0}),fe("invalid",t);break;case"textarea":um(t,r),i=Ou(t,r),fe("invalid",t);break;default:i=r}Lu(n,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?Nx(t,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&$x(t,a)):o==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Ss(t,a):typeof a=="number"&&Ss(t,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(bs.hasOwnProperty(o)?a!=null&&o==="onScroll"&&fe("scroll",t):a!=null&&hp(t,o,a,s))}switch(n){case"input":yl(t),dm(t,r,!1);break;case"textarea":yl(t),fm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Yi(t,!!r.multiple,o,!1):r.defaultValue!=null&&Yi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=va)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return it(e),null;case 6:if(t&&e.stateNode!=null)o1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=Yr(Rs.current),Yr(Mn.current),Ml(e)){if(r=e.stateNode,n=e.memoizedProps,r[kn]=e,(o=r.nodeValue!==n)&&(t=Rt,t!==null))switch(t.tag){case 3:El(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&El(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[kn]=e,e.stateNode=r}return it(e),null;case 13:if(he(xe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ge&&It!==null&&e.mode&1&&!(e.flags&128))k0(),lo(),e.flags|=98560,o=!1;else if(o=Ml(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(z(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(z(317));o[kn]=e}else lo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;it(e),o=!1}else ln!==null&&(vf(ln),ln=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||xe.current&1?ze===0&&(ze=3):Yp())),e.updateQueue!==null&&(e.flags|=4),it(e),null);case 4:return co(),uf(t,e),t===null&&js(e.stateNode.containerInfo),it(e),null;case 10:return zp(e.type._context),it(e),null;case 17:return St(e.type)&&ba(),it(e),null;case 19:if(he(xe),o=e.memoizedState,o===null)return it(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Lo(o,!1);else{if(ze!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Ta(t),s!==null){for(e.flags|=128,Lo(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return de(xe,xe.current&1|2),e.child}t=t.sibling}o.tail!==null&&Te()>fo&&(e.flags|=128,r=!0,Lo(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ta(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!ge)return it(e),null}else 2*Te()-o.renderingStartTime>fo&&n!==1073741824&&(e.flags|=128,r=!0,Lo(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Te(),e.sibling=null,n=xe.current,de(xe,r?n&1|2:n&1),e):(it(e),null);case 22:case 23:return Gp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dt&1073741824&&(it(e),e.subtreeFlags&6&&(e.flags|=8192)):it(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function vk(t,e){switch(Dp(e),e.tag){case 1:return St(e.type)&&ba(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return co(),he(bt),he(lt),Pp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lp(e),null;case 13:if(he(xe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));lo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return he(xe),null;case 4:return co(),null;case 10:return zp(e.type._context),null;case 22:case 23:return Gp(),null;case 24:return null;default:return null}}var Dl=!1,st=!1,bk=typeof WeakSet=="function"?WeakSet:Set,P=null;function Ki(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ke(t,e,r)}else n.current=null}function ff(t,e,n){try{n()}catch(r){ke(t,e,r)}}var tg=!1;function Sk(t,e){if(Ju=ga,t=d0(),Tp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,l=-1,a=-1,c=0,u=0,f=t,p=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(l=s+i),f!==o||r!==0&&f.nodeType!==3||(a=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===t)break t;if(p===n&&++c===i&&(l=s),p===o&&++u===r&&(a=s),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gu={focusedElem:t,selectionRange:n},ga=!1,P=e;P!==null;)if(e=P,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,P=t;else for(;P!==null;){e=P;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:on(e.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(w){ke(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,P=t;break}P=e.return}return m=tg,tg=!1,m}function ns(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&ff(e,n,o)}i=i.next}while(i!==r)}}function Fc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function pf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function s1(t){var e=t.alternate;e!==null&&(t.alternate=null,s1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[kn],delete e[As],delete e[Xu],delete e[rk],delete e[ik])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function l1(t){return t.tag===5||t.tag===3||t.tag===4}function ng(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||l1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=va));else if(r!==4&&(t=t.child,t!==null))for(hf(t,e,n),t=t.sibling;t!==null;)hf(t,e,n),t=t.sibling}function mf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(mf(t,e,n),t=t.sibling;t!==null;)mf(t,e,n),t=t.sibling}var Ke=null,sn=!1;function tr(t,e,n){for(n=n.child;n!==null;)a1(t,e,n),n=n.sibling}function a1(t,e,n){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Ic,n)}catch{}switch(n.tag){case 5:st||Ki(n,e);case 6:var r=Ke,i=sn;Ke=null,tr(t,e,n),Ke=r,sn=i,Ke!==null&&(sn?(t=Ke,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ke.removeChild(n.stateNode));break;case 18:Ke!==null&&(sn?(t=Ke,n=n.stateNode,t.nodeType===8?Rd(t.parentNode,n):t.nodeType===1&&Rd(t,n),Es(t)):Rd(Ke,n.stateNode));break;case 4:r=Ke,i=sn,Ke=n.stateNode.containerInfo,sn=!0,tr(t,e,n),Ke=r,sn=i;break;case 0:case 11:case 14:case 15:if(!st&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&ff(n,e,s),i=i.next}while(i!==r)}tr(t,e,n);break;case 1:if(!st&&(Ki(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ke(n,e,l)}tr(t,e,n);break;case 21:tr(t,e,n);break;case 22:n.mode&1?(st=(r=st)||n.memoizedState!==null,tr(t,e,n),st=r):tr(t,e,n);break;default:tr(t,e,n)}}function rg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bk),e.forEach(function(r){var i=Ak.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:Ke=l.stateNode,sn=!1;break e;case 3:Ke=l.stateNode.containerInfo,sn=!0;break e;case 4:Ke=l.stateNode.containerInfo,sn=!0;break e}l=l.return}if(Ke===null)throw Error(z(160));a1(o,s,i),Ke=null,sn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){ke(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)c1(e,t),e=e.sibling}function c1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rn(e,t),xn(t),r&4){try{ns(3,t,t.return),Fc(3,t)}catch(g){ke(t,t.return,g)}try{ns(5,t,t.return)}catch(g){ke(t,t.return,g)}}break;case 1:rn(e,t),xn(t),r&512&&n!==null&&Ki(n,n.return);break;case 5:if(rn(e,t),xn(t),r&512&&n!==null&&Ki(n,n.return),t.flags&32){var i=t.stateNode;try{Ss(i,"")}catch(g){ke(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Ix(i,o),Pu(l,s);var c=Pu(l,o);for(s=0;s<a.length;s+=2){var u=a[s],f=a[s+1];u==="style"?Nx(i,f):u==="dangerouslySetInnerHTML"?$x(i,f):u==="children"?Ss(i,f):hp(i,u,f,c)}switch(l){case"input":zu(i,o);break;case"textarea":Rx(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Yi(i,!!o.multiple,h,!1):p!==!!o.multiple&&(o.defaultValue!=null?Yi(i,!!o.multiple,o.defaultValue,!0):Yi(i,!!o.multiple,o.multiple?[]:"",!1))}i[As]=o}catch(g){ke(t,t.return,g)}}break;case 6:if(rn(e,t),xn(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){ke(t,t.return,g)}}break;case 3:if(rn(e,t),xn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Es(e.containerInfo)}catch(g){ke(t,t.return,g)}break;case 4:rn(e,t),xn(t);break;case 13:rn(e,t),xn(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(qp=Te())),r&4&&rg(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(st=(c=st)||u,rn(e,t),st=c):rn(e,t),xn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(P=t,u=t.child;u!==null;){for(f=P=u;P!==null;){switch(p=P,h=p.child,p.tag){case 0:case 11:case 14:case 15:ns(4,p,p.return);break;case 1:Ki(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){ke(r,n,g)}}break;case 5:Ki(p,p.return);break;case 22:if(p.memoizedState!==null){og(f);continue}}h!==null?(h.return=p,P=h):og(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=Ox("display",s))}catch(g){ke(t,t.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){ke(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:rn(e,t),xn(t),r&4&&rg(t);break;case 21:break;default:rn(e,t),xn(t)}}function xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(l1(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ss(i,""),r.flags&=-33);var o=ng(t);mf(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=ng(t);hf(t,l,s);break;default:throw Error(z(161))}}catch(a){ke(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wk(t,e,n){P=t,d1(t)}function d1(t,e,n){for(var r=(t.mode&1)!==0;P!==null;){var i=P,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Dl;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||st;l=Dl;var c=st;if(Dl=s,(st=a)&&!c)for(P=i;P!==null;)s=P,a=s.child,s.tag===22&&s.memoizedState!==null?sg(i):a!==null?(a.return=s,P=a):sg(i);for(;o!==null;)P=o,d1(o),o=o.sibling;P=i,Dl=l,st=c}ig(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,P=o):ig(t)}}function ig(t){for(;P!==null;){var e=P;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:st||Fc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!st)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:on(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Hm(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Hm(e,s,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Es(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}st||e.flags&512&&pf(e)}catch(p){ke(e,e.return,p)}}if(e===t){P=null;break}if(n=e.sibling,n!==null){n.return=e.return,P=n;break}P=e.return}}function og(t){for(;P!==null;){var e=P;if(e===t){P=null;break}var n=e.sibling;if(n!==null){n.return=e.return,P=n;break}P=e.return}}function sg(t){for(;P!==null;){var e=P;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fc(4,e)}catch(a){ke(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){ke(e,i,a)}}var o=e.return;try{pf(e)}catch(a){ke(e,o,a)}break;case 5:var s=e.return;try{pf(e)}catch(a){ke(e,s,a)}}}catch(a){ke(e,e.return,a)}if(e===t){P=null;break}var l=e.sibling;if(l!==null){l.return=e.return,P=l;break}P=e.return}}var kk=Math.ceil,Aa=Gn.ReactCurrentDispatcher,Wp=Gn.ReactCurrentOwner,Yt=Gn.ReactCurrentBatchConfig,te=0,Fe=null,je=null,Qe=0,Dt=0,qi=Nr(0),ze=0,Ns=null,fi=0,Bc=0,Kp=0,rs=null,yt=null,qp=0,fo=1/0,Nn=null,Ia=!1,gf=null,Er=null,Al=!1,gr=null,Ra=0,is=0,yf=null,na=-1,ra=0;function ut(){return te&6?Te():na!==-1?na:na=Te()}function Mr(t){return t.mode&1?te&2&&Qe!==0?Qe&-Qe:sk.transition!==null?(ra===0&&(ra=Jx()),ra):(t=se,t!==0||(t=window.event,t=t===void 0?16:t0(t.type)),t):1}function un(t,e,n,r){if(50<is)throw is=0,yf=null,Error(z(185));nl(t,n,r),(!(te&2)||t!==Fe)&&(t===Fe&&(!(te&2)&&(Bc|=n),ze===4&&fr(t,Qe)),wt(t,r),n===1&&te===0&&!(e.mode&1)&&(fo=Te()+500,Nc&&Lr()))}function wt(t,e){var n=t.callbackNode;sw(t,e);var r=ma(t,t===Fe?Qe:0);if(r===0)n!==null&&mm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&mm(n),e===1)t.tag===0?ok(lg.bind(null,t)):b0(lg.bind(null,t)),tk(function(){!(te&6)&&Lr()}),n=null;else{switch(Gx(r)){case 1:n=vp;break;case 4:n=Kx;break;case 16:n=ha;break;case 536870912:n=qx;break;default:n=ha}n=x1(n,u1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function u1(t,e){if(na=-1,ra=0,te&6)throw Error(z(327));var n=t.callbackNode;if(to()&&t.callbackNode!==n)return null;var r=ma(t,t===Fe?Qe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=za(t,r);else{e=r;var i=te;te|=2;var o=p1();(Fe!==t||Qe!==e)&&(Nn=null,fo=Te()+500,ni(t,e));do try{Mk();break}catch(l){f1(t,l)}while(!0);Rp(),Aa.current=o,te=i,je!==null?e=0:(Fe=null,Qe=0,e=ze)}if(e!==0){if(e===2&&(i=Uu(t),i!==0&&(r=i,e=xf(t,i))),e===1)throw n=Ns,ni(t,0),fr(t,r),wt(t,Te()),n;if(e===6)fr(t,r);else{if(i=t.current.alternate,!(r&30)&&!Ck(i)&&(e=za(t,r),e===2&&(o=Uu(t),o!==0&&(r=o,e=xf(t,o))),e===1))throw n=Ns,ni(t,0),fr(t,r),wt(t,Te()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Vr(t,yt,Nn);break;case 3:if(fr(t,r),(r&130023424)===r&&(e=qp+500-Te(),10<e)){if(ma(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ut(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Qu(Vr.bind(null,t,yt,Nn),e);break}Vr(t,yt,Nn);break;case 4:if(fr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-dn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Te()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kk(r/1960))-r,10<r){t.timeoutHandle=Qu(Vr.bind(null,t,yt,Nn),r);break}Vr(t,yt,Nn);break;case 5:Vr(t,yt,Nn);break;default:throw Error(z(329))}}}return wt(t,Te()),t.callbackNode===n?u1.bind(null,t):null}function xf(t,e){var n=rs;return t.current.memoizedState.isDehydrated&&(ni(t,e).flags|=256),t=za(t,e),t!==2&&(e=yt,yt=n,e!==null&&vf(e)),t}function vf(t){yt===null?yt=t:yt.push.apply(yt,t)}function Ck(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!fn(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fr(t,e){for(e&=~Kp,e&=~Bc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-dn(e),r=1<<n;t[n]=-1,e&=~r}}function lg(t){if(te&6)throw Error(z(327));to();var e=ma(t,0);if(!(e&1))return wt(t,Te()),null;var n=za(t,e);if(t.tag!==0&&n===2){var r=Uu(t);r!==0&&(e=r,n=xf(t,r))}if(n===1)throw n=Ns,ni(t,0),fr(t,e),wt(t,Te()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vr(t,yt,Nn),wt(t,Te()),null}function Jp(t,e){var n=te;te|=1;try{return t(e)}finally{te=n,te===0&&(fo=Te()+500,Nc&&Lr())}}function pi(t){gr!==null&&gr.tag===0&&!(te&6)&&to();var e=te;te|=1;var n=Yt.transition,r=se;try{if(Yt.transition=null,se=1,t)return t()}finally{se=r,Yt.transition=n,te=e,!(te&6)&&Lr()}}function Gp(){Dt=qi.current,he(qi)}function ni(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ek(n)),je!==null)for(n=je.return;n!==null;){var r=n;switch(Dp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ba();break;case 3:co(),he(bt),he(lt),Pp();break;case 5:Lp(r);break;case 4:co();break;case 13:he(xe);break;case 19:he(xe);break;case 10:zp(r.type._context);break;case 22:case 23:Gp()}n=n.return}if(Fe=t,je=t=Tr(t.current,null),Qe=Dt=e,ze=0,Ns=null,Kp=Bc=fi=0,yt=rs=null,Gr!==null){for(e=0;e<Gr.length;e++)if(n=Gr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Gr=null}return t}function f1(t,e){do{var n=je;try{if(Rp(),Zl.current=Da,ja){for(var r=ve.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ja=!1}if(ui=0,Ne=Ae=ve=null,ts=!1,zs=0,Wp.current=null,n===null||n.return===null){ze=1,Ns=e,je=null;break}e:{var o=t,s=n.return,l=n,a=e;if(e=Qe,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Jm(s);if(h!==null){h.flags&=-257,Gm(h,s,l,o,e),h.mode&1&&qm(o,c,e),e=h,a=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(a),e.updateQueue=g}else m.add(a);break e}else{if(!(e&1)){qm(o,c,e),Yp();break e}a=Error(z(426))}}else if(ge&&l.mode&1){var v=Jm(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Gm(v,s,l,o,e),Ap(uo(a,l));break e}}o=a=uo(a,l),ze!==4&&(ze=2),rs===null?rs=[o]:rs.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=G0(o,a,e);_m(o,y);break e;case 1:l=a;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Er===null||!Er.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=Y0(o,l,e);_m(o,w);break e}}o=o.return}while(o!==null)}m1(n)}catch(C){e=C,je===n&&n!==null&&(je=n=n.return);continue}break}while(!0)}function p1(){var t=Aa.current;return Aa.current=Da,t===null?Da:t}function Yp(){(ze===0||ze===3||ze===2)&&(ze=4),Fe===null||!(fi&268435455)&&!(Bc&268435455)||fr(Fe,Qe)}function za(t,e){var n=te;te|=2;var r=p1();(Fe!==t||Qe!==e)&&(Nn=null,ni(t,e));do try{Ek();break}catch(i){f1(t,i)}while(!0);if(Rp(),te=n,Aa.current=r,je!==null)throw Error(z(261));return Fe=null,Qe=0,ze}function Ek(){for(;je!==null;)h1(je)}function Mk(){for(;je!==null&&!QS();)h1(je)}function h1(t){var e=y1(t.alternate,t,Dt);t.memoizedProps=t.pendingProps,e===null?m1(t):je=e,Wp.current=null}function m1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vk(n,e),n!==null){n.flags&=32767,je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ze=6,je=null;return}}else if(n=xk(n,e,Dt),n!==null){je=n;return}if(e=e.sibling,e!==null){je=e;return}je=e=t}while(e!==null);ze===0&&(ze=5)}function Vr(t,e,n){var r=se,i=Yt.transition;try{Yt.transition=null,se=1,Tk(t,e,n,r)}finally{Yt.transition=i,se=r}return null}function Tk(t,e,n,r){do to();while(gr!==null);if(te&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(lw(t,o),t===Fe&&(je=Fe=null,Qe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Al||(Al=!0,x1(ha,function(){return to(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Yt.transition,Yt.transition=null;var s=se;se=1;var l=te;te|=4,Wp.current=null,Sk(t,n),c1(n,t),qw(Gu),ga=!!Ju,Gu=Ju=null,t.current=n,wk(n),XS(),te=l,se=s,Yt.transition=o}else t.current=n;if(Al&&(Al=!1,gr=t,Ra=i),o=t.pendingLanes,o===0&&(Er=null),tw(n.stateNode),wt(t,Te()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ia)throw Ia=!1,t=gf,gf=null,t;return Ra&1&&t.tag!==0&&to(),o=t.pendingLanes,o&1?t===yf?is++:(is=0,yf=t):is=0,Lr(),null}function to(){if(gr!==null){var t=Gx(Ra),e=Yt.transition,n=se;try{if(Yt.transition=null,se=16>t?16:t,gr===null)var r=!1;else{if(t=gr,gr=null,Ra=0,te&6)throw Error(z(331));var i=te;for(te|=4,P=t.current;P!==null;){var o=P,s=o.child;if(P.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var c=l[a];for(P=c;P!==null;){var u=P;switch(u.tag){case 0:case 11:case 15:ns(8,u,o)}var f=u.child;if(f!==null)f.return=u,P=f;else for(;P!==null;){u=P;var p=u.sibling,h=u.return;if(s1(u),u===c){P=null;break}if(p!==null){p.return=h,P=p;break}P=h}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}P=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,P=s;else e:for(;P!==null;){if(o=P,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ns(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,P=y;break e}P=o.return}}var x=t.current;for(P=x;P!==null;){s=P;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,P=b;else e:for(s=x;P!==null;){if(l=P,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Fc(9,l)}}catch(C){ke(l,l.return,C)}if(l===s){P=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,P=w;break e}P=l.return}}if(te=i,Lr(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Ic,t)}catch{}r=!0}return r}finally{se=n,Yt.transition=e}}return!1}function ag(t,e,n){e=uo(n,e),e=G0(t,e,1),t=Cr(t,e,1),e=ut(),t!==null&&(nl(t,1,e),wt(t,e))}function ke(t,e,n){if(t.tag===3)ag(t,t,n);else for(;e!==null;){if(e.tag===3){ag(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Er===null||!Er.has(r))){t=uo(n,t),t=Y0(e,t,1),e=Cr(e,t,1),t=ut(),e!==null&&(nl(e,1,t),wt(e,t));break}}e=e.return}}function jk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ut(),t.pingedLanes|=t.suspendedLanes&n,Fe===t&&(Qe&n)===n&&(ze===4||ze===3&&(Qe&130023424)===Qe&&500>Te()-qp?ni(t,0):Kp|=n),wt(t,e)}function g1(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var n=ut();t=qn(t,e),t!==null&&(nl(t,e,n),wt(t,n))}function Dk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),g1(t,n)}function Ak(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),g1(t,n)}var y1;y1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bt.current)vt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vt=!1,yk(t,e,n);vt=!!(t.flags&131072)}else vt=!1,ge&&e.flags&1048576&&S0(e,ka,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ta(t,e),t=e.pendingProps;var i=so(e,lt.current);eo(e,n),i=Bp(null,e,r,t,i,n);var o=_p();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,St(r)?(o=!0,Sa(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Op(e),i.updater=Pc,e.stateNode=i,i._reactInternals=e,of(e,r,t,n),e=af(null,e,r,!0,o,n)):(e.tag=0,ge&&o&&jp(e),dt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ta(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Rk(r),t=on(r,t),i){case 0:e=lf(null,e,r,t,n);break e;case 1:e=Xm(null,e,r,t,n);break e;case 11:e=Ym(null,e,r,t,n);break e;case 14:e=Qm(null,e,r,on(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:on(r,i),lf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:on(r,i),Xm(t,e,r,i,n);case 3:e:{if(e1(e),t===null)throw Error(z(387));r=e.pendingProps,o=e.memoizedState,i=o.element,T0(t,e),Ma(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=uo(Error(z(423)),e),e=Zm(t,e,r,n,i);break e}else if(r!==i){i=uo(Error(z(424)),e),e=Zm(t,e,r,n,i);break e}else for(It=kr(e.stateNode.containerInfo.firstChild),Rt=e,ge=!0,ln=null,n=E0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lo(),r===i){e=Jn(t,e,n);break e}dt(t,e,r,n)}e=e.child}return e;case 5:return j0(e),t===null&&tf(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Yu(r,i)?s=null:o!==null&&Yu(r,o)&&(e.flags|=32),Z0(t,e),dt(t,e,s,n),e.child;case 6:return t===null&&tf(e),null;case 13:return t1(t,e,n);case 4:return Np(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ao(e,null,r,n):dt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:on(r,i),Ym(t,e,r,i,n);case 7:return dt(t,e,e.pendingProps,n),e.child;case 8:return dt(t,e,e.pendingProps.children,n),e.child;case 12:return dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,de(Ca,r._currentValue),r._currentValue=s,o!==null)if(fn(o.value,s)){if(o.children===i.children&&!bt.current){e=Jn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=Hn(-1,n&-n),a.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?a.next=a:(a.next=u.next,u.next=a),c.pending=a}}o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),nf(o.return,n,e),l.lanes|=n;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(z(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),nf(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}dt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,eo(e,n),i=Zt(i),r=r(i),e.flags|=1,dt(t,e,r,n),e.child;case 14:return r=e.type,i=on(r,e.pendingProps),i=on(r.type,i),Qm(t,e,r,i,n);case 15:return Q0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:on(r,i),ta(t,e),e.tag=1,St(r)?(t=!0,Sa(e)):t=!1,eo(e,n),J0(e,r,i),of(e,r,i,n),af(null,e,r,!0,t,n);case 19:return n1(t,e,n);case 22:return X0(t,e,n)}throw Error(z(156,e.tag))};function x1(t,e){return Wx(t,e)}function Ik(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jt(t,e,n,r){return new Ik(t,e,n,r)}function Qp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Rk(t){if(typeof t=="function")return Qp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gp)return 11;if(t===yp)return 14}return 2}function Tr(t,e){var n=t.alternate;return n===null?(n=Jt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ia(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Qp(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Li:return ri(n.children,i,o,e);case mp:s=8,i|=8;break;case ju:return t=Jt(12,n,e,i|2),t.elementType=ju,t.lanes=o,t;case Du:return t=Jt(13,n,e,i),t.elementType=Du,t.lanes=o,t;case Au:return t=Jt(19,n,e,i),t.elementType=Au,t.lanes=o,t;case jx:return _c(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Mx:s=10;break e;case Tx:s=9;break e;case gp:s=11;break e;case yp:s=14;break e;case or:s=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Jt(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function ri(t,e,n,r){return t=Jt(7,t,r,e),t.lanes=n,t}function _c(t,e,n,r){return t=Jt(22,t,r,e),t.elementType=jx,t.lanes=n,t.stateNode={isHidden:!1},t}function Bd(t,e,n){return t=Jt(6,t,null,e),t.lanes=n,t}function _d(t,e,n){return e=Jt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sd(0),this.expirationTimes=Sd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xp(t,e,n,r,i,o,s,l,a){return t=new zk(t,e,n,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Jt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Op(o),t}function $k(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ni,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function v1(t){if(!t)return zr;t=t._reactInternals;e:{if(wi(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(St(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(St(n))return v0(t,n,e)}return e}function b1(t,e,n,r,i,o,s,l,a){return t=Xp(n,r,!0,t,i,o,s,l,a),t.context=v1(null),n=t.current,r=ut(),i=Mr(n),o=Hn(r,i),o.callback=e??null,Cr(n,o,i),t.current.lanes=i,nl(t,i,r),wt(t,r),t}function Hc(t,e,n,r){var i=e.current,o=ut(),s=Mr(i);return n=v1(n),e.context===null?e.context=n:e.pendingContext=n,e=Hn(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Cr(i,e,s),t!==null&&(un(t,i,s,o),Xl(t,i,s)),s}function $a(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Zp(t,e){cg(t,e),(t=t.alternate)&&cg(t,e)}function Ok(){return null}var S1=typeof reportError=="function"?reportError:function(t){console.error(t)};function eh(t){this._internalRoot=t}Uc.prototype.render=eh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Hc(t,e,null,null)};Uc.prototype.unmount=eh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pi(function(){Hc(null,t,null,null)}),e[Kn]=null}};function Uc(t){this._internalRoot=t}Uc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Xx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ur.length&&e!==0&&e<ur[n].priority;n++);ur.splice(n,0,t),n===0&&e0(t)}};function th(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dg(){}function Nk(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=$a(s);o.call(c)}}var s=b1(e,r,t,0,null,!1,!1,"",dg);return t._reactRootContainer=s,t[Kn]=s.current,js(t.nodeType===8?t.parentNode:t),pi(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var c=$a(a);l.call(c)}}var a=Xp(t,0,!1,null,null,!1,!1,"",dg);return t._reactRootContainer=a,t[Kn]=a.current,js(t.nodeType===8?t.parentNode:t),pi(function(){Hc(e,a,n,r)}),a}function Wc(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=$a(s);l.call(a)}}Hc(e,s,t,i)}else s=Nk(n,e,t,i,r);return $a(s)}Yx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Vo(e.pendingLanes);n!==0&&(bp(e,n|1),wt(e,Te()),!(te&6)&&(fo=Te()+500,Lr()))}break;case 13:pi(function(){var r=qn(t,1);if(r!==null){var i=ut();un(r,t,1,i)}}),Zp(t,1)}};Sp=function(t){if(t.tag===13){var e=qn(t,134217728);if(e!==null){var n=ut();un(e,t,134217728,n)}Zp(t,134217728)}};Qx=function(t){if(t.tag===13){var e=Mr(t),n=qn(t,e);if(n!==null){var r=ut();un(n,t,e,r)}Zp(t,e)}};Xx=function(){return se};Zx=function(t,e){var n=se;try{return se=t,e()}finally{se=n}};Bu=function(t,e,n){switch(e){case"input":if(zu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Oc(r);if(!i)throw Error(z(90));Ax(r),zu(r,i)}}}break;case"textarea":Rx(t,n);break;case"select":e=n.value,e!=null&&Yi(t,!!n.multiple,e,!1)}};Fx=Jp;Bx=pi;var Lk={usingClientEntryPoint:!1,Events:[il,_i,Oc,Lx,Px,Jp]},Po={findFiberByHostInstance:Jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Pk={bundleType:Po.bundleType,version:Po.version,rendererPackageName:Po.rendererPackageName,rendererConfig:Po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ux(t),t===null?null:t.stateNode},findFiberByHostInstance:Po.findFiberByHostInstance||Ok,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Il.isDisabled&&Il.supportsFiber)try{Ic=Il.inject(Pk),En=Il}catch{}}Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lk;Nt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!th(e))throw Error(z(200));return $k(t,e,null,n)};Nt.createRoot=function(t,e){if(!th(t))throw Error(z(299));var n=!1,r="",i=S1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xp(t,1,!1,null,null,n,!1,r,i),t[Kn]=e.current,js(t.nodeType===8?t.parentNode:t),new eh(e)};Nt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=Ux(e),t=t===null?null:t.stateNode,t};Nt.flushSync=function(t){return pi(t)};Nt.hydrate=function(t,e,n){if(!Vc(e))throw Error(z(200));return Wc(null,t,e,!0,n)};Nt.hydrateRoot=function(t,e,n){if(!th(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=S1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=b1(e,null,t,1,n??null,i,!1,o,s),t[Kn]=e.current,js(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Uc(e)};Nt.render=function(t,e,n){if(!Vc(e))throw Error(z(200));return Wc(null,t,e,!1,n)};Nt.unmountComponentAtNode=function(t){if(!Vc(t))throw Error(z(40));return t._reactRootContainer?(pi(function(){Wc(null,null,t,!1,function(){t._reactRootContainer=null,t[Kn]=null})}),!0):!1};Nt.unstable_batchedUpdates=Jp;Nt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Vc(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Wc(t,e,n,!1,r)};Nt.version="18.3.1-next-f1338f8080-20240426";function w1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w1)}catch(t){console.error(t)}}w1(),wx.exports=Nt;var Qr=wx.exports;const Fk=dx(Qr);var ug=Qr;Mu.createRoot=ug.createRoot,Mu.hydrateRoot=ug.hydrateRoot;var k1=Symbol.for("immer-nothing"),fg=Symbol.for("immer-draftable"),Ot=Symbol.for("immer-state");function an(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ls=Object.getPrototypeOf;function po(t){return!!t&&!!t[Ot]}function hi(t){var e;return t?C1(t)||Array.isArray(t)||!!t[fg]||!!((e=t.constructor)!=null&&e[fg])||sl(t)||qc(t):!1}var Bk=Object.prototype.constructor.toString(),pg=new WeakMap;function C1(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let r=pg.get(n);return r===void 0&&(r=Function.toString.call(n),pg.set(n,r)),r===Bk}function Oa(t,e,n=!0){Kc(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((r,i)=>e(i,r,t))}function Kc(t){const e=t[Ot];return e?e.type_:Array.isArray(t)?1:sl(t)?2:qc(t)?3:0}function bf(t,e){return Kc(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function E1(t,e,n){const r=Kc(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function _k(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function sl(t){return t instanceof Map}function qc(t){return t instanceof Set}function Wr(t){return t.copy_||t.base_}function Sf(t,e){if(sl(t))return new Map(t);if(qc(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=C1(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Ot];let i=Reflect.ownKeys(r);for(let o=0;o<i.length;o++){const s=i[o],l=r[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[s]})}return Object.create(Ls(t),r)}else{const r=Ls(t);if(r!==null&&n)return{...t};const i=Object.create(r);return Object.assign(i,t)}}function nh(t,e=!1){return Jc(t)||po(t)||!hi(t)||(Kc(t)>1&&Object.defineProperties(t,{set:Rl,add:Rl,clear:Rl,delete:Rl}),Object.freeze(t),e&&Object.values(t).forEach(n=>nh(n,!0))),t}function Hk(){an(2)}var Rl={value:Hk};function Jc(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var Uk={};function mi(t){const e=Uk[t];return e||an(0,t),e}var Ps;function M1(){return Ps}function Vk(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function hg(t,e){e&&(mi("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function wf(t){kf(t),t.drafts_.forEach(Wk),t.drafts_=null}function kf(t){t===Ps&&(Ps=t.parent_)}function mg(t){return Ps=Vk(Ps,t)}function Wk(t){const e=t[Ot];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function gg(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Ot].modified_&&(wf(e),an(4)),hi(t)&&(t=Na(e,t),e.parent_||La(e,t)),e.patches_&&mi("Patches").generateReplacementPatches_(n[Ot].base_,t,e.patches_,e.inversePatches_)):t=Na(e,n,[]),wf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==k1?t:void 0}function Na(t,e,n){if(Jc(e))return e;const r=t.immer_.shouldUseStrictIteration(),i=e[Ot];if(!i)return Oa(e,(o,s)=>yg(t,i,e,o,s,n),r),e;if(i.scope_!==t)return e;if(!i.modified_)return La(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const o=i.copy_;let s=o,l=!1;i.type_===3&&(s=new Set(o),o.clear(),l=!0),Oa(s,(a,c)=>yg(t,i,o,a,c,n,l),r),La(t,o,!1),n&&t.patches_&&mi("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function yg(t,e,n,r,i,o,s){if(i==null||typeof i!="object"&&!s)return;const l=Jc(i);if(!(l&&!s)){if(po(i)){const a=o&&e&&e.type_!==3&&!bf(e.assigned_,r)?o.concat(r):void 0,c=Na(t,i,a);if(E1(n,r,c),po(c))t.canAutoFreeze_=!1;else return}else s&&n.add(i);if(hi(i)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&l)return;Na(t,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(sl(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&La(t,i)}}}function La(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&nh(e,n)}function Kk(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:M1(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,o=rh;n&&(i=[r],o=Fs);const{revoke:s,proxy:l}=Proxy.revocable(i,o);return r.draft_=l,r.revoke_=s,l}var rh={get(t,e){if(e===Ot)return t;const n=Wr(t);if(!bf(n,e))return qk(t,n,e);const r=n[e];return t.finalized_||!hi(r)?r:r===Hd(t.base_,e)?(Ud(t),t.copy_[e]=Ef(r,t)):r},has(t,e){return e in Wr(t)},ownKeys(t){return Reflect.ownKeys(Wr(t))},set(t,e,n){const r=T1(Wr(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const i=Hd(Wr(t),e),o=i==null?void 0:i[Ot];if(o&&o.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(_k(n,i)&&(n!==void 0||bf(t.base_,e)))return!0;Ud(t),Cf(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Hd(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Ud(t),Cf(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Wr(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){an(11)},getPrototypeOf(t){return Ls(t.base_)},setPrototypeOf(){an(12)}},Fs={};Oa(rh,(t,e)=>{Fs[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Fs.deleteProperty=function(t,e){return Fs.set.call(this,t,e,void 0)};Fs.set=function(t,e,n){return rh.set.call(this,t[0],e,n,t[0])};function Hd(t,e){const n=t[Ot];return(n?Wr(n):t)[e]}function qk(t,e,n){var i;const r=T1(e,n);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(t.draft_):void 0}function T1(t,e){if(!(e in t))return;let n=Ls(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Ls(n)}}function Cf(t){t.modified_||(t.modified_=!0,t.parent_&&Cf(t.parent_))}function Ud(t){t.copy_||(t.copy_=Sf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Jk=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const o=n;n=e;const s=this;return function(a=o,...c){return s.produce(a,u=>n.call(this,u,...c))}}typeof n!="function"&&an(6),r!==void 0&&typeof r!="function"&&an(7);let i;if(hi(e)){const o=mg(this),s=Ef(e,void 0);let l=!0;try{i=n(s),l=!1}finally{l?wf(o):kf(o)}return hg(o,r),gg(i,o)}else if(!e||typeof e!="object"){if(i=n(e),i===void 0&&(i=e),i===k1&&(i=void 0),this.autoFreeze_&&nh(i,!0),r){const o=[],s=[];mi("Patches").generateReplacementPatches_(e,i,o,s),r(o,s)}return i}else an(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(s,...l)=>this.produceWithPatches(s,a=>e(a,...l));let r,i;return[this.produce(e,n,(s,l)=>{r=s,i=l}),r,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){hi(t)||an(8),po(t)&&(t=Gk(t));const e=mg(this),n=Ef(t,void 0);return n[Ot].isManual_=!0,kf(e),n}finishDraft(t,e){const n=t&&t[Ot];(!n||!n.isManual_)&&an(9);const{scope_:r}=n;return hg(r,e),gg(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const i=e[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(e=e.slice(n+1));const r=mi("Patches").applyPatches_;return po(t)?r(t,e):this.produce(t,i=>r(i,e))}};function Ef(t,e){const n=sl(t)?mi("MapSet").proxyMap_(t,e):qc(t)?mi("MapSet").proxySet_(t,e):Kk(t,e);return(e?e.scope_:M1()).drafts_.push(n),n}function Gk(t){return po(t)||an(10,t),j1(t)}function j1(t){if(!hi(t)||Jc(t))return t;const e=t[Ot];let n,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=Sf(t,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else n=Sf(t,!0);return Oa(n,(i,o)=>{E1(n,i,j1(o))},r),e&&(e.finalized_=!1),n}var Yk=new Jk,Qk=Yk.produce;let zl;const Xk=new Uint8Array(16);function Zk(){if(!zl&&(zl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!zl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zl(Xk)}const We=[];for(let t=0;t<256;++t)We.push((t+256).toString(16).slice(1));function e2(t,e=0){return We[t[e+0]]+We[t[e+1]]+We[t[e+2]]+We[t[e+3]]+"-"+We[t[e+4]]+We[t[e+5]]+"-"+We[t[e+6]]+We[t[e+7]]+"-"+We[t[e+8]]+We[t[e+9]]+"-"+We[t[e+10]]+We[t[e+11]]+We[t[e+12]]+We[t[e+13]]+We[t[e+14]]+We[t[e+15]]}const t2=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xg={randomUUID:t2};function B(t,e,n){if(xg.randomUUID&&!t)return xg.randomUUID();t=t||{};const r=t.random||(t.rng||Zk)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,e2(r)}const D1=[{id:"professional",name:"Professional Blue",primary:"#003087",secondary:"#0057A8",accent:"#009CDE",background:"#F0F4FA",surface:"#FFFFFF",border:"#C8D9EE",text:"#1A2B4A",muted:"#5A789A",fontDisplay:'"DM Serif Display", Georgia, serif',fontBody:'"DM Sans", system-ui, sans-serif',fontMono:'"DM Mono", ui-monospace, monospace'},{id:"midnight",name:"Midnight Clinical",primary:"#0A0F1E",secondary:"#1A2744",accent:"#4FFFB0",background:"#080C18",surface:"#0F1628",border:"#1E2E50",text:"#E8F0FF",muted:"#6B82AA",fontDisplay:'"DM Serif Display", Georgia, serif',fontBody:'"DM Sans", system-ui, sans-serif',fontMono:'"DM Mono", ui-monospace, monospace'},{id:"editorial",name:"Editorial Print",primary:"#1A1A1A",secondary:"#333333",accent:"#C0392B",background:"#F5F0E8",surface:"#FEFCF8",border:"#D4CABC",text:"#1A1A1A",muted:"#7A6E62",fontDisplay:'"DM Serif Display", Georgia, serif',fontBody:'"DM Sans", system-ui, sans-serif',fontMono:'"DM Mono", ui-monospace, monospace'},{id:"teal",name:"Teal & Sand",primary:"#005F6B",secondary:"#008891",accent:"#F4A261",background:"#F7F3EE",surface:"#FFFFFF",border:"#D4CFC7",text:"#2C3E3F",muted:"#7A8C8D",fontDisplay:'"DM Serif Display", Georgia, serif',fontBody:'"DM Sans", system-ui, sans-serif',fontMono:'"DM Mono", ui-monospace, monospace'}];function n2(t){const e=document.documentElement;e.style.setProperty("--color-primary",t.primary),e.style.setProperty("--color-secondary",t.secondary),e.style.setProperty("--color-accent",t.accent),e.style.setProperty("--color-bg",t.background),e.style.setProperty("--color-surface",t.surface),e.style.setProperty("--color-border",t.border),e.style.setProperty("--color-text",t.text),e.style.setProperty("--color-muted",t.muted),e.style.setProperty("--font-display",t.fontDisplay),e.style.setProperty("--font-body",t.fontBody),e.style.setProperty("--font-mono",t.fontMono)}function Vd(t={}){return{id:B(),title:"Article Title",source:"Source / Journal",url:"",imageUrl:"",pubDate:"",summary:"Brief summary of the study.",clinicalContext:"Clinical context and implications for practice.",myTake:"Your clinical voice here.",evidenceLevel:"Moderate",tags:[],...t}}const Me={header:()=>({id:B(),type:"header",title:"Your Newsletter Title",subtitle:"Your Newsletter Subtitle or Focus Area",issueNumber:"Issue 001",issueDate:new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),tagline:"Edited by Your Name  Your Department  Your Institution",logoUrl:"",logoDataUrl:"",backgroundStyle:"gradient",accentColor:"#009CDE"}),ticker:()=>({id:B(),type:"ticker",sourceMode:"manual",items:["Add your first ticker headline here","Breaking news item two  edit me","Ticker item three  click to customize"],links:[],useLinks:!1,rssUrls:[],rssMaxItems:20,speed:"medium",backgroundColor:"#003087",textColor:"#ffffff"}),"section-divider":()=>({id:B(),type:"section-divider",label:"SECTION TITLE",style:"gradient",number:1,description:""}),"article-grid":()=>({id:B(),type:"article-grid",sectionTitle:"Featured Articles",columns:2,layout:"card",articles:[Vd({title:"Article Title One"}),Vd({title:"Article Title Two"})]}),spotlight:()=>({id:B(),type:"spotlight",article:Vd({title:"Spotlight: Paper of the Month"}),accentColor:"#009CDE",layout:"left-image"}),"ethics-split":()=>({id:B(),type:"ethics-split",heading:"Ethics & Governance Update",subheading:"What it means for practice",leftTitle:"The Concern",leftContent:"Describe the ethical or governance concern here.",rightTitle:"Clinical Perspective",rightContent:"Your perspective and recommended approach.",clinicalPerspective:"",url:"",source:""}),image:()=>({id:B(),type:"image",url:"",dataUrl:"",alt:"",caption:"",linkUrl:"",width:"full",alignment:"center",borderRadius:12}),text:()=>({id:B(),type:"text",html:'<p>Click to edit this text block. You can write <strong>bold</strong>, <em>italic</em>, and include <a href="#">links</a>.</p>',alignment:"left",maxWidth:"reading"}),"html-embed":()=>({id:B(),type:"html-embed",html:'<div style="padding:20px;border:1px dashed #ccc;border-radius:8px;text-align:center;color:#888">Custom HTML content</div>',label:"Custom HTML"}),"prompt-masterclass":()=>({id:B(),type:"prompt-masterclass",heading:"Prompt Like a Rockstar",step:"Step 1  The Baseline",framework:"Context  Task  Constraints",badPrompt:'"Explain MS."',goodPrompt:'Act as a neurology attending. In 120160 words, explain MS pathophysiology focusing on demyelination and immune mechanisms. Exclude treatment and epidemiology. Add 2 "clinical correlates" relevant to bedside localization. If uncertain, say so.',explanation:"Better prompts save time and reduce hallucinations. Persona + task verb + negative constraints + uncertainty disclosure."}),"sbar-prompt":()=>({id:B(),type:"sbar-prompt",heading:"SBAR-P Clinical AI Prompting Framework",steps:[{letter:"S",name:"SITUATION",description:"State the clinical context clearly  the care setting and presenting problem.",example:"58-year-old female admitted with acute decompensated heart failure, EF 25%, currently on IV furosemide."},{letter:"B",name:"BACKGROUND",description:"Provide relevant history, current medications, allergies, and key investigations.",example:"PMH: CKD stage 3 (eGFR 38), type 2 diabetes. Current Cr 2.1 (baseline 1.6). On metformin, lisinopril, carvedilol."},{letter:"A",name:"ASK",description:"Be explicit about exactly what you want. Vague asks produce vague answers.",example:"List the top 5 causes of worsening renal function in this setting and the targeted workup for each."},{letter:"R",name:"ROLE",description:"Assign a clinical persona to anchor the AI's frame of reference and reasoning style.",example:"Respond as a nephrology consultant reviewing this case and preparing a consultation note."},{letter:"P",name:"PARAMETERS",description:"Set safety guardrails: specify the evidence base, require uncertainty disclosure, and define what to do when information is insufficient.",example:"Use current KDIGO 2024 guidelines. Explicitly flag any uncertainty. Do not fabricate lab values or medication doses."}],templatePrompt:`Act as a [SPECIALTY] consultant reviewing this case.

Patient: [AGE] [SEX] presenting with [CHIEF COMPLAINT] for [DURATION].
Key findings: [VITAL SIGNS, EXAM FINDINGS, KEY LABS/IMAGING]
PMH: [RELEVANT COMORBIDITIES]
Current medications: [MED LIST]

Task: Generate a prioritized differential diagnosis (top 5 conditions).
For each diagnosis, provide:
  1. Likelihood assessment (High / Moderate / Low)
  2. Supporting clinical features from this case
  3. Single most informative next investigation

Requirements:
- Base reasoning on current evidence-based guidelines
- Explicitly flag areas of uncertainty
- Do not fabricate laboratory values, imaging findings, or medication doses
- If clinical information is insufficient, state what additional data is needed`,safetyTips:["Always verify AI-generated clinical reasoning against primary sources before acting.","Never submit patient-identifiable information (PHI) to consumer AI tools  use only approved institutional platforms.","AI supports clinical judgment; it does not replace it. Final decisions remain with the treating clinician.","Document AI tool use in the medical record where institutional policy requires it."]}),"prompt-template":()=>({id:B(),type:"prompt-template",heading:"Template Prompt",prompt:`Act as a [SPECIALTY] consultant reviewing this case.

Patient: [AGE] [SEX] presenting with [CHIEF COMPLAINT] for [DURATION].
Key findings: [VITAL SIGNS, EXAM FINDINGS, KEY LABS/IMAGING]
PMH: [RELEVANT COMORBIDITIES]
Current medications: [MED LIST]

Task: Generate a prioritized differential diagnosis (top 5 conditions).
For each diagnosis, provide:
  1. Likelihood assessment (High / Moderate / Low)
  2. Supporting clinical features from this case
  3. Single most informative next investigation

Requirements:
- Base reasoning on current evidence-based guidelines
- Explicitly flag areas of uncertainty
- Do not fabricate laboratory values, imaging findings, or medication doses
- If clinical information is insufficient, state what additional data is needed`}),"safety-reminders":()=>({id:B(),type:"safety-reminders",heading:"Safety Reminders",items:["Always verify AI-generated clinical reasoning against primary sources before acting.","Never submit patient-identifiable information (PHI) to consumer AI tools  use only approved institutional platforms.","AI supports clinical judgment; it does not replace it. Final decisions remain with the treating clinician.","Document AI tool use in the medical record where institutional policy requires it."]}),"clinical-prompt-templates":()=>({id:B(),type:"clinical-prompt-templates",heading:"Clinical Prompt Templates",description:"Click any prompt to copy it. Ready-to-use templates for common clinical AI scenarios.",templates:[{id:B(),category:"Differential Diagnosis",title:"Generate Differential Diagnosis",prompt:"Act as a neurology attending. My patient is a [AGE] [SEX] presenting with [SYMPTOM] for [DURATION]. Key findings: [EXAM/LABS/IMAGING]. Generate a prioritized differential (top 5), with likelihood, supporting features, and one targeted investigation for each. Use evidence-based reasoning. Flag uncertainty. Do not fabricate data.",useCase:"Clinical reasoning support for complex presentations"},{id:B(),category:"Discharge Summary",title:"Discharge Summary Draft",prompt:"Act as a hospitalist writing a discharge summary. Patient: [NAME OMITTED], [AGE] [SEX], admitted [DATE] for [PRIMARY DIAGNOSIS]. Hospital course: [BRIEF SUMMARY]. Discharge condition: [STABLE/IMPROVED]. Write a structured discharge summary including: diagnosis, hospital course, discharge medications, follow-up instructions, and return precautions. Use clear patient-friendly language for the patient section.",useCase:"Streamline discharge documentation"},{id:B(),category:"Literature Review",title:"Evidence Summary",prompt:"Summarize the current evidence base for [INTERVENTION/DRUG/PROCEDURE] in patients with [CONDITION]. Include: level of evidence, key RCTs or meta-analyses, effect size, number needed to treat (if applicable), major contraindications, and areas of ongoing debate. Limit to 200 words. Cite uncertainty where evidence is weak. Do not fabricate citations.",useCase:"Quick evidence review at the point of care"},{id:B(),category:"Patient Education",title:"Patient Education Letter",prompt:'Write a patient education letter for a [AGE]-year-old with [DIAGNOSIS]. Explain: what the condition is, why it matters, the recommended treatment plan, what to expect, and when to seek urgent care. Use a 6th-grade reading level. Avoid medical jargon. End with 3 specific "warning signs" requiring immediate emergency evaluation.',useCase:"Generate patient-readable health information"},{id:B(),category:"EEG / EMG Report",title:"Neurophysiology Interpretation",prompt:"Act as a clinical neurophysiologist. Interpret the following EEG/EMG findings and generate a structured report: [PASTE FINDINGS]. Include: technical quality, relevant findings, clinical correlation, and impression. Note limitations. Flag any findings that warrant urgent clinical attention. Do not infer diagnoses beyond what the data supports.",useCase:"Neurophysiology report drafting and review"},{id:B(),category:"Research",title:"Research Abstract Summary",prompt:"Summarize this research paper for a clinical audience. Provide: (1) Study question in one sentence, (2) Study design and population, (3) Primary outcome and result, (4) Key limitations, (5) Clinical bottom line in one sentence. Keep total to 150 words. Do not overstate conclusions beyond what the study supports.",useCase:"Rapid journal club and literature scanning"}]}),"term-of-month":()=>({id:B(),type:"term-of-month",term:"Foundation Model",definition:"A large-scale AI model trained on broad, diverse data that serves as a reusable base adaptable to many downstream tasks  including text, medical imaging, and multimodal applications.",relevance:"Foundation models shift AI from narrow, single-disease algorithms to robust systems that can generalize across conditions  enabling faster iteration and broader utility, while introducing new governance and validation challenges.",clinicalApplication:"A vision foundation model trained on large imaging datasets can screen for multiple conditions from a single inference, rather than requiring separate validated detectors for each pathology.",relatedTerms:["Transfer Learning","Fine-tuning","Large Language Model","GPT","Multimodal AI","BERT"]}),"ai-case-file":()=>({id:B(),type:"ai-case-file",year:"1950",title:"The Turing Test",content:'In 1950, Alan Turing published "Computing Machinery and Intelligence," proposing the Imitation Game as a practical test for machine intelligence. Rather than asking "Can machines think?"  philosophically unanswerable  Turing asked whether a machine could behave indistinguishably from a human in text conversation. This reframing from metaphysics to measurement shaped the next 70 years of AI development.',significance:"The Turing Test established the behavioral benchmark for AI that still drives philosophical debate about machine consciousness, language, and cognition today.",imageUrl:"",imageDataUrl:"",sourceUrl:"https://doi.org/10.1093/mind/LIX.236.433",sourceLabel:"Turing, 1950  Mind Journal"}),"quick-hits":()=>({id:B(),type:"quick-hits",heading:"Quick Hits",hits:[{id:B(),title:"Add article title here",url:"",source:"Journal",summary:"12 line summary."},{id:B(),title:"Add article title here",url:"",source:"Journal",summary:"12 line summary."}]}),humor:()=>({id:B(),type:"humor",heading:" Humor Break",content:"Add your humor, anecdote, or lighthearted content here. Something your readers will smile at.",attribution:" Submitted anonymously",emojiDecor:"",imageUrl:"",imageDataUrl:"",sourceUrl:"",imageHeight:void 0,imageFit:"contain"}),spacer:()=>({id:B(),type:"spacer",height:32,showLine:!1,lineStyle:"solid"}),footer:()=>({id:B(),type:"footer",institution:"Your Institution",department:"Your Department",editors:"Editor Name(s)",unsubscribeUrl:"",subscribeUrl:"",websiteUrl:"",contactEmail:"",copyrightYear:String(new Date().getFullYear()),disclaimer:"This newsletter is for educational purposes only and does not constitute professional advice. Content represents the views of the authors and not the institution.",socials:[],showSocials:!1,nextIssueDate:"",nextIssueTeaser:""}),"ai-safety":()=>({id:B(),type:"ai-safety",heading:"AI Safety Monitor",subheading:"Regulatory updates, incidents, and clinical safety alerts",showLastUpdated:!0,updates:[{id:B(),date:new Date().toISOString().split("T")[0],category:"FDA",title:"FDA Issues Guidance on AI-Enabled Medical Devices",summary:"New guidance emphasizes post-market surveillance requirements for adaptive AI algorithms used in clinical decision support.",url:"https://www.fda.gov/medical-devices/software-medical-device-samd/artificial-intelligence-and-machine-learning-aiml-enabled-medical-devices",severity:"high"},{id:B(),date:new Date().toISOString().split("T")[0],category:"Guideline",title:"AAN Position Statement: Clinical Use of Large Language Models",summary:"The American Academy of Neurology recommends structured validation and institutional oversight before deploying LLMs in patient-facing clinical workflows.",url:"https://www.aan.com",severity:"medium"},{id:B(),date:new Date().toISOString().split("T")[0],category:"Alert",title:"Hallucination Risk: AI Drug Dosing Tools",summary:"Multiple case reports have identified incorrect medication dosing recommendations from consumer AI chatbots used without clinical validation. Institutional guardrails are strongly recommended.",url:"",severity:"critical"}]}),"institutional-spotlight":()=>({id:B(),type:"institutional-spotlight",heading:"Institutional Spotlight",subheading:"Latest news and innovation from your organization",institutionLabel:"Your Institution",autoFetch:!1,lastFetched:"",maxItems:6,items:[{id:B(),category:"Innovation",title:"Add a news item",url:"",pubDate:new Date().toISOString(),summary:"Summary of this initiative or news item.",imageUrl:""}]}),"rss-sidebar":()=>({id:B(),type:"rss-sidebar",heading:"In the Feed This Week",feedUrls:["https://pubmed.ncbi.nlm.nih.gov/rss/search/1/?term=neurology+artificial+intelligence&sort=date","https://jamanetwork.com/rss/site_16/onlineFirst_72.xml","https://pn.bmj.com/rss/current.xml"],items:[],maxItems:15,lastFetched:"",position:"inline",refreshOnView:!1,enableScroll:!1})},Mf={header:"  Header / Masthead",ticker:"  Scrolling News Ticker","section-divider":"  Section Divider","article-grid":"  Article Grid",spotlight:"  Spotlight Article","ethics-split":"   Ethics & Governance",image:"  Image Block",text:"  Rich Text Block","html-embed":"  HTML Embed","prompt-masterclass":"  Prompt Masterclass","sbar-prompt":"  SBAR-P Framework","prompt-template":"  Template Prompt","safety-reminders":"  Safety Reminders","clinical-prompt-templates":"  Clinical Prompt Templates","term-of-month":"  AI Term of the Month","ai-case-file":"  AI Case File / History","quick-hits":"  Quick Hits",humor:"  Humor Break",spacer:"  Spacer",footer:"  Footer","ai-safety":"  AI Safety Monitor","institutional-spotlight":"  Institutional Spotlight","rss-sidebar":"  RSS Feed Panel"};function r2(){const t=B(),e=B(),n=B(),r=B(),i=B(),o=B(),s=B(),l=B(),a=B(),c=B(),u=B(),f=B(),p=B(),h=B(),m=B(),g=B(),v=B(),y=B(),x=B(),b=B();return{meta:{id:B(),title:"My Newsletter  Issue 001",issueNumber:"001",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},theme:D1[0],blockOrder:[t,e,n,r,i,o,s,l,a,c,u,f,p,h,m,g,v,y,x,b],blocks:{[t]:{...Me.header(),id:t},[e]:{...Me.ticker(),id:e},[n]:{...Me["section-divider"](),id:n,label:"TOP NEUROLOGY AI NEWS",number:1},[r]:{...Me["article-grid"](),id:r},[i]:{...Me.spotlight(),id:i},[o]:{...Me["section-divider"](),id:o,label:"AI SAFETY & ETHICS",number:2},[s]:{...Me["ethics-split"](),id:s},[l]:{...Me["ai-safety"](),id:l},[a]:{...Me["section-divider"](),id:a,label:"CLINICAL AI SKILLS",number:3},[c]:{...Me["sbar-prompt"](),id:c},[u]:{...Me["prompt-template"](),id:u},[f]:{...Me["safety-reminders"](),id:f},[p]:{...Me["clinical-prompt-templates"](),id:p},[h]:{...Me["term-of-month"](),id:h},[m]:{...Me["section-divider"](),id:m,label:"NORTHWELL & COMMUNITY",number:4},[g]:{...Me["institutional-spotlight"](),id:g},[v]:{...Me["rss-sidebar"](),id:v},[y]:{...Me.humor(),id:y},[x]:{...Me.spacer(),id:x},[b]:{...Me.footer(),id:b}}}}function i2(t,e){return Qk(t,n=>{switch(e.type){case"LOAD":return e.payload;case"ADD_BLOCK":{const r={...Me[e.payload.blockType](),id:B()};if(n.blocks[r.id]=r,e.payload.afterId){const i=n.blockOrder.indexOf(e.payload.afterId);n.blockOrder.splice(i+1,0,r.id)}else n.blockOrder.push(r.id);break}case"DELETE_BLOCK":{const r=n.blockOrder.indexOf(e.payload.id);r>-1&&n.blockOrder.splice(r,1),delete n.blocks[e.payload.id];break}case"UPDATE_BLOCK":{const r=n.blocks[e.payload.id];r&&Object.assign(r,e.payload.changes);break}case"MOVE_BLOCK":{const{from:r,to:i}=e.payload,[o]=n.blockOrder.splice(r,1);n.blockOrder.splice(i,0,o);break}case"DUPLICATE_BLOCK":{const r=n.blocks[e.payload.id];if(!r)break;const i=JSON.parse(JSON.stringify(r));i.id=B(),n.blocks[i.id]=i;const o=n.blockOrder.indexOf(e.payload.id);n.blockOrder.splice(o+1,0,i.id);break}case"UPDATE_THEME":n.theme=e.payload;break;case"UPDATE_META":Object.assign(n.meta,e.payload);break;case"ADD_ARTICLE":{const r=n.blocks[e.payload.blockId];r!=null&&r.articles&&r.articles.push({id:B(),title:"New Article",source:"",url:"",imageUrl:"",pubDate:"",summary:"",clinicalContext:"",myTake:"",evidenceLevel:"",tags:[]}),(r==null?void 0:r.article)===void 0&&(r==null||r.type);break}case"UPDATE_ARTICLE":{const r=n.blocks[e.payload.blockId];if(r!=null&&r.articles){const i=r.articles.find(o=>o.id===e.payload.articleId);i&&Object.assign(i,e.payload.changes)}else r!=null&&r.article&&e.payload.articleId===r.article.id&&Object.assign(r.article,e.payload.changes);break}case"DELETE_ARTICLE":{const r=n.blocks[e.payload.blockId];r!=null&&r.articles&&(r.articles=r.articles.filter(i=>i.id!==e.payload.articleId));break}case"MOVE_ARTICLE":{const r=n.blocks[e.payload.blockId];if(r!=null&&r.articles){const[i]=r.articles.splice(e.payload.from,1);r.articles.splice(e.payload.to,0,i)}break}case"ADD_QUICK_HIT":{const r=n.blocks[e.payload.blockId];r!=null&&r.hits&&r.hits.push({id:B(),title:"New hit",url:"",source:"",summary:""});break}case"UPDATE_QUICK_HIT":{const r=n.blocks[e.payload.blockId];if(r!=null&&r.hits){const i=r.hits.find(o=>o.id===e.payload.hitId);i&&Object.assign(i,e.payload.changes)}break}case"DELETE_QUICK_HIT":{const r=n.blocks[e.payload.blockId];r!=null&&r.hits&&(r.hits=r.hits.filter(i=>i.id!==e.payload.hitId));break}}n.meta.updatedAt=new Date().toISOString()})}function o2(t){const[e,n]=S.useReducer(i2,r2()),r=S.useCallback(x=>n({type:"LOAD",payload:x}),[]),i=S.useCallback((x,b)=>n({type:"ADD_BLOCK",payload:{blockType:x,afterId:b}}),[]),o=S.useCallback(x=>n({type:"DELETE_BLOCK",payload:{id:x}}),[]),s=S.useCallback((x,b)=>n({type:"UPDATE_BLOCK",payload:{id:x,changes:b}}),[]),l=S.useCallback((x,b)=>n({type:"MOVE_BLOCK",payload:{from:x,to:b}}),[]),a=S.useCallback(x=>n({type:"DUPLICATE_BLOCK",payload:{id:x}}),[]),c=S.useCallback(x=>n({type:"UPDATE_THEME",payload:x}),[]),u=S.useCallback(x=>n({type:"UPDATE_META",payload:x}),[]),f=S.useCallback(x=>n({type:"ADD_ARTICLE",payload:{blockId:x}}),[]),p=S.useCallback((x,b,w)=>n({type:"UPDATE_ARTICLE",payload:{blockId:x,articleId:b,changes:w}}),[]),h=S.useCallback((x,b)=>n({type:"DELETE_ARTICLE",payload:{blockId:x,articleId:b}}),[]),m=S.useCallback((x,b,w)=>n({type:"MOVE_ARTICLE",payload:{blockId:x,from:b,to:w}}),[]),g=S.useCallback(x=>n({type:"ADD_QUICK_HIT",payload:{blockId:x}}),[]),v=S.useCallback((x,b,w)=>n({type:"UPDATE_QUICK_HIT",payload:{blockId:x,hitId:b,changes:w}}),[]),y=S.useCallback((x,b)=>n({type:"DELETE_QUICK_HIT",payload:{blockId:x,hitId:b}}),[]);return{newsletter:e,load:r,addBlock:i,deleteBlock:o,updateBlock:s,moveBlock:l,duplicateBlock:a,updateTheme:c,updateMeta:u,addArticle:f,updateArticle:p,deleteArticle:h,moveArticle:m,addQuickHit:g,updateQuickHit:v,deleteQuickHit:y}}const vg="nap:autosave",Wd="nap:versions";function s2(){const[t,e]=S.useState(()=>{try{return JSON.parse(localStorage.getItem(Wd)||"[]")}catch{return[]}}),n=S.useCallback(a=>{try{localStorage.setItem(vg,JSON.stringify(a))}catch{console.warn("Autosave failed")}},[]),r=S.useCallback(()=>{try{const a=localStorage.getItem(vg);return a?JSON.parse(a):null}catch{return null}},[]),i=S.useCallback((a,c)=>{const u={id:B(),label:c||`Version ${new Date().toLocaleString()}`,createdAt:new Date().toISOString(),newsletter:a};e(f=>{const p=[u,...f].slice(0,20);return localStorage.setItem(Wd,JSON.stringify(p)),p})},[]),o=S.useCallback(a=>{e(c=>{const u=c.filter(f=>f.id!==a);return localStorage.setItem(Wd,JSON.stringify(u)),u})},[]),s=S.useCallback(a=>{const c=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=URL.createObjectURL(c),f=document.createElement("a");f.href=u,f.download=`nap-issue-${a.meta.issueNumber||"draft"}.json`,f.click(),URL.revokeObjectURL(u)},[]),l=S.useCallback(a=>new Promise((c,u)=>{const f=new FileReader;f.onload=p=>{var h;try{c(JSON.parse((h=p.target)==null?void 0:h.result))}catch{u(new Error("Invalid JSON file"))}},f.onerror=()=>u(new Error("File read failed")),f.readAsText(a)}),[]);return{versions:t,autosave:n,loadAutosave:r,saveVersion:i,deleteVersion:o,exportJSON:s,importJSON:l}}function l2(t,e,n=3e4){S.useEffect(()=>{const r=setInterval(()=>e(t),n);return()=>clearInterval(r)},[t,e,n])}const a2=[{url:"https://www.frontiersin.org/journals/neuroscience/rss",label:"Frontiers in Neuroscience  RSS",enabled:!0},{url:"https://www.frontiersin.org/journals/neurology/rss",label:"Frontiers in Neurology  RSS",enabled:!0},{url:"https://news.mit.edu/rss/topic/artificial-intelligence2",label:"MIT News  Artificial Intelligence",enabled:!0},{url:"https://www.sciencedaily.com/rss/computers_math/artificial_intelligence.xml",label:"ScienceDaily  Artificial Intelligence",enabled:!0},{url:"https://www.marktechpost.com/feed/",label:"MarkTechPost  AI News",enabled:!0},{url:"https://www.thelancet.com/rssfeed/laneur_current.xml",label:"The Lancet Neurology  Current",enabled:!0},{url:"https://jamanetwork.com/rss/site_16/0.xml",label:"JAMA Neurology  RSS",enabled:!0},{url:"https://www.nature.com/npjdigitalmed.rss",label:"npj Digital Medicine  RSS",enabled:!0},{url:"https://pubmed.ncbi.nlm.nih.gov/rss/search/1x9bY_ZPGMIgWOrGWvQbkjt2X1J5zCH66gaj5UHwPTuOP_TklI/?limit=15&utm_campaign=pubmed-2&fc=20260222062849",label:"PubMed RSS  Neurology AI Search",enabled:!0}],c2="https://api.allorigins.win/get?url=";function d2(t,e){try{const r=new DOMParser().parseFromString(t,"text/xml");if(r.querySelector("parsererror"))return[];const i=Array.from(r.querySelectorAll("item"));return i.length?i.map(s=>{var l,a,c,u,f,p,h,m,g,v,y;return{title:((a=(l=s.querySelector("title"))==null?void 0:l.textContent)==null?void 0:a.trim())||"",link:((u=(c=s.querySelector("link"))==null?void 0:c.textContent)==null?void 0:u.trim())||"",pubDate:((p=(f=s.querySelector("pubDate"))==null?void 0:f.textContent)==null?void 0:p.trim())||"",source:((m=(h=s.querySelector("source"))==null?void 0:h.textContent)==null?void 0:m.trim())||e,description:((v=(g=s.querySelector("description"))==null?void 0:g.textContent)==null?void 0:v.trim())||"",imageUrl:((y=s.querySelector('enclosure[type^="image"]'))==null?void 0:y.getAttribute("url"))||""}}):Array.from(r.querySelectorAll("entry")).map(s=>{var l,a,c,u,f,p,h,m,g,v,y,x,b,w,C;return{title:((a=(l=s.querySelector("title"))==null?void 0:l.textContent)==null?void 0:a.trim())||"",link:((c=s.querySelector("link"))==null?void 0:c.getAttribute("href"))||((f=(u=s.querySelector("link"))==null?void 0:u.textContent)==null?void 0:f.trim())||"",pubDate:((h=(p=s.querySelector("updated"))==null?void 0:p.textContent)==null?void 0:h.trim())||((g=(m=s.querySelector("published"))==null?void 0:m.textContent)==null?void 0:g.trim())||"",source:((y=(v=r.querySelector("feed > title"))==null?void 0:v.textContent)==null?void 0:y.trim())||e,description:((b=(x=s.querySelector("summary"))==null?void 0:x.textContent)==null?void 0:b.trim())||((C=(w=s.querySelector("content"))==null?void 0:w.textContent)==null?void 0:C.trim())||"",imageUrl:""}})}catch{return[]}}function u2(){const[t,e]=S.useState(a2),[n,r]=S.useState([]),[i,o]=S.useState(!1),[s,l]=S.useState([]),[a,c]=S.useState(""),u=S.useCallback(async()=>{o(!0),l([]);const g=[],v=[];for(const b of t.filter(w=>w.enabled))try{const w=await fetch(c2+encodeURIComponent(b.url),{cache:"no-store"});if(!w.ok)throw new Error(`HTTP ${w.status}`);const C=await w.json(),E=C&&typeof C.contents=="string"?C.contents:"";g.push(...d2(E,b.label))}catch(w){v.push(`${b.label}: ${w.message}`)}const y=new Set,x=g.filter(b=>!b.link||y.has(b.link)?!1:(y.add(b.link),!0));x.sort((b,w)=>(Date.parse(w.pubDate)||0)-(Date.parse(b.pubDate)||0)),r(x),l(v),o(!1)},[t]),f=a?n.filter(g=>(g.title+" "+g.description).toLowerCase().includes(a.toLowerCase())):n,p=S.useCallback((g,v)=>{e(y=>[...y,{url:g,label:v,enabled:!0}])},[]),h=S.useCallback(g=>{e(v=>v.filter(y=>y.url!==g))},[]),m=S.useCallback(g=>{e(v=>v.map(y=>y.url===g?{...y,enabled:!y.enabled}:y))},[]);return{feeds:t,items:f,loading:i,errors:s,filter:a,refresh:u,setFilter:c,addFeed:p,removeFeed:h,toggleFeed:m}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var f2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(t,e)=>{const n=S.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:l="",children:a,...c},u)=>S.createElement("svg",{ref:u,...f2,width:i,height:i,stroke:r,strokeWidth:s?Number(o)*24/Number(i):o,className:["lucide",`lucide-${p2(t)}`,l].join(" "),...c},[...e.map(([f,p])=>S.createElement(f,p)),...Array.isArray(a)?a:[a]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=le("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=le("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=le("FileCode2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m5 12-3 3 3 3",key:"oke12k"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=le("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=le("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=le("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=le("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=le("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=le("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=le("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=le("Rss",[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=le("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=le("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=le("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),z1=`(function(){
  'use strict';
  const PROXY = 'https://api.allorigins.win/get?url=';

  // Preset RSS feeds (starter set). Users can add custom URLs.
  const PRESETS = [
    { label: 'Frontiers in Neuroscience  RSS', url: 'https://www.frontiersin.org/journals/neuroscience/rss' },
    { label: 'Frontiers in Neurology  RSS', url: 'https://www.frontiersin.org/journals/neurology/rss' },
    { label: 'MIT News  Artificial Intelligence', url: 'https://news.mit.edu/rss/topic/artificial-intelligence2' },
    { label: 'ScienceDaily  Artificial Intelligence', url: 'https://www.sciencedaily.com/rss/computers_math/artificial_intelligence.xml' },
    { label: 'MarkTechPost  AI News', url: 'https://www.marktechpost.com/feed/' },
    { label: 'The Lancet Neurology  Current', url: 'https://www.thelancet.com/rssfeed/laneur_current.xml' },
    { label: 'JAMA Neurology  RSS', url: 'https://jamanetwork.com/rss/site_16/0.xml' },
    { label: 'npj Digital Medicine  RSS', url: 'https://www.nature.com/npjdigitalmed.rss' },
    { label: 'PubMed RSS  Neurology AI Search', url: 'https://pubmed.ncbi.nlm.nih.gov/rss/search/1x9bY_ZPGMIgWOrGWvQbkjt2X1J5zCH66gaj5UHwPTuOP_TklI/?limit=15&utm_campaign=pubmed-2&fc=20260222062849' }
  ];

  function esc(s){ return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

  function parseXml(xml){
    try {
      const doc = new DOMParser().parseFromString(xml,'text/xml');
      if(doc.querySelector('parsererror')) return [];
      const items = Array.from(doc.querySelectorAll('item'));
      if(items.length) return items.map(el=>({
        title:(el.querySelector('title')?.textContent||'').trim(),
        url:(el.querySelector('link')?.textContent||'').trim(),
        date:(el.querySelector('pubDate')?.textContent||'').trim(),
        source:''
      })).filter(x=>x.title);
      return Array.from(doc.querySelectorAll('entry')).map(el=>({
        title:(el.querySelector('title')?.textContent||'').trim(),
        url:(el.querySelector('link')?.getAttribute('href')||el.querySelector('link')?.textContent||'').trim(),
        date:(el.querySelector('updated')?.textContent||'').trim(),
        source:''
      })).filter(x=>x.title);
    } catch(e){ return []; }
  }

  async function fetchFeed(url){
    try {
      const res = await fetch(PROXY+encodeURIComponent(url),{cache:'no-store'});
      if(!res.ok) return [];
      const data = await res.json();
      const xml = (data && typeof data.contents === 'string') ? data.contents : '';
      return parseXml(xml);
    } catch(e){ return []; }
  }

  function dedupe(arr,max){
    const seen=new Set();
    return arr.filter(x=>{const k=x.url||x.title;if(!k||seen.has(k))return false;seen.add(k);return true;}).slice(0,Math.max(1,max));
  }

  function getCssVar(v){ return getComputedStyle(document.documentElement).getPropertyValue(v).trim(); }

  function storageKey(kind,key){ return 'nap_rss_'+kind+'_'+(key||'default'); }
  function safeJsonParse(raw, fallback){ try{ const v=JSON.parse(raw); return v ?? fallback; }catch(e){ return fallback; } }

  function getSelectedFeeds(kind, el){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key);
    const saved = safeJsonParse(localStorage.getItem(k) || 'null', null);
    if(Array.isArray(saved) && saved.length) return saved;
    const raw = (kind==='sidebar') ? (el.getAttribute('data-feeds')||'[]') : (el.getAttribute('data-rss')||'[]');
    const arr = safeJsonParse(raw, []);
    return Array.isArray(arr) ? arr : [];
  }

  function setSelectedFeeds(kind, el, feeds){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key);
    localStorage.setItem(k, JSON.stringify(feeds));
    if(kind==='sidebar') el.setAttribute('data-feeds', JSON.stringify(feeds));
    else el.setAttribute('data-rss', JSON.stringify(feeds));
  }

  function getLiveEnabled(kind, el){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_live';
    const v = localStorage.getItem(k);
    if(v==='1') return true;
    return (el.getAttribute('data-live')||'0') === '1';
  }

  function setLiveEnabled(kind, el, on){
    el.setAttribute('data-live', on ? '1' : '0');
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_live';
    localStorage.setItem(k, on ? '1' : '0');
  }

  function getMaxItems(kind, el){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_max';
    const v = localStorage.getItem(k);
    if(v && /^\\d+$/.test(v)) return parseInt(v,10);
    if(kind==='ticker') return parseInt(el.getAttribute('data-rss-max')||'20',10);
    return parseInt(el.getAttribute('data-max')||'10',10);
  }

  function getMaxFeeds(kind, el){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_maxfeeds';
    const v = localStorage.getItem(k);
    if(v && /^\\d+$/.test(v)) return parseInt(v,10);
    const attr = el.getAttribute('data-max-feeds');
    if(attr && /^\\d+$/.test(attr)) return parseInt(attr,10);
    return 10;
  }

  function setMaxFeeds(kind, el, n){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_maxfeeds';
    const val = String(Math.min(20, Math.max(5, parseInt(n,10)||10)));
    localStorage.setItem(k, val);
    el.setAttribute('data-max-feeds', val);
  }

  function setMaxItems(kind, el, n){
    const key = el.getAttribute('data-key') || 'default';
    const k = storageKey(kind, key) + '_max';
    const val = String(Math.min(50, Math.max(1, parseInt(n,10)||10)));
    localStorage.setItem(k, val);
    if(kind==='ticker') el.setAttribute('data-rss-max', val);
    else el.setAttribute('data-max', val);
  }

  function applySidebarMax(el){
    try{
      const container = el.querySelector('.nap-rss-items');
      if(!container) return;
      const max = getMaxItems('sidebar', el);
      const kids = Array.from(container.children);
      kids.forEach((node, idx)=>{ node.style.display = (idx < max) ? '' : 'none'; });
    } catch(e){}
  }

  const CUSTOM_PRESETS_KEY = 'nap_rss_custom_presets_v1';
  function loadCustomPresets(){
    const raw = localStorage.getItem(CUSTOM_PRESETS_KEY);
    const arr = safeJsonParse(raw || '[]', []);
    return Array.isArray(arr) ? arr.filter(x=>x && x.url) : [];
  }
  function saveCustomPresets(arr){
    try{ localStorage.setItem(CUSTOM_PRESETS_KEY, JSON.stringify(arr||[])); }catch(e){}
  }
  function deriveLabel(url){
    try{ const u=new URL(url); return u.hostname.replace(/^www\\./,''); }catch(e){ return 'Custom RSS'; }
  }

  function renderPresetList(el, kind){
    const list = el.querySelector('.nap-rss-preset-list');
    if(!list) return;
    const selected = new Set(getSelectedFeeds(kind, el));
    const text = kind==='ticker' ? 'rgba(255,255,255,0.92)' : (getCssVar('--c-text')||'#1A2B4A');
    const muted = kind==='ticker' ? 'rgba(255,255,255,0.75)' : (getCssVar('--c-muted')||'#5A789A');
    const fb=getCssVar('--f-body')||'system-ui';
    const customs = loadCustomPresets();
    const allPresets = PRESETS.concat(customs);
    list.innerHTML = allPresets.map(p => {
      const checked = selected.has(p.url) ? 'checked' : '';
      const isCustom = !PRESETS.some(x=>x.url===p.url);
      const removeBtn = isCustom ? '<button type="button" data-remove="'+esc(p.url)+'" style="margin-left:auto;border:none;background:transparent;color:'+muted+';cursor:pointer;font-size:14px;line-height:1"></button>' : '';
      return '<label style="display:flex;gap:8px;align-items:flex-start;font-family:'+fb+';font-size:12px;color:'+text+';line-height:1.3">'
        + '<input type="checkbox" data-url="'+esc(p.url)+'" '+checked+' style="transform:translateY(2px)" />'
        + '<span style="flex:1"><span style="font-weight:600">'+esc(p.label||deriveLabel(p.url))+'</span><br/><span style="color:'+muted+';font-size:11px">'+esc(p.url)+'</span></span>'
        + removeBtn
        + '</label>';
    }).join('');

    list.querySelectorAll('button[data-remove]').forEach(btn => {
      btn.addEventListener('click', (e)=>{
        e.preventDefault(); e.stopPropagation();
        const url = btn.getAttribute('data-remove');
        const customs = loadCustomPresets().filter(x=>x.url!==url);
        saveCustomPresets(customs);
        const next = new Set(getSelectedFeeds(kind, el));
        next.delete(url);
        setSelectedFeeds(kind, el, Array.from(next));
        renderPresetList(el, kind);
        const st = el.querySelector('.nap-rss-status');
        if(st) st.textContent = 'Removed custom feed.';
      });
    });

    list.querySelectorAll('input[type=checkbox]').forEach(cb => {
      cb.addEventListener('change', () => {
        const url = cb.getAttribute('data-url');
        const next = new Set(getSelectedFeeds(kind, el));
        if(cb.checked) next.add(url); else next.delete(url);
        setSelectedFeeds(kind, el, Array.from(next));
        const st = el.querySelector('.nap-rss-status');
        if(st) st.textContent = 'Selected '+next.size+' feed(s).';
      });
    });
  }

  function wireRssConfig(el, kind){
    const details = el.querySelector('.nap-rss-config');
    if(!details) return;
    const live = details.querySelector('.nap-rss-live');
    if(live){
      live.checked = getLiveEnabled(kind, el);
      live.addEventListener('change', () => {
        setLiveEnabled(kind, el, live.checked);
        const st = el.querySelector('.nap-rss-status');
        if(st) st.textContent = live.checked ? 'Live enabled. Refreshing' : 'Live disabled (snapshot).';
        if(live.checked){
          if(kind==='sidebar') hydrateRssSidebar(el);
          else hydrateTicker(el);
        }
      });
    }
    renderPresetList(el, kind);
    const maxFeedsSel = details.querySelector('.nap-rss-maxfeeds');
    if(maxFeedsSel){
      maxFeedsSel.value = String(getMaxFeeds(kind, el));
      maxFeedsSel.addEventListener('change', () => {
        setMaxFeeds(kind, el, maxFeedsSel.value);
        const st = el.querySelector('.nap-rss-status');
        if(st) st.textContent = 'Max feeds: ' + getMaxFeeds(kind, el) + '.';
        if(getLiveEnabled(kind, el)){
          if(kind==='sidebar') hydrateRssSidebar(el);
          else hydrateTicker(el);
        }
      });
    }
    const maxSel = details.querySelector('.nap-rss-max');
    if(maxSel){
      maxSel.value = String(getMaxItems(kind, el));
      maxSel.addEventListener('change', () => {
        setMaxItems(kind, el, maxSel.value);
        const st = el.querySelector('.nap-rss-status');
        if(st) st.textContent = 'Items per feed: ' + getMaxItems(kind, el) + '.';
        if(kind==='sidebar'){
          if(getLiveEnabled('sidebar', el)) hydrateRssSidebar(el);
          else applySidebarMax(el);
        } else {
          if(getLiveEnabled('ticker', el)) hydrateTicker(el);
        }
      });
    }
    const input = details.querySelector('.nap-rss-add');
    const btn = details.querySelector('.nap-rss-add-btn');
    function addUrl(){
      const v = (input && input.value || '').trim();
      if(!v) return;
      try{ new URL(v); } catch(e){ const st=el.querySelector('.nap-rss-status'); if(st) st.textContent='Invalid URL.'; return; }
      const next = new Set(getSelectedFeeds(kind, el));
      next.add(v);
      setSelectedFeeds(kind, el, Array.from(next));
      if(!PRESETS.some(p=>p.url===v)){
        const customs = loadCustomPresets();
        if(!customs.some(p=>p.url===v)){
          customs.unshift({ label: deriveLabel(v), url: v });
          saveCustomPresets(customs.slice(0, 100));
        }
      }
      if(input) input.value='';
      renderPresetList(el, kind);
      const st = el.querySelector('.nap-rss-status');
      if(st) st.textContent='Added feed. Selected '+next.size+' feed(s).';
    }
    if(btn) btn.addEventListener('click', addUrl);
    if(input) input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); addUrl(); } });
    const st = el.querySelector('.nap-rss-status');
    if(st) st.textContent = 'Selected '+getSelectedFeeds(kind, el).length+' feed(s).';
  }

  /*  Ticker  */
  async function hydrateTicker(el){
    if(!el||el.getAttribute('data-source')!=='rss') return;
    if(!getLiveEnabled('ticker', el)) return;
    const urlsAll = getSelectedFeeds('ticker', el);
    const maxFeeds = getMaxFeeds('ticker', el);
    const urls = urlsAll.slice(0, maxFeeds);
    if(!urls.length) return;
    const max=parseInt(el.getAttribute('data-rss-max')||'20',10);
    const all=[];
    for(const u of urls){const items=await fetchFeed(u);all.push(...items);}
    const items=dedupe(all,max);
    if(!items.length) return;
    const textColor=el.style.color||'#fff';
    const accent=getCssVar('--c-accent')||'#009CDE';
    const fm=getCssVar('--f-mono')||'ui-monospace';
    const html=items.map(it=>
      '<a href="'+esc(it.url||'#')+'" target="_blank" rel="noopener noreferrer" '+
      'style="font-family:'+fm+';font-size:12px;color:'+textColor+';padding:0 32px;letter-spacing:0.04em;display:inline-flex;align-items:center;gap:10px;text-decoration:none">'+
      '<span style="width:5px;height:5px;border-radius:50%;background:'+accent+';display:inline-block;flex-shrink:0"></span>'+
      esc(it.title)+'<span style="font-size:10px;opacity:0.6"></span></a>'
    ).join('');
    const track=el.querySelector('.nap-ticker-track');
    if(track) track.innerHTML=html+html;
  }

  /*  RSS Sidebar  */
  async function hydrateRssSidebar(el){
    if(!el) return;
    if(!getLiveEnabled('sidebar', el)) return;
    const feedsAll = getSelectedFeeds('sidebar', el);
    const maxFeeds = getMaxFeeds('sidebar', el);
    const feeds = feedsAll.slice(0, maxFeeds);
    if(!feeds.length) return;
    const max=getMaxItems('sidebar', el);
    const all=[];
    for(const u of feeds){
      const items=await fetchFeed(u);
      try{const host=new URL(u).hostname.replace(/^www\\./,'');items.forEach(it=>it.source=host);}catch(e){}
      all.push(...items);
    }
    const items=dedupe(all,max);
    if(!items.length) return;
    const text=getCssVar('--c-text')||'#1A2B4A';
    const accent=getCssVar('--c-accent')||'#009CDE';
    const muted=getCssVar('--c-muted')||'#5A789A';
    const border=getCssVar('--c-border')||'#C8D9EE';
    const fb=getCssVar('--f-body')||'system-ui';
    const fm=getCssVar('--f-mono')||'ui-monospace';
    function fmtDate(d){try{return new Date(d).toLocaleDateString();}catch(e){return '';}}
    const container=el.querySelector('.nap-rss-items');
    if(!container) return;
    container.innerHTML=items.map((it,i)=>{
      const n=String(i+1).padStart(2,'0');
      const dt=it.date?fmtDate(it.date):'';
      return '<div style="padding:11px 18px;border-bottom:1px solid '+border+';display:flex;gap:10px;align-items:flex-start">'+
        '<span style="font-family:'+fm+';font-size:12px;color:'+accent+';flex-shrink:0;min-width:20px;margin-top:1px">'+n+'</span>'+
        '<div style="flex:1">'+
          '<div style="font-family:'+fb+';font-size:13px;font-weight:600;color:'+text+';line-height:1.3;margin-bottom:3px">'+
            (it.url?'<a href="'+esc(it.url)+'" target="_blank" rel="noopener" style="color:'+text+';text-decoration:none">'+esc(it.title)+'</a>':esc(it.title))+
          '</div>'+
          '<div style="display:flex;gap:8px;align-items:center">'+
            (it.source?'<span style="font-family:'+fm+';font-size:9px;color:'+muted+';text-transform:uppercase;letter-spacing:0.08em">'+esc(it.source)+'</span>':'')+
            (dt?'<span style="font-family:'+fm+';font-size:9px;color:'+muted+'">'+dt+'</span>':'')+
          '</div>'+
        '</div>'+
        (it.url?'<a href="'+esc(it.url)+'" target="_blank" rel="noopener" style="flex-shrink:0;font-family:'+fb+';font-size:11px;color:'+accent+';font-weight:600;text-decoration:none;padding-top:1px"></a>':'')+
      '</div>';
    }).join('');
    const ts=el.querySelector('.nap-rss-timestamp');
    applySidebarMax(el);
    if(ts) ts.textContent='Updated '+new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
  }

  /*  Copy buttons  */
  function initCopyButtons(){
    document.querySelectorAll('.nap-copy-btn').forEach(function(btn){
      btn.addEventListener('click',function(){
        const text=this.getAttribute('data-copy')||'';
        const orig=this.innerHTML;
        const accent=getCssVar('--c-accent')||'#009CDE';
        const done=()=>{
          this.innerHTML=' Copied!';
          this.style.background=accent;
          this.style.color='#fff';
          this.style.border='none';
          setTimeout(()=>{this.innerHTML=orig;this.style.background='';this.style.color='';this.style.border='';},2000);
        };
        if(navigator.clipboard){
          navigator.clipboard.writeText(text).then(done).catch(()=>done());
        } else {
          const ta=document.createElement('textarea');
          ta.value=text;ta.style.position='fixed';ta.style.opacity='0';
          document.body.appendChild(ta);ta.select();document.execCommand('copy');
          document.body.removeChild(ta);done();
        }
      });
    });
  }

  /*  Template expand  */
  function initExpandButtons(){
    document.querySelectorAll('.nap-expand-btn').forEach(function(btn){
      btn.addEventListener('click',function(){
        const target=document.getElementById(this.getAttribute('data-target'));
        if(!target) return;
        const isOpen=target.classList.toggle('open');
        this.textContent=isOpen?'Collapse':'Preview';
      });
    });
  }

  // Wire RSS config UIs (snapshot-first; live optional)
  document.querySelectorAll('.nap-ticker[data-source="rss"]').forEach(el=>wireRssConfig(el,'ticker'));
  document.querySelectorAll('.nap-rss-sidebar').forEach(el=>wireRssConfig(el,'sidebar'));
  document.querySelectorAll('.nap-rss-sidebar').forEach(el=>applySidebarMax(el));

  // Only hydrate if live is enabled (persisted)
  document.querySelectorAll('.nap-ticker[data-source="rss"]').forEach(el=>{ if(getLiveEnabled('ticker', el)) hydrateTicker(el); });
  document.querySelectorAll('.nap-rss-sidebar').forEach(el=>{ if(getLiveEnabled('sidebar', el)) hydrateRssSidebar(el); });
  initCopyButtons();
  initExpandButtons();

  /*  Hourly live refresh  */
  const REFRESH_MS = 60 * 60 * 1000;
  setInterval(function() {
    document.querySelectorAll('.nap-ticker[data-source="rss"]').forEach(el=>{ if(getLiveEnabled('ticker', el)) hydrateTicker(el); });
    document.querySelectorAll('.nap-rss-sidebar').forEach(el=>{ if(getLiveEnabled('sidebar', el)) hydrateRssSidebar(el); });
  }, REFRESH_MS);

  /* Show a subtle "Live" indicator on the RSS sidebar header */
  document.querySelectorAll('.nap-rss-sidebar').forEach(function(rssEl){
    const header = rssEl.querySelector('div');
    if (!header) return;
    const dot = document.createElement('span');
    dot.title = 'Updates every hour (when Live is enabled)';
    dot.style.cssText = 'width:6px;height:6px;border-radius:50%;background:#00A651;display:inline-block;margin-left:auto;animation:nap_pulse 2s ease-in-out infinite;opacity:0.85';
    header.appendChild(dot);
  });
})();`;function T(t){return(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function R2(t){if(!t)return[];if(Array.isArray(t))return t.filter(Boolean).map(String);if(typeof t=="string"){const e=t.split(/\s*,\s*|\n+/g).map(n=>n.trim()).filter(Boolean);return e.length?e:[t.trim()]}return[String(t)]}function z2(t,e){const n=Number.isFinite(e)?`html{font-size:${e}px}`:"";return`
:root {
  --c-primary: ${t.primary};
  --c-secondary: ${t.secondary};
  --c-accent: ${t.accent};
  --c-bg: ${t.background};
  --c-surface: ${t.surface};
  --c-border: ${t.border};
  --c-text: ${t.text};
  --c-muted: ${t.muted};
  --f-display: ${t.fontDisplay};
  --f-body: ${t.fontBody};
  --f-mono: ${t.fontMono};
}
*,*::before,*::after { box-sizing: border-box; }
${n}
html, body { margin: 0; height: auto !important; overflow: auto !important; }
body {
  font-family: var(--f-body);
  color: var(--c-text);
  background: var(--c-bg);
  padding: 22px 0;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* Match builder: links default to accent; white sections inherit; ticker stays white */
a { color: var(--c-accent); text-decoration: none; }
a:hover { text-decoration: underline; }
/* Ticker links always white */
.nap-ticker a { color: inherit !important; text-decoration: none !important; }
.nap-ticker span { color: inherit; }
/* White section links */
.nap-white-section a { color: inherit; }
img { max-width: 100%; display: block; }
/* Export fidelity: DO NOT scale. Keep 1:1 typography and layout. */
.nap-export-wrap { width: 100%; display: flex; justify-content: center; }
.nap-shell {
  max-width: 900px;
  width: 100%;
  margin: 0 auto;
  background: var(--c-surface);
  border: 1px solid var(--c-border);
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 14px 40px rgba(0,0,0,0.10);
}
[contenteditable] { outline: none !important; }
[data-editor-ui], [data-dnd-dragging] { display: none !important; }

@keyframes nap_ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }
@keyframes nap_pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
.nap-ticker-track { display: flex; white-space: nowrap; will-change: transform; }

@media (max-width: 680px) {
  .nap-2col, .nap-3col, .nap-5col { display: block !important; }
  .nap-2col > *, .nap-3col > *, .nap-5col > * { margin-bottom: 14px; }
}

.nap-tpl-prompt { display: none; padding: 10px 14px; }
.nap-tpl-prompt.open { display: block; }
.nap-copy-btn { cursor: pointer; color: #fff !important; }
.nap-expand-btn { cursor: pointer; }
/* Export should NOT truncate RSS: show all items without an internal scroll box. */
.nap-rss-scroll { max-height: none !important; overflow: visible !important; }
/* Safety: enforce SBAR letter styling even if something external tries to override. */
.nap-sbar-letter { font-size:56px !important; font-weight:400 !important; line-height:1 !important; margin-bottom:6px !important; font-style:italic !important; text-transform:uppercase !important; }

/* Export-only: ensure "Related" chips render as clear pills even if imported CSS has aggressive !important rules. */
.ai-related-label { font-weight: 700 !important; }
.ai-related-pill {
  display: inline-block !important;
  background: #F3F6FF !important;
  border: 1px solid var(--c-border) !important;
  color: var(--c-text) !important;
  padding: 4px 10px !important;
  border-radius: 999px !important;
  font-family: var(--f-mono) !important;
  font-size: 11px !important;
  line-height: 16px !important;
  margin: 0 6px 0 0 !important;
}
`}function $2(t,e){return`
<div class="nap-white-section" style="background:${t.backgroundStyle==="solid"?e.primary:`linear-gradient(135deg, ${e.primary} 0%, ${e.secondary} 60%, ${e.accent}44 100%)`};padding:48px 40px;text-align:center;position:relative;overflow:hidden;color:#fff">
  <svg style="position:absolute;bottom:0;left:0;right:0;opacity:0.08" viewBox="0 0 800 60" fill="none" preserveAspectRatio="none" height="60">
    <path d="M0 40 Q200 0 400 30 Q600 60 800 20 L800 60 L0 60Z" fill="white"/>
  </svg>
  ${t.logoDataUrl||t.logoUrl?`<div style="margin-bottom:20px"><img src="${T(t.logoDataUrl||t.logoUrl)}" alt="Logo" style="max-height:60px;max-width:240px;border-radius:8px;display:inline-block;margin:0 auto"></div>`:""}
  <div style="font-family:${e.fontMono};font-size:11px;letter-spacing:0.22em;text-transform:uppercase;color:rgba(255,255,255,0.8);margin-bottom:12px">${T(t.issueNumber)}  ${T(t.issueDate)}</div>
  <h1 style="font-family:${e.fontDisplay};font-size:46px;font-weight:400;color:#fff;margin:0 0 10px;letter-spacing:-0.02em;line-height:1.1">${T(t.title)}</h1>
  <p style="font-family:${e.fontDisplay};font-size:20px;font-style:italic;color:rgba(255,255,255,0.92);margin:0 0 18px;line-height:1.3">${T(t.subtitle)}</p>
  <div style="height:1px;background:rgba(255,255,255,0.3);max-width:280px;margin:0 auto 18px"></div>
  <p style="font-family:${e.fontBody};font-size:13px;color:rgba(255,255,255,0.85);margin:0;letter-spacing:0.02em">${T(t.tagline)}</p>
</div>`}function O2(t,e){const n={slow:60,medium:36,fast:20}[t.speed]??36,r=t.textColor||"#ffffff",i=t.backgroundColor||e.primary,o=`<span style="width:5px;height:5px;border-radius:50%;background:${e.accent};display:inline-block;flex-shrink:0"></span>`,s=`font-family:${e.fontMono};font-size:12px;color:${r};padding:0 32px;letter-spacing:0.04em;display:inline-flex;align-items:center;gap:10px;text-decoration:none`;let l="";t.sourceMode==="rss"||t.useLinks?l=(t.links||[]).filter(u=>u==null?void 0:u.text).map(u=>`<a class="nap-ticker-item" href="${T(u.url||"#")}" target="_blank" rel="noopener noreferrer" style="${s}">${o}${T(u.text)}<span style="font-size:10px;opacity:0.6;color:${r}"></span></a>`).join(""):l=(t.items||[]).map(u=>`<span class="nap-ticker-item" style="${s}">${o}${T(u)}</span>`).join("");const a=T(JSON.stringify((t.rssUrls||[]).filter(Boolean))),c=t.sourceMode==="rss"?`
  <details class="nap-rss-config" data-rss-kind="ticker" style="position:relative;z-index:2;margin-left:auto;margin-right:14px">
    <summary style="list-style:none;cursor:pointer;font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:rgba(255,255,255,0.85);padding:6px 10px;border:1px solid rgba(255,255,255,0.25);border-radius:999px;user-select:none">RSS </summary>
    <div style="margin-top:10px;background:rgba(0,0,0,0.35);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2);border-radius:12px;padding:12px;min-width:280px">
      <div style="font-family:${e.fontBody};font-size:12px;color:#fff;margin-bottom:10px;line-height:1.4">Snapshot is shown by default. Enable <b>Live</b> to refresh from selected feeds.</div>
      <label style="display:flex;align-items:center;gap:8px;font-family:${e.fontBody};font-size:12px;color:#fff;margin-bottom:10px">
        <input type="checkbox" class="nap-rss-live" style="transform:translateY(1px)" /> Live RSS
      </label>
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
        <div style="font-family:${e.fontBody};font-size:12px;color:#fff">Feeds</div>
        <select class="nap-rss-maxfeeds" style="margin-left:auto;padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.25);background:rgba(255,255,255,0.08);color:#fff;font-family:${e.fontBody};font-size:12px">
          <option value="5">5</option>
          <option value="8">8</option>
          <option value="10">10</option>
          <option value="12">12</option>
          <option value="15">15</option>
          <option value="20">20</option>
        </select>
      </div>
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
        <div style="font-family:${e.fontBody};font-size:12px;color:#fff">Items total</div>
        <select class="nap-rss-max" style="margin-left:auto;padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.25);background:rgba(255,255,255,0.08);color:#fff;font-family:${e.fontBody};font-size:12px">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
          <option value="30">30</option>
          <option value="50">50</option>
        </select>
      </div>
      <div class="nap-rss-preset-list" style="display:grid;gap:6px"></div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <input class="nap-rss-add" placeholder="Add RSS URL" style="flex:1;padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.25);background:rgba(255,255,255,0.08);color:#fff;font-family:${e.fontBody};font-size:12px" />
        <button class="nap-rss-add-btn" type="button" style="padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.25);background:rgba(255,255,255,0.12);color:#fff;font-family:${e.fontBody};font-size:12px;cursor:pointer">Add</button>
      </div>
      <div class="nap-rss-status" style="margin-top:10px;font-family:${e.fontBody};font-size:12px;color:rgba(255,255,255,0.85)"></div>
    </div>
  </details>`:"";return`
<div class="nap-ticker"
  data-source="${T(t.sourceMode||"manual")}"
  data-rss='${a}'
  data-rss-max="${T(String(t.rssMaxItems||20))}"
  data-live="0"
  data-key="${T(t.id||"ticker")}"
  style="background:${i};overflow:hidden;height:40px;display:flex;align-items:center;color:${r}">
  ${c}
  <div class="nap-ticker-track" style="animation:nap_ticker ${n}s linear infinite">
    ${l}${l}
  </div>
</div>`}function N2(t,e){return t.style==="bold"?`
<div class="nap-white-section" style="background:${e.primary};padding:18px 40px;display:flex;align-items:center;gap:16px;color:#fff">
  ${t.number>0?`<span style="font-family:${e.fontMono};font-size:32px;font-weight:300;color:rgba(255,255,255,0.25);line-height:1">${T(String(t.number).padStart(2,"0"))}</span>`:""}
  <div>
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.22em;text-transform:uppercase;color:rgba(255,255,255,0.5);margin-bottom:2px">Section</div>
    <div style="font-family:${e.fontDisplay};font-size:22px;color:#fff;line-height:1.15">${T(t.label)}</div>
  </div>
</div>`:`
<div style="padding:32px 40px 16px">
  <div style="display:flex;align-items:center;gap:14px;margin-bottom:${t.description?10:0}px">
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.22em;text-transform:uppercase;color:${e.muted};white-space:nowrap">
      <span>${t.number>0?`0${t.number}  `:" "}</span>${T(t.label)}<span> </span>
    </div>
    <div style="flex:1;height:1px;background:linear-gradient(90deg, ${e.border}, transparent)"></div>
  </div>
  ${t.description?`<p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0;line-height:1.6">${T(t.description)}</p>`:""}
</div>`}function L2(t,e){const n=t.columns||2,r=t.layout||"default",i={High:"#00A651",Moderate:"#F47920",Low:"#C0392B","Expert Opinion":"#7B2D8B"},o=(t.articles||[]).map(s=>{const l=s.evidenceLevel?i[s.evidenceLevel]:null,a=s.url?`<a href="${T(s.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(s.title)}</a>`:T(s.title);return`
<div style="border:1px solid ${e.border};border-radius:12px;overflow:hidden;background:${e.surface};display:flex;flex-direction:column">
  ${s.imageUrl?`<div style="height:160px;overflow:hidden;flex-shrink:0"><img src="${T(s.imageUrl)}" alt="${T(s.title)}" style="width:100%;height:100%;object-fit:cover"></div>`:""}
  <div style="padding:${r==="compact"?"10px 14px":"16px"};flex:1;display:flex;flex-direction:column">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;flex-wrap:wrap;gap:6px">
      <span style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:${e.muted}">${T(s.source||"")}</span>
      ${l?`<span style="background:${l}22;color:${l};border:1px solid ${l}44;border-radius:999px;padding:2px 8px;font-family:${e.fontMono};font-size:10px;font-weight:600">${T(s.evidenceLevel)}</span>`:""}
    </div>
    <h3 style="font-family:${e.fontDisplay};font-size:${r==="compact"?16:20}px;color:${e.text};margin:0 0 10px;line-height:1.25;font-weight:400">${a}</h3>
    ${!r.includes("compact")&&s.summary?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0 0 12px;line-height:1.6;flex:1">${T(s.summary)}</p>`:""}
    ${s.clinicalContext?`
    <div style="background:${e.background};border-radius:8px;padding:10px 12px;margin-bottom:10px">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin-bottom:4px">Clinical Context</div>
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.55">${T(s.clinicalContext)}</p>
    </div>`:""}
    ${s.myTake?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.secondary};font-style:italic;margin:0 0 12px;border-left:3px solid ${e.accent};padding-left:10px;line-height:1.5">${T(s.myTake)}</p>`:""}
    ${s.url?`<a href="${T(s.url)}" target="_blank" rel="noopener noreferrer" style="margin-top:auto;display:inline-flex;align-items:center;gap:5px;font-family:${e.fontBody};font-size:12px;color:${e.accent};font-weight:600;text-decoration:none">Read full paper <span style="font-size:14px"></span></a>`:""}
  </div>
</div>`}).join("");return`
<div style="padding:24px 40px">
  ${t.sectionTitle?`<h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 20px;font-weight:400">${T(t.sectionTitle)}</h2>`:""}
  <div class="nap-${n}col" style="display:grid;grid-template-columns:repeat(${n},1fr);gap:20px">${o}</div>
</div>`}function P2(t,e){const n=t.article||{},r=t.accentColor||e.accent,i=t.layout==="top-image",o=t.layout==="left-image",s=!!n.imageUrl,l=n.url?`<a href="${T(n.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(n.title)}</a>`:T(n.title),a=n.url?`<a href="${T(n.url)}" target="_blank" rel="noopener noreferrer" style="display:inline-flex;align-items:center;gap:8px;padding:9px 18px;background:${r};color:#fff;border-radius:8px;font-family:${e.fontBody};font-size:13px;font-weight:600;text-decoration:none">Read the paper </a>`:"",c=`
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.muted};margin-bottom:12px"> Spotlight  ${T(n.source||"")}</div>
    <h2 style="font-family:${e.fontDisplay};font-size:28px;color:${e.text};margin:0 0 12px;font-weight:400;line-height:1.2">${l}</h2>
    ${n.summary?`<p style="font-family:${e.fontBody};font-size:15px;color:${e.muted};margin:0 0 16px;line-height:1.65">${T(n.summary)}</p>`:""}
    ${n.clinicalContext?`
    <div style="background:${e.background};border-radius:10px;padding:14px 16px;margin-bottom:14px">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin-bottom:6px">Clinical Context</div>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.text};margin:0;line-height:1.6">${T(n.clinicalContext)}</p>
    </div>`:""}
    ${n.myTake?`<p style="font-family:${e.fontBody};font-size:14px;font-style:italic;color:${e.secondary};margin:0 0 16px;border-left:3px solid ${r};padding-left:12px;line-height:1.6">${T(n.myTake)}</p>`:""}
    ${a}`;if(i&&s)return`
<div style="padding:24px 40px">
  <div style="border:1px solid ${e.border};border-radius:14px;overflow:hidden;background:${e.surface}">
    <img src="${T(n.imageUrl)}" alt="${T(n.title||"")}" style="width:100%;height:280px;object-fit:cover">
    <div style="padding:24px">${c}</div>
  </div>
</div>`;const u=s?`<div style="width:40%;flex-shrink:0"><img src="${T(n.imageUrl)}" alt="${T(n.title||"")}" style="width:100%;height:100%;object-fit:cover;display:block"></div>`:"",f=s?o?"row":"row-reverse":"column",p=s&&o?`border-left:4px solid ${r};`:"";return`
<div style="padding:24px 40px">
  <div style="border:1px solid ${e.border};border-radius:14px;overflow:hidden;background:${e.surface};display:flex;flex-direction:${f}">
    ${u}
    <div style="flex:1;padding:28px;${p}">${c}</div>
  </div>
</div>`}function F2(t,e){const n=t.source?t.url?`<a href="${T(t.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.accent}">${T(t.source)}</a>`:T(t.source):"";return`
<div style="padding:28px 40px">
  <div style="margin-bottom:20px">
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent};margin-bottom:6px"> AI Ethics &amp; Governance</div>
    <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 6px;font-weight:400">${T(t.heading||"")}</h2>
    <p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0">${T(t.subheading||"")}</p>
    ${t.source!==void 0?`<div style="font-family:${e.fontMono};font-size:11px;color:${e.muted};margin-top:6px">Source: ${n}</div>`:""}
  </div>
  <div class="nap-2col" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px">
    <div style="border:1px solid ${e.border};border-radius:12px;padding:20px;background:${e.background}">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:#C0392B;font-weight:700;margin-bottom:10px">${T(t.leftTitle||"")}</div>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.text};margin:0;line-height:1.65">${T(t.leftContent||"")}</p>
    </div>
    <div style="border:1px solid ${e.accent}44;border-radius:12px;padding:20px;background:${e.accent}0A">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:${e.accent};font-weight:700;margin-bottom:10px">${T(t.rightTitle||"")}</div>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.text};margin:0;line-height:1.65">${T(t.rightContent||"")}</p>
    </div>
  </div>
  <div style="padding:14px 18px;border:1px solid ${e.border};border-radius:12px;border-left:4px solid ${e.accent}">
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:${e.muted};margin-bottom:6px">Clinical Perspective</div>
    <p style="font-family:${e.fontBody};font-size:14px;color:${e.text};margin:0;line-height:1.65">${T(t.clinicalPerspective||"")}</p>
  </div>
</div>`}function B2(t,e){const n=t.dataUrl||t.url;if(!n)return"";const i={full:"100%",wide:"80%",medium:"60%",small:"40%"}[t.width]||"100%",o=`<img src="${T(n)}" alt="${T(t.alt||"")}" style="max-width:${i};border-radius:${Number(t.borderRadius??12)}px;display:inline-block">`;return`
<div style="padding:16px 40px;text-align:${T(t.alignment||"center")}">
  ${t.linkUrl?`<a href="${T(t.linkUrl)}" target="_blank" rel="noopener noreferrer" style="display:inline-block;max-width:${i}">${o}</a>`:o}
  ${t.caption?`<p style="font-family:${e.fontBody};font-size:12px;color:${e.muted};margin:8px 0 0;text-align:center">${T(t.caption)}</p>`:""}
</div>`}function _2(t,e){const n={full:"100%",reading:"720px",narrow:"560px"};return`
<div style="padding:16px 40px">
  <div style="font-family:${e.fontBody};color:${e.text};line-height:1.7;max-width:${n[t.maxWidth]||"100%"};margin:0 auto;text-align:${T(t.alignment||"left")};font-size:15px">
    ${t.html||""}
  </div>
</div>`}function H2(t,e){return`
<div style="padding:16px 40px">
  ${t.label?`<div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin-bottom:8px"> ${T(t.label)}</div>`:""}
  <div>${t.html||""}</div>
</div>`}function U2(t,e){return`
<div style="padding:28px 40px">
  <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent};margin-bottom:8px"> Prompt Like a Rockstar</div>
  <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 6px;font-weight:400">${T(t.heading||"")}</h2>
  <div style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin-bottom:20px">${T(t.step||"")}  Framework: <strong>${T(t.framework||"")}</strong></div>
  <div class="nap-2col" style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:14px">
    <div style="border:1px solid #f5c6c0;border-radius:12px;padding:16px;background:#FEF0EE">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:#C0392B;margin-bottom:8px"> Bad Prompt</div>
      <p style="font-family:${e.fontBody};font-size:14px;font-style:italic;color:#7A1E12;margin:0;line-height:1.55">${T(t.badPrompt||"")}</p>
    </div>
    <div style="border:1px solid ${e.accent}44;border-radius:12px;padding:16px;background:${e.accent}0D">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:${e.accent};margin-bottom:8px"> Good Prompt</div>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.text};margin:0;line-height:1.55">${T(t.goodPrompt||"")}</p>
    </div>
  </div>
  <div style="padding:12px 16px;background:${e.background};border-radius:10px;border-left:3px solid ${e.accent}">
    <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.6"><strong>Why this matters:</strong> ${T(t.explanation||"")}</p>
  </div>
</div>`}function V2(t,e){const n=[e.primary,e.secondary,e.accent,"#7B2D8B","#00A651"],r=(t.steps||[]).map((i,o)=>{const s=n[o]||e.primary;return`
<div style="border:1px solid ${e.border};border-radius:10px;padding:14px;background:${e.surface}">
  <div class="nap-sbar-letter" style="font-family:${e.fontDisplay};color:${s};">${T((i.letter||"").toUpperCase())}</div>
  <div style="font-family:${e.fontMono};font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:${e.muted};margin-bottom:8px;padding-bottom:8px;border-bottom:2px solid ${s}">${T(i.name||"")}</div>
  <p style="font-family:${e.fontBody};font-size:12px;color:${e.text};margin:0 0 10px;line-height:1.5">${T(i.description||"")}</p>
  <div style="background:${e.background};border-radius:6px;padding:8px 10px;border-left:3px solid ${s}">
    <p style="font-family:${e.fontBody};font-size:11px;color:${e.muted};margin:0;font-style:italic;line-height:1.45">${T(i.example||"")}</p>
  </div>
</div>`}).join("");return`
<div style="padding:28px 40px">
  <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent};margin-bottom:8px"> Clinical AI Prompting</div>
  <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 20px;font-weight:400">${T(t.heading||"")}</h2>
  <div class="nap-5col" style="display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:20px">${r}</div>
</div>`}function W2(t,e){const n=String(t.prompt||""),r=String(t.heading||"Template Prompt");return`
<div style="padding:18px 40px">
  <details style="border:1px solid ${e.border};border-radius:12px;overflow:hidden;background:${e.surface}">
    <summary style="list-style:none;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 14px;user-select:none">
      <div style="display:flex;flex-direction:column;gap:2px">
        <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent}"> Template Prompt</div>
        <div style="font-family:${e.fontDisplay};font-size:18px;color:${e.text};font-weight:500">${T(r)}</div>
      </div>
      <button class="nap-copy-btn" data-copy="${T(n)}" style="padding:7px 12px;background:${e.primary};border:none;border-radius:8px;font-family:${e.fontBody};font-size:12px;color:#fff;cursor:pointer;white-space:nowrap"> Copy</button>
    </summary>
    <div style="padding:12px 14px;background:${e.background};border-top:1px solid ${e.border}">
      <pre style="font-family:${e.fontMono};font-size:12px;color:${e.text};margin:0;white-space:pre-wrap;line-height:1.6">${T(n)}</pre>
    </div>
  </details>
</div>`}function K2(t,e){const n=(t.items||[]).filter(Boolean);if(!n.length)return"";const r=n.length<=2?"1fr":"1fr 1fr";return`
<div style="padding:10px 40px 18px">
  <div style="background:#FFF7E6;border:1px solid #F4D38B;border-radius:12px;padding:14px">
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:#8A5A00;margin-bottom:10px"> ${T(t.heading||"Safety Reminders")}</div>
    <div style="display:grid;grid-template-columns:${r};gap:10px">
      ${n.map(i=>`
        <div style="background:rgba(255,255,255,0.65);border:1px solid ${e.border};border-radius:10px;padding:12px;display:flex;gap:10px">
          <div style="font-family:${e.fontMono};font-size:11px;color:#8A5A00;margin-top:1px"></div>
          <div style="font-family:${e.fontBody};font-size:13px;color:${e.text};line-height:1.6">${T(i)}</div>
        </div>`).join("")}
    </div>
  </div>
</div>`}function q2(t,e){const n={"Differential Diagnosis":e.primary,"Discharge Summary":e.secondary,"Literature Review":e.accent,"Patient Education":"#00A651","EEG / EMG Report":"#7B2D8B",Research:"#F47920"},r=(t.templates||[]).map(i=>{const o=n[i.category]||e.primary,s=`tpl-${T(String(i.id||Math.random().toString(36).slice(2)))}`;return`
<div style="border:1px solid ${e.border};border-radius:10px;overflow:hidden;background:${e.surface}">
  <div style="padding:12px 14px">
    <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:8px">
      <div style="flex:1">
        <div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">
          <span style="font-family:${e.fontMono};font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:#fff;padding:2px 7px;background:${o};border-radius:999px">${T(i.category)}</span>
        </div>
        <div style="font-family:${e.fontBody};font-size:13px;font-weight:600;color:${e.text};margin-bottom:3px">${T(i.title)}</div>
        <div style="font-family:${e.fontBody};font-size:11px;color:${e.muted}">${T(i.useCase)}</div>
      </div>
      <div style="display:flex;gap:4px;flex-shrink:0">
        <button class="nap-expand-btn" data-target="${s}" style="padding:5px 8px;background:none;border:1px solid ${e.border};border-radius:6px;font-family:${e.fontBody};font-size:11px;color:${e.muted}">Preview</button>
        <button class="nap-copy-btn" data-copy="${T(i.prompt)}" style="padding:5px 10px;background:${e.primary};border:none;border-radius:6px;font-family:${e.fontBody};font-size:11px;color:#fff"> Copy</button>
      </div>
    </div>
  </div>
  <div id="${s}" class="nap-tpl-prompt" style="background:${e.background}">
    <pre style="font-family:${e.fontMono};font-size:11px;color:${e.text};margin:0;white-space:pre-wrap;line-height:1.6">${T(i.prompt)}</pre>
  </div>
</div>`}).join("");return`
<div style="padding:28px 40px">
  <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent};margin-bottom:8px"> Ready-to-Use Prompts</div>
  <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 6px;font-weight:400">${T(t.heading||"")}</h2>
  <p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0 0 20px">${T(t.description||"")}</p>
  <div class="nap-2col" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px">${r}</div>
</div>`}function J2(t,e){const n=[{title:"Definition",content:t.definition},{title:"Relevance to Medicine",content:t.relevance},{title:"Clinical Application",content:t.clinicalApplication}];return`
<div style="padding:28px 40px">
  <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.accent};margin-bottom:8px"> AI Term of the Month</div>
  <h2 style="font-family:${e.fontDisplay};font-size:34px;color:${e.text};margin:0 0 20px;font-weight:400">${T(t.term||"")}</h2>
  <div class="nap-3col" style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">
    ${n.map(r=>`
    <div style="border:1px solid ${e.border};border-radius:10px;padding:16px;background:${e.surface}">
      <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin-bottom:8px">${T(r.title)}</div>
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.6">${T(r.content||"")}</p>
    </div>`).join("")}
  </div>
  ${(t.relatedTerms||[]).length?`
  <div style="margin-top:14px;display:flex;flex-wrap:wrap;gap:8px;align-items:center">
    <strong class="ai-related-label" style="font-family:${e.fontBody};font-size:13px;color:${e.text};font-weight:700">Related:</strong>
    ${R2(t.relatedTerms).map(r=>`<span class="ai-related-pill" style="display:inline-block !important;font-family:${e.fontMono} !important;font-size:11px !important;padding:4px 10px !important;background:#F3F6FF !important;border:1px solid ${e.border} !important;border-radius:999px !important;color:${e.text} !important;line-height:16px !important">${T(r)}</span>`).join("")}
  </div>`:""}
</div>`}function G2(t,e){const n=t.imageDataUrl||t.imageUrl;return`
<div style="padding:28px 40px">
  <div style="display:flex;gap:24px;align-items:flex-start">
    <div style="display:flex;flex-direction:column;align-items:center;gap:10px;flex-shrink:0">
      <div style="background:${e.primary};border-radius:10px;padding:14px 18px;text-align:center;color:#fff !important">
        <div style="font-family:${e.fontDisplay};font-size:28px;color:#fff !important;line-height:1;text-shadow:0 1px 0 rgba(0,0,0,0.18)">${T(t.year||"")}</div>
        <div style="font-family:${e.fontMono};font-size:10px;color:rgba(255,255,255,0.92) !important;letter-spacing:0.12em;text-transform:uppercase;margin-top:4px;text-shadow:0 1px 0 rgba(0,0,0,0.12)">AI Case File</div>
      </div>
      ${n?`<div style="width:100px;height:80px;border-radius:8px;overflow:hidden;border:1px solid ${e.border}"><img src="${T(n)}" alt="${T(t.title||"")}" style="width:100%;height:100%;object-fit:cover"></div>`:""}
    </div>
    <div style="flex:1">
      <h3 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 10px;font-weight:400">${T(t.title||"")}</h3>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0 0 12px;line-height:1.65">${T(t.content||"")}</p>
      ${t.significance?`<div style="background:${e.background};border-radius:8px;padding:10px 14px;border-left:3px solid ${e.accent};margin-bottom:12px"><p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.55"><strong>Significance:</strong> ${T(t.significance)}</p></div>`:""}
      ${t.sourceUrl||t.sourceLabel?`<div style="font-family:${e.fontMono};font-size:11px;color:${e.muted}">Source: ${t.sourceUrl?`<a href="${T(t.sourceUrl)}" target="_blank" rel="noopener noreferrer" style="color:${e.accent}">${T(t.sourceLabel||t.sourceUrl)}</a>`:T(t.sourceLabel)}</div>`:""}
    </div>
  </div>
</div>`}function Y2(t,e){const n=(t.hits||[]).map((r,i)=>{const o=r.url?`<a href="${T(r.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(r.title||"")}</a>`:T(r.title||"");return`
<div style="display:flex;gap:14px;align-items:flex-start;padding:12px 14px;border:1px solid ${e.border};border-radius:10px;background:${e.surface}">
  <span style="font-family:${e.fontMono};font-size:18px;color:${e.accent};line-height:1;flex-shrink:0;min-width:28px">${String(i+1).padStart(2,"0")}</span>
  <div style="flex:1">
    <div style="font-family:${e.fontBody};font-size:14px;font-weight:600;color:${e.text};margin-bottom:4px;line-height:1.3">${o}</div>
    <div style="font-family:${e.fontMono};font-size:10px;color:${e.muted};letter-spacing:0.1em;text-transform:uppercase;margin-bottom:4px">${T(r.source||"")}</div>
    ${r.summary?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.5">${T(r.summary)}</p>`:""}
  </div>
  ${r.url?`<a href="${T(r.url)}" target="_blank" rel="noopener noreferrer" style="flex-shrink:0;font-family:${e.fontBody};font-size:11px;color:${e.accent};font-weight:600;text-decoration:none">Read </a>`:""}
</div>`}).join("");return`
<div style="padding:24px 40px">
  <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 16px;font-weight:400"> ${T(t.heading||"")}</h2>
  <div style="display:flex;flex-direction:column;gap:10px">${n}</div>
</div>`}function Q2(t,e){const n=t.imageDataUrl||t.imageUrl,r=t.imageFit||"contain",i=t.imageHeight,o=i?`width:100%;height:${i}px;object-fit:${r};display:block`:"width:100%;height:auto;display:block";return`
<div style="padding:28px 40px">
  <div style="background:linear-gradient(135deg,${e.background},${e.surface});border:1px solid ${e.border};border-radius:16px;overflow:hidden">
    <div style="padding:16px 18px;border-bottom:1px solid ${e.border};display:flex;align-items:center;gap:10px">
      <span style="font-size:18px"></span>
      <div style="font-family:${e.fontDisplay};font-size:20px;color:${e.text};font-weight:400">${T(t.heading||"Humor")}</div>
    </div>
    ${n?`<img src="${T(n)}" alt="" style="${o}">`:""}
    <div style="padding:18px 22px;text-align:center">
      ${n?"":`<div style="font-size:44px;margin-bottom:10px">${T(t.emojiDecor||"")}</div>`}
      ${t.attribution?`<div style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin-bottom:10px">${T(t.attribution)}</div>`:""}
      <div style="font-family:${e.fontBody};font-size:16px;color:${e.text};font-style:italic;line-height:1.65;max-width:760px;margin:0 auto">${T(t.content||"")}</div>
      ${t.sourceUrl?`<div style="margin-top:10px"><a href="${T(t.sourceUrl)}" target="_blank" rel="noopener noreferrer" style="font-family:${e.fontBody};font-size:12px;color:${e.accent};text-decoration:none">Source </a></div>`:""}
    </div>
  </div>
</div>`}function X2(t,e){return`<div style="height:${Number(t.height||24)}px;${t.showLine?`border-top:1px ${T(t.lineStyle||"solid")} ${e.border};margin:0 40px`:""}"></div>`}function Z2(t,e){const n={critical:{color:"#C0392B",bg:"#FEF0EE",border:"#f5c6c0",label:"CRITICAL",icon:""},high:{color:"#C06500",bg:"#FFF4E6",border:"#F6D860",label:"HIGH",icon:""},medium:{color:"#0057A8",bg:"#EEF4FF",border:"#C8D9EE",label:"MEDIUM",icon:""},informational:{color:"#005F6B",bg:"#F0FAFA",border:"#B2E0E4",label:"INFO",icon:""}},r=(t.updates||[]).map(i=>{const o=n[i.severity]||n.informational,s=i.url?`<a href="${T(i.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(i.title||"")}</a>`:T(i.title||"");return`
<div style="border:1px solid ${o.border};border-radius:10px;background:${o.bg}">
  <div style="display:flex;align-items:flex-start;gap:12px;padding:14px 16px">
    <div style="flex-shrink:0;display:flex;flex-direction:column;align-items:center;gap:4px;padding-top:2px">
      <span style="font-size:14px">${o.icon}</span>
      <span style="font-family:${e.fontMono};font-size:8px;letter-spacing:0.1em;text-transform:uppercase;color:${o.color};font-weight:700">${o.label}</span>
    </div>
    <div style="flex:1">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;flex-wrap:wrap">
        <span style="font-family:${e.fontMono};font-size:9px;letter-spacing:0.1em;text-transform:uppercase;color:${o.color};padding:2px 7px;background:${o.color}18;border-radius:999px">${T(i.category||"")}</span>
        <span style="font-family:${e.fontMono};font-size:10px;color:${e.muted}">${T(i.date||"")}</span>
      </div>
      <div style="font-family:${e.fontBody};font-size:14px;font-weight:600;color:${e.text};margin-bottom:4px">${s}</div>
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.55">${T(i.summary||"")}</p>
      ${i.url?`<a href="${T(i.url)}" target="_blank" rel="noopener noreferrer" style="display:inline-block;margin-top:8px;font-family:${e.fontBody};font-size:11px;color:${o.color};font-weight:600">View full guidance </a>`:""}
    </div>
  </div>
</div>`}).join("");return`
<div style="padding:28px 40px">
  <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:10px">
    <div>
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
        <span style="font-size:18px"></span>
        <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:#C0392B">AI Safety Monitor</div>
      </div>
      <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 4px;font-weight:400">${T(t.heading||"")}</h2>
      <p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0">${T(t.subheading||"")}</p>
    </div>
    ${t.showLastUpdated?`<div style="font-family:${e.fontMono};font-size:10px;color:${e.muted};text-align:right;line-height:1.4">Last updated<br>${new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}</div>`:""}
  </div>
  <div style="display:flex;flex-direction:column;gap:12px">${r}</div>
</div>`}function eC(t,e){const n=(t.items||[]).slice(0,t.maxItems||6).map(r=>`
<div style="border:1px solid ${e.border};border-radius:10px;overflow:hidden;background:${e.surface};display:flex;flex-direction:column">
  ${r.imageUrl?`<div style="height:120px;overflow:hidden"><img src="${T(r.imageUrl)}" alt="${T(r.title)}" style="width:100%;height:100%;object-fit:cover"></div>`:""}
  <div style="padding:14px;flex:1;display:flex;flex-direction:column">
    ${r.category?`<span style="font-family:${e.fontMono};font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:${e.accent};margin-bottom:6px;display:block">${T(r.category)}</span>`:""}
    <div style="font-family:${e.fontBody};font-size:13px;font-weight:600;color:${e.text};margin-bottom:6px;line-height:1.35;flex:1">
      ${r.url?`<a href="${T(r.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(r.title)}</a>`:T(r.title)}
    </div>
    ${r.summary?`<p style="font-family:${e.fontBody};font-size:12px;color:${e.muted};margin:0 0 8px;line-height:1.5">${T(r.summary)}</p>`:""}
    ${r.pubDate?`<div style="font-family:${e.fontMono};font-size:10px;color:${e.muted}">${new Date(r.pubDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})}</div>`:""}
    ${r.url?`<a href="${T(r.url)}" target="_blank" rel="noopener noreferrer" style="margin-top:8px;font-family:${e.fontBody};font-size:11px;color:${e.accent};font-weight:600;text-decoration:none">Read more </a>`:""}
  </div>
</div>`).join("");return`
<div style="padding:28px 40px">
  <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
    <div style="width:28px;height:28px;background:${e.primary};border-radius:6px;display:flex;align-items:center;justify-content:center;flex-shrink:0"><span style="font-size:14px"></span></div>
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:${e.primary}">${T(t.institutionLabel||"Your Institution")}</div>
  </div>
  <h2 style="font-family:${e.fontDisplay};font-size:26px;color:${e.text};margin:0 0 4px;font-weight:400">${T(t.heading||"")}</h2>
  ${t.subheading?`<p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0 0 20px">${T(t.subheading)}</p>`:""}
  <div class="nap-3col" style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px">${n}</div>
</div>`}function tC(t,e){const n=(t.feedUrls||[]).filter(Boolean),r=T(JSON.stringify(n)),i=typeof t.maxItems=="number"?t.maxItems:10,o=Math.min(50,Math.max(1,i)),s=(t.items||[]).slice(0,o).map((a,c)=>`
<div style="padding:11px 18px;border-bottom:1px solid ${e.border};display:flex;gap:10px;align-items:flex-start">
  <span style="font-family:${e.fontMono};font-size:12px;color:${e.accent};flex-shrink:0;min-width:20px;margin-top:1px">${String(c+1).padStart(2,"0")}</span>
  <div style="flex:1">
    <div style="font-family:${e.fontBody};font-size:13px;font-weight:600;color:${e.text};line-height:1.3;margin-bottom:3px">
      ${a.url?`<a href="${T(a.url)}" target="_blank" rel="noopener noreferrer" style="color:${e.text};text-decoration:none">${T(a.title||"")}</a>`:T(a.title||"")}
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      ${a.source?`<span style="font-family:${e.fontMono};font-size:9px;color:${e.muted};text-transform:uppercase;letter-spacing:0.08em">${T(a.source)}</span>`:""}
      ${a.pubDate?`<span style="font-family:${e.fontMono};font-size:9px;color:${e.muted}">${new Date(a.pubDate).toLocaleDateString()}</span>`:""}
    </div>
  </div>
  ${a.url?`<a href="${T(a.url)}" target="_blank" rel="noopener noreferrer" style="flex-shrink:0;font-family:${e.fontBody};font-size:11px;color:${e.accent};font-weight:600;text-decoration:none;padding-top:1px"></a>`:""}
</div>`).join(""),l=`
    <details class="nap-rss-config" data-rss-kind="sidebar" style="padding:10px 18px;border-bottom:1px solid ${e.border};background:${e.background}">
      <summary style="list-style:none;cursor:pointer;font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:${e.muted};user-select:none">RSS sources </summary>
      <div style="margin-top:10px;display:grid;gap:10px">
        <div style="font-family:${e.fontBody};font-size:12px;color:${e.text};line-height:1.45">Snapshot is shown by default. Enable <b>Live</b> to refresh from selected feeds.</div>
        <label style="display:flex;align-items:center;gap:8px;font-family:${e.fontBody};font-size:12px;color:${e.text}">
          <input type="checkbox" class="nap-rss-live" style="transform:translateY(1px)" /> Live RSS
        </label>
        <div style="display:flex;align-items:center;gap:10px">
          <div style="font-family:${e.fontBody};font-size:12px;color:${e.text}">Feeds</div>
          <select class="nap-rss-maxfeeds" style="margin-left:auto;padding:6px 10px;border-radius:10px;border:1px solid ${e.border};background:${e.surface};color:${e.text};font-family:${e.fontBody};font-size:12px">
            <option value="5">5</option>
            <option value="8">8</option>
            <option value="10">10</option>
            <option value="12">12</option>
            <option value="15">15</option>
            <option value="20">20</option>
          </select>
        </div>
        <div style="display:flex;align-items:center;gap:10px">
          <div style="font-family:${e.fontBody};font-size:12px;color:${e.text}">Items per feed</div>
          <select class="nap-rss-max" style="margin-left:auto;padding:6px 10px;border-radius:10px;border:1px solid ${e.border};background:${e.surface};color:${e.text};font-family:${e.fontBody};font-size:12px">
            <option value="3">3</option>
            <option value="5">5</option>
            <option value="8">8</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
          </select>
        </div>
        <div class="nap-rss-preset-list" style="display:grid;gap:6px"></div>
        <div style="display:flex;gap:8px">
          <input class="nap-rss-add" placeholder="Add RSS URL" style="flex:1;padding:8px 10px;border-radius:10px;border:1px solid ${e.border};background:${e.surface};color:${e.text};font-family:${e.fontBody};font-size:12px" />
          <button class="nap-rss-add-btn" type="button" style="padding:8px 10px;border-radius:10px;border:1px solid ${e.border};background:${e.background};color:${e.text};font-family:${e.fontBody};font-size:12px;cursor:pointer">Add</button>
        </div>
        <div class="nap-rss-status" style="font-family:${e.fontBody};font-size:12px;color:${e.muted}"></div>
      </div>
    </details>`;return`
<div style="padding:24px 40px">
  <div class="nap-rss-sidebar" data-feeds='${r}' data-max="${o}" data-live="0" data-key="${T(t.id||t.heading||"rss")}" style="border:1px solid ${e.border};border-radius:12px;overflow:hidden;background:${e.surface}">
    <div style="background:${e.primary};padding:12px 18px;display:flex;align-items:center;gap:8px;color:#fff">
      <span style="font-size:14px"></span>
      <span style="font-family:${e.fontMono};font-size:11px;letter-spacing:0.14em;text-transform:uppercase;color:#fff;font-weight:600">${T(t.heading||"News")}</span>
      <span style="margin-left:auto;font-family:${e.fontMono};font-size:9px;color:rgba(255,255,255,0.7)" class="nap-rss-timestamp">${t.lastFetched?`Updated ${new Date(t.lastFetched).toLocaleDateString()}`:"Snapshot"}</span>
    </div>
    ${l}
    <div class="nap-rss-scroll">
      <div class="nap-rss-items">
        ${s||(n.length?`<div style="padding:24px 18px;text-align:center;color:${e.muted};font-family:${e.fontBody};font-size:13px">Snapshot not available yet. Enable Live to fetch.</div>`:`<div style="padding:24px 18px;text-align:center;color:${e.muted};font-family:${e.fontBody};font-size:13px">No feeds configured.</div>`)}
      </div>
    </div>
  </div>
</div>`}function nC(t,e){const n=t.contactEmail||"",r=n?`mailto:${T(n)}?subject=${encodeURIComponent("Newsletter Feedback")}`:"#";return`
<div class="nap-white-section" style="background:${e.primary};padding:44px 40px 36px;text-align:center;color:#fff">
  ${t.nextIssueDate||t.nextIssueTeaser?`
  <div style="background:rgba(255,255,255,0.12);border-radius:10px;padding:14px 20px;margin-bottom:28px;display:inline-block">
    <div style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:rgba(255,255,255,0.75);margin-bottom:4px">Next Issue</div>
    <div style="font-family:${e.fontBody};font-size:14px;color:#fff">${T(t.nextIssueDate||"")}${t.nextIssueTeaser?`  ${T(t.nextIssueTeaser)}`:""}</div>
  </div>`:""}

  <div style="font-family:${e.fontDisplay};font-size:22px;color:#fff;margin-bottom:4px;font-weight:400">${T(t.institution||"")}</div>
  <div style="font-family:${e.fontBody};font-size:14px;color:rgba(255,255,255,0.85);margin-bottom:4px">${T(t.department||"")}</div>
  ${t.editors?`<div style="font-family:${e.fontBody};font-size:13px;color:rgba(255,255,255,0.75);margin-bottom:22px">${T(t.editors)}</div>`:""}

  <div style="display:flex;justify-content:center;margin-bottom:22px">
    <a href="${T(r)}" style="display:inline-flex;align-items:center;gap:10px;font-family:${e.fontBody};font-size:13px;font-weight:700;color:#fff;text-decoration:none;padding:10px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.35);background:rgba(255,255,255,0.10)">
      Contact Us <span style="opacity:0.8"></span>
    </a>
  </div>

  <div style="height:1px;background:rgba(255,255,255,0.18);max-width:240px;margin:0 auto 18px"></div>

  <p style="font-family:${e.fontBody};font-size:11px;color:rgba(255,255,255,0.75);margin:0 0 8px;max-width:580px;margin-left:auto;margin-right:auto;line-height:1.6">${T(t.disclaimer||"")}</p>
  <p style="font-family:${e.fontMono};font-size:10px;color:rgba(255,255,255,0.65);margin:0;letter-spacing:0.1em"> ${T(t.copyrightYear||"")} ${T(t.institution||"")}</p>
</div>`}function rC(){return`<script>
${z1.replace(/<\/script>/g,"<\\/script>")}
<\/script>`}function iC(t,e){const n=t;switch(t.type){case"header":return $2(n,e);case"ticker":return O2(n,e);case"section-divider":return N2(n,e);case"article-grid":return L2(n,e);case"spotlight":return P2(n,e);case"ethics-split":return F2(n,e);case"image":return B2(n,e);case"text":return _2(n,e);case"html-embed":return H2(n,e);case"prompt-masterclass":return U2(n,e);case"sbar-prompt":return V2(n,e);case"prompt-template":return W2(n,e);case"safety-reminders":return K2(n,e);case"clinical-prompt-templates":return q2(n,e);case"term-of-month":return J2(n,e);case"ai-case-file":return G2(n,e);case"quick-hits":return Y2(n,e);case"humor":return Q2(n,e);case"spacer":return X2(n,e);case"ai-safety":return Z2(n,e);case"institutional-spotlight":return eC(n,e);case"rss-sidebar":return tC(n,e);case"footer":return nC(n,e);default:return`<!-- unsupported block: ${t.type} -->`}}function $1(t,e){var a;const{theme:n,blocks:r,blockOrder:i}=t,o=i.map(c=>r[c]?iC(r[c],n):"").join(`
`),s=e==null?void 0:e.baseFontPx,l=(e==null?void 0:e.extraCss)||"";return`<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${T(((a=t.meta)==null?void 0:a.title)||"Newsletter")}</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800;1,9..40,300;1,9..40,400&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
${z2(n,s)}
${l}
</style>
</head>
<body>
<div class="nap-export-wrap">
  <div class="nap-shell">
  ${o}
  </div>
</div>
${rC()}
</body>
</html>`}function oC(t){var a;let e="";try{const c=Array.from(document.styleSheets||[]),u=[];for(const f of c)try{const p=f.cssRules;if(!p)continue;for(const h of Array.from(p))u.push(h.cssText)}catch{}e=u.join(`
`)}catch{e=""}const n=(()=>{try{const c=parseFloat(getComputedStyle(document.documentElement).fontSize);return Number.isFinite(c)?Math.max(12,c*.92):void 0}catch{return}})(),r=$1(t,{baseFontPx:n,extraCss:e}),i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o;const l=(((a=t.meta)==null?void 0:a.issueNumber)||"draft").replace(/\s+/g,"");s.download=`newsletter_issue${l}.html`,s.click(),URL.revokeObjectURL(o)}function A(t){return(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function sC(t){return{fontDisplay:t.fontDisplay.replace(/var\([^)]+\)/g,"Georgia, serif"),fontBody:t.fontBody.replace(/var\([^)]+\)/g,"system-ui, Arial, sans-serif"),fontMono:t.fontMono.replace(/var\([^)]+\)/g,"ui-monospace, Courier New, monospace"),primary:t.primary,secondary:t.secondary,accent:t.accent,bg:t.background,surface:t.surface,border:t.border,text:t.text,muted:t.muted}}function lC(t,e){const n=(t.backgroundStyle==="solid",e.primary);return`
<tr><td bgcolor="${n}" align="center" style="background:${n};padding:40px 32px;text-align:center">
  ${t.logoDataUrl||t.logoUrl?`<img src="${A(t.logoDataUrl||t.logoUrl)}" alt="Logo" width="160" style="max-width:160px;margin-bottom:16px;border-radius:6px;display:block;margin-left:auto;margin-right:auto">`:""}
  <p style="font-family:${e.fontMono};font-size:11px;letter-spacing:0.2em;text-transform:uppercase;color:rgba(255,255,255,0.8);margin:0 0 10px">${A(t.issueNumber)}  ${A(t.issueDate)}</p>
  <h1 style="font-family:${e.fontDisplay};font-size:38px;font-weight:400;color:#ffffff;margin:0 0 10px;line-height:1.1">${A(t.title)}</h1>
  <p style="font-family:${e.fontDisplay};font-size:18px;font-style:italic;color:rgba(255,255,255,0.9);margin:0 0 16px;line-height:1.3">${A(t.subtitle)}</p>
  <p style="font-family:${e.fontBody};font-size:13px;color:rgba(255,255,255,0.8);margin:0">${A(t.tagline)}</p>
</td></tr>`}function aC(t,e){const n=t.backgroundColor||e.primary,r=t.textColor||"#ffffff",i=t.items||[];return i.length?`
<tr><td bgcolor="${n}" style="background:${n};padding:10px 24px">
  <p style="font-family:${e.fontMono};font-size:11px;color:${r};margin:0;letter-spacing:0.06em;line-height:1.6">
    ${i.map(o=>` ${A(o)}`).join("&nbsp;&nbsp;&nbsp;")}
  </p>
</td></tr>`:""}function cC(t,e){return t.style==="bold"?`
<tr><td bgcolor="${e.primary}" style="background:${e.primary};padding:14px 32px">
  <p style="font-family:${e.fontMono};font-size:11px;letter-spacing:0.2em;text-transform:uppercase;color:rgba(255,255,255,0.8);margin:0">
    ${t.number>0?`0${t.number}  `:""}${A(t.label)}
  </p>
</td></tr>`:`
<tr><td style="padding:28px 32px 12px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.2em;text-transform:uppercase;color:${e.muted};margin:0 0 8px">
    ${t.number>0?`0${t.number}  `:""}${A(t.label)}
  </p>
  <hr style="border:none;border-top:1px solid ${e.border};margin:0">
  ${t.description?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:8px 0 0;line-height:1.5">${A(t.description)}</p>`:""}
</td></tr>`}function dC(t,e){const n={High:"#00A651",Moderate:"#F47920",Low:"#C0392B","Expert Opinion":"#7B2D8B"},r=t.evidenceLevel?n[t.evidenceLevel]:null,i=t.url?`<a href="${A(t.url)}" style="color:${e.text};text-decoration:none;font-family:${e.fontDisplay};font-size:18px;font-weight:400;line-height:1.3">${A(t.title)}</a>`:`<span style="font-family:${e.fontDisplay};font-size:18px;color:${e.text};line-height:1.3">${A(t.title)}</span>`;return`
<table width="100%" cellpadding="0" cellspacing="0" border="0" style="border:1px solid ${e.border};border-radius:10px;overflow:hidden;margin-bottom:16px">
  ${t.imageUrl?`<tr><td><img src="${A(t.imageUrl)}" alt="${A(t.title)}" width="100%" style="width:100%;max-height:200px;object-fit:cover;display:block"></td></tr>`:""}
  <tr><td style="padding:16px;background:${e.surface}">
    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:8px">
      <tr>
        <td><span style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted}">${A(t.source||"")}</span></td>
        ${r?`<td align="right"><span style="background:${r}22;color:${r};border:1px solid ${r}44;border-radius:999px;padding:2px 8px;font-family:${e.fontMono};font-size:10px">${A(t.evidenceLevel)}</span></td>`:""}
      </tr>
    </table>
    <div style="margin-bottom:10px">${i}</div>
    ${t.summary?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0 0 10px;line-height:1.6">${A(t.summary)}</p>`:""}
    ${t.myTake?`<p style="font-family:${e.fontBody};font-size:13px;font-style:italic;color:${e.secondary};margin:0 0 10px;padding-left:10px;border-left:3px solid ${e.accent};line-height:1.5">${A(t.myTake)}</p>`:""}
    ${t.url?`<a href="${A(t.url)}" style="display:inline-block;font-family:${e.fontBody};font-size:12px;color:${e.accent};font-weight:600;text-decoration:none">Read full paper </a>`:""}
  </td></tr>
</table>`}function uC(t,e){const n=t.articles||[];return n.length?`
<tr><td style="padding:20px 32px">
  ${t.sectionTitle?`<h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 18px;font-weight:400">${A(t.sectionTitle)}</h2>`:""}
  ${n.map(r=>dC(r,e)).join("")}
</td></tr>`:""}function fC(t,e){const n=t.article||{},r=t.accentColor||e.accent;return`
<tr><td style="padding:20px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border:1px solid ${e.border};border-radius:12px;overflow:hidden">
    ${n.imageUrl?`<tr><td><img src="${A(n.imageUrl)}" alt="${A(n.title||"")}" width="100%" style="width:100%;max-height:240px;object-fit:cover;display:block"></td></tr>`:""}
    <tr><td style="padding:24px;background:${e.surface};border-left:4px solid ${r}">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.muted};margin:0 0 10px"> Spotlight  ${A(n.source||"")}</p>
      <h2 style="font-family:${e.fontDisplay};font-size:24px;color:${e.text};margin:0 0 10px;font-weight:400;line-height:1.2">
        ${n.url?`<a href="${A(n.url)}" style="color:${e.text};text-decoration:none">${A(n.title)}</a>`:A(n.title)}
      </h2>
      ${n.summary?`<p style="font-family:${e.fontBody};font-size:14px;color:${e.muted};margin:0 0 12px;line-height:1.6">${A(n.summary)}</p>`:""}
      ${n.myTake?`<p style="font-family:${e.fontBody};font-size:13px;font-style:italic;color:${e.secondary};margin:0 0 14px;border-left:3px solid ${r};padding-left:10px;line-height:1.5">${A(n.myTake)}</p>`:""}
      ${n.url?`<a href="${A(n.url)}" style="display:inline-block;padding:9px 18px;background:${r};color:#fff;border-radius:8px;font-family:${e.fontBody};font-size:13px;font-weight:600;text-decoration:none">Read the paper </a>`:""}
    </td></tr>
  </table>
</td></tr>`}function pC(t,e){return`
<tr><td style="padding:14px 32px">
  <div style="font-family:${e.fontBody};color:${e.text};line-height:1.7;font-size:15px">${t.html||""}</div>
</td></tr>`}function hC(t,e){const n=t.hits||[];return`
<tr><td style="padding:20px 32px">
  <h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 16px;font-weight:400">${A(t.heading||"Quick Hits")}</h2>
  ${n.map(r=>`
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:12px;border-left:3px solid ${e.accent}">
    <tr><td style="padding:8px 0 8px 14px">
      <p style="font-family:${e.fontBody};font-size:14px;font-weight:600;color:${e.text};margin:0 0 3px">
        ${r.url?`<a href="${A(r.url)}" style="color:${e.text};text-decoration:none">${A(r.title)}</a>`:A(r.title)}
      </p>
      <p style="font-family:${e.fontMono};font-size:10px;color:${e.muted};margin:0 0 4px;text-transform:uppercase;letter-spacing:0.1em">${A(r.source||"")}</p>
      ${r.summary?`<p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.5">${A(r.summary)}</p>`:""}
    </td></tr>
  </table>`).join("")}
</td></tr>`}function mC(t,e){return`
<tr><td style="padding:20px 32px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.accent};margin:0 0 6px"> AI Ethics &amp; Governance</p>
  <h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 16px;font-weight:400">${A(t.heading||"")}</h2>
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:14px">
    <tr>
      <td width="48%" valign="top" style="padding:16px;background:${e.bg};border:1px solid ${e.border};border-radius:10px">
        <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:#C0392B;margin:0 0 8px">${A(t.leftTitle||"")}</p>
        <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.6">${A(t.leftContent||"")}</p>
      </td>
      <td width="4%"></td>
      <td width="48%" valign="top" style="padding:16px;background:${e.accent}0A;border:1px solid ${e.accent}44;border-radius:10px">
        <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.accent};margin:0 0 8px">${A(t.rightTitle||"")}</p>
        <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.6">${A(t.rightContent||"")}</p>
      </td>
    </tr>
  </table>
  ${t.clinicalPerspective?`
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr><td style="padding:12px 16px;border-left:4px solid ${e.accent};background:${e.surface}">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin:0 0 4px">Clinical Perspective</p>
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.6">${A(t.clinicalPerspective)}</p>
    </td></tr>
  </table>`:""}
</td></tr>`}function gC(t,e){const n=t.contactEmail||"";return`
<tr><td bgcolor="${e.primary}" align="center" style="background:${e.primary};padding:36px 32px;text-align:center">
  ${t.nextIssueDate||t.nextIssueTeaser?`
  <table cellpadding="0" cellspacing="0" border="0" align="center" style="margin-bottom:20px">
    <tr><td style="padding:10px 18px;background:rgba(255,255,255,0.12);border-radius:8px">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:rgba(255,255,255,0.7);margin:0 0 3px">Next Issue</p>
      <p style="font-family:${e.fontBody};font-size:13px;color:#fff;margin:0">${A(t.nextIssueDate||"")}${t.nextIssueTeaser?`  ${A(t.nextIssueTeaser)}`:""}</p>
    </td></tr>
  </table>`:""}
  <h3 style="font-family:${e.fontDisplay};font-size:20px;color:#fff;margin:0 0 4px;font-weight:400">${A(t.institution||"")}</h3>
  <p style="font-family:${e.fontBody};font-size:13px;color:rgba(255,255,255,0.8);margin:0 0 4px">${A(t.department||"")}</p>
  ${t.editors?`<p style="font-family:${e.fontBody};font-size:12px;color:rgba(255,255,255,0.7);margin:0 0 18px">${A(t.editors)}</p>`:""}
  ${n?`<a href="mailto:${A(n)}" style="display:inline-block;padding:9px 16px;border:1px solid rgba(255,255,255,0.35);border-radius:10px;background:rgba(255,255,255,0.10);font-family:${e.fontBody};font-size:13px;color:#fff;text-decoration:none;margin-bottom:20px">Contact Us </a>`:""}
  <hr style="border:none;border-top:1px solid rgba(255,255,255,0.18);max-width:200px;margin:0 auto 16px">
  ${t.disclaimer?`<p style="font-family:${e.fontBody};font-size:10px;color:rgba(255,255,255,0.65);margin:0 0 6px;line-height:1.5;max-width:480px;margin-left:auto;margin-right:auto">${A(t.disclaimer)}</p>`:""}
  ${t.unsubscribeUrl?`<p style="margin:0"><a href="${A(t.unsubscribeUrl)}" style="font-family:${e.fontMono};font-size:10px;color:rgba(255,255,255,0.5);text-decoration:underline">Unsubscribe</a></p>`:""}
  <p style="font-family:${e.fontMono};font-size:10px;color:rgba(255,255,255,0.5);margin:6px 0 0;letter-spacing:0.08em"> ${A(t.copyrightYear||String(new Date().getFullYear()))} ${A(t.institution||"")}</p>
</td></tr>`}function yC(t){return`<tr><td height="${t.height||24}" style="font-size:0;line-height:0">&nbsp;</td></tr>`}function xC(t,e){return`
<tr><td style="padding:20px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background:${e.bg};border:1px solid ${e.border};border-radius:12px">
    <tr><td style="padding:24px;text-align:center">
      ${t.imageUrl?`<img src="${A(t.imageUrl)}" alt="" width="100%" style="max-height:200px;object-fit:cover;border-radius:8px;margin-bottom:16px;display:block">`:""}
      <p style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 14px;font-weight:400">${A(t.heading||"")}</p>
      <p style="font-family:${e.fontBody};font-size:15px;color:${e.text};margin:0 0 10px;line-height:1.6;font-style:italic">${A(t.content||"")}</p>
      ${t.attribution?`<p style="font-family:${e.fontMono};font-size:11px;color:${e.muted};margin:0">${A(t.attribution)}</p>`:""}
    </td></tr>
  </table>
</td></tr>`}function vC(t,e){return`
<tr><td style="padding:20px 32px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.accent};margin:0 0 6px"> AI Term of the Month</p>
  <h2 style="font-family:${e.fontDisplay};font-size:28px;color:${e.text};margin:0 0 18px;font-weight:400">${A(t.term||"")}</h2>
  ${[{label:"Definition",val:t.definition},{label:"Relevance to Practice",val:t.relevance},{label:"Clinical Application",val:t.clinicalApplication}].filter(n=>n.val).map(n=>`
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:12px">
    <tr><td style="padding:14px 16px;border:1px solid ${e.border};border-radius:10px;background:${e.surface}">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:${e.muted};margin:0 0 6px">${A(n.label)}</p>
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.6">${A(n.val)}</p>
    </td></tr>
  </table>`).join("")}
</td></tr>`}function bC(t,e){const n=String(t.prompt||"");return n?`
<tr><td style="padding:14px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border:1px solid ${e.border};border-radius:10px;overflow:hidden">
    <tr><td style="padding:12px 16px;background:${e.surface}">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.accent};margin:0 0 4px"> Template Prompt</p>
      <p style="font-family:${e.fontDisplay};font-size:16px;color:${e.text};margin:0 0 10px;font-weight:500">${A(t.heading||"Prompt Template")}</p>
    </td></tr>
    <tr><td style="padding:14px 16px;background:${e.bg}">
      <pre style="font-family:${e.fontMono};font-size:11px;color:${e.text};margin:0;white-space:pre-wrap;line-height:1.6">${A(n)}</pre>
    </td></tr>
  </table>
</td></tr>`:""}function SC(t,e){const n=(t.items||[]).filter(Boolean);return n.length?`
<tr><td style="padding:12px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background:#FFF7E6;border:1px solid #F4D38B;border-radius:10px">
    <tr><td style="padding:14px 16px">
      <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:#8A5A00;margin:0 0 10px"> ${A(t.heading||"Safety Reminders")}</p>
      ${n.map(r=>`
      <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:8px">
        <tr><td style="padding:10px 12px;background:rgba(255,255,255,0.65);border:1px solid ${e.border};border-radius:8px">
          <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.55"> ${A(r)}</p>
        </td></tr>
      </table>`).join("")}
    </td></tr>
  </table>
</td></tr>`:""}function wC(t,e){const n={critical:{color:"#C0392B",bg:"#FEF0EE",border:"#f5c6c0",label:"CRITICAL",icon:""},high:{color:"#C06500",bg:"#FFF4E6",border:"#F6D860",label:"HIGH",icon:""},medium:{color:"#0057A8",bg:"#EEF4FF",border:"#C8D9EE",label:"MEDIUM",icon:""},informational:{color:"#005F6B",bg:"#F0FAFA",border:"#B2E0E4",label:"INFO",icon:""}},r=(t.updates||[]).map(i=>{const o=n[i.severity]||n.informational,s=i.url?`<a href="${A(i.url)}" style="color:${e.text};text-decoration:none;font-weight:600">${A(i.title||"")}</a>`:`<span style="font-weight:600">${A(i.title||"")}</span>`;return`
    <tr><td style="padding:10px 14px;background:${o.bg};border:1px solid ${o.border};border-radius:8px;margin-bottom:8px">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td width="28" valign="top" style="padding-right:10px">
            <p style="font-size:14px;margin:0">${o.icon}</p>
            <p style="font-family:${e.fontMono};font-size:8px;text-transform:uppercase;color:${o.color};font-weight:700;margin:2px 0 0">${o.label}</p>
          </td>
          <td valign="top">
            <p style="font-family:${e.fontMono};font-size:9px;text-transform:uppercase;color:${o.color};margin:0 0 3px">${A(i.category||"")}  ${A(i.date||"")}</p>
            <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0 0 4px">${s}</p>
            <p style="font-family:${e.fontBody};font-size:12px;color:${e.muted};margin:0;line-height:1.5">${A(i.summary||"")}</p>
            ${i.url?`<p style="margin:6px 0 0"><a href="${A(i.url)}" style="font-family:${e.fontBody};font-size:11px;color:${o.color};font-weight:600">View guidance </a></p>`:""}
          </td>
        </tr>
      </table>
    </td></tr>
    <tr><td height="8"></td></tr>`}).join("");return`
<tr><td style="padding:20px 32px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:#C0392B;margin:0 0 6px"> AI Safety Monitor</p>
  <h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 4px;font-weight:400">${A(t.heading||"")}</h2>
  <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0 0 16px">${A(t.subheading||"")}</p>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
    ${r}
  </table>
</td></tr>`}function kC(t,e){return`
<tr><td style="padding:20px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border:1px solid ${e.border};border-radius:10px;overflow:hidden">
    <tr>
      <td width="90" valign="top" bgcolor="${e.primary}" style="background:${e.primary};padding:16px;text-align:center">
        <p style="font-family:${e.fontDisplay};font-size:24px;color:#fff;margin:0;line-height:1">${A(t.year||"")}</p>
        <p style="font-family:${e.fontMono};font-size:9px;color:rgba(255,255,255,0.85);text-transform:uppercase;letter-spacing:0.1em;margin:4px 0 0">AI Case File</p>
      </td>
      <td valign="top" style="padding:16px;background:${e.surface}">
        <h3 style="font-family:${e.fontDisplay};font-size:18px;color:${e.text};margin:0 0 8px;font-weight:400">${A(t.title||"")}</h3>
        <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0 0 8px;line-height:1.55">${A(t.content||"")}</p>
        ${t.significance?`<p style="font-family:${e.fontBody};font-size:12px;color:${e.muted};margin:0;border-left:3px solid ${e.accent};padding-left:10px;line-height:1.5"><strong>Significance:</strong> ${A(t.significance)}</p>`:""}
        ${t.sourceUrl?`<p style="margin:8px 0 0"><a href="${A(t.sourceUrl)}" style="font-family:${e.fontBody};font-size:11px;color:${e.accent};font-weight:600">${A(t.sourceLabel||"Source ")}</a></p>`:""}
      </td>
    </tr>
  </table>
</td></tr>`}function CC(t,e){const n=(t.items||[]).slice(0,Math.min(t.maxItems||6,6));return n.length?`
<tr><td style="padding:20px 32px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.primary};margin:0 0 6px"> ${A(t.institutionLabel||"Your Institution")}</p>
  <h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 16px;font-weight:400">${A(t.heading||"")}</h2>
  ${n.map(r=>`
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:12px;border:1px solid ${e.border};border-radius:8px;overflow:hidden">
    <tr><td style="padding:12px 14px;background:${e.surface}">
      ${r.category?`<p style="font-family:${e.fontMono};font-size:9px;text-transform:uppercase;letter-spacing:0.1em;color:${e.accent};margin:0 0 4px">${A(r.category)}</p>`:""}
      <p style="font-family:${e.fontBody};font-size:13px;font-weight:600;color:${e.text};margin:0 0 4px;line-height:1.35">
        ${r.url?`<a href="${A(r.url)}" style="color:${e.text};text-decoration:none">${A(r.title)}</a>`:A(r.title)}
      </p>
      ${r.summary?`<p style="font-family:${e.fontBody};font-size:12px;color:${e.muted};margin:0 0 6px;line-height:1.5">${A(r.summary)}</p>`:""}
      ${r.url?`<a href="${A(r.url)}" style="font-family:${e.fontBody};font-size:11px;color:${e.accent};font-weight:600;text-decoration:none">Read more </a>`:""}
    </td></tr>
  </table>`).join("")}
</td></tr>`:""}function EC(t,e){const n=(t.items||[]).slice(0,t.maxItems||10);return n.length?`
<tr><td style="padding:20px 32px">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border:1px solid ${e.border};border-radius:10px;overflow:hidden">
    <tr><td bgcolor="${e.primary}" style="background:${e.primary};padding:10px 16px">
      <p style="font-family:${e.fontMono};font-size:11px;letter-spacing:0.12em;text-transform:uppercase;color:#fff;margin:0"> ${A(t.heading||"News")}</p>
    </td></tr>
    ${n.map((r,i)=>`
    <tr><td style="padding:10px 16px;border-bottom:1px solid ${e.border};background:${e.surface}">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td width="24" valign="top">
            <p style="font-family:${e.fontMono};font-size:12px;color:${e.accent};margin:0">${String(i+1).padStart(2,"0")}</p>
          </td>
          <td valign="top">
            <p style="font-family:${e.fontBody};font-size:13px;font-weight:600;color:${e.text};margin:0 0 2px;line-height:1.3">
              ${r.url?`<a href="${A(r.url)}" style="color:${e.text};text-decoration:none">${A(r.title||"")}</a>`:A(r.title||"")}
            </p>
            <p style="font-family:${e.fontMono};font-size:10px;color:${e.muted};margin:0;text-transform:uppercase">${A(r.source||"")}</p>
          </td>
          ${r.url?`<td width="20" valign="top" align="right"><a href="${A(r.url)}" style="font-family:${e.fontBody};font-size:12px;color:${e.accent};text-decoration:none"></a></td>`:""}
        </tr>
      </table>
    </td></tr>`).join("")}
  </table>
</td></tr>`:""}function MC(t,e){return`
<tr><td style="padding:20px 32px">
  <p style="font-family:${e.fontMono};font-size:10px;letter-spacing:0.16em;text-transform:uppercase;color:${e.accent};margin:0 0 6px"> Prompt Like a Rockstar</p>
  <h2 style="font-family:${e.fontDisplay};font-size:22px;color:${e.text};margin:0 0 4px;font-weight:400">${A(t.heading||"")}</h2>
  <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0 0 16px">${A(t.step||"")}  ${A(t.framework||"")}</p>
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom:14px">
    <tr>
      <td width="48%" valign="top" style="padding:14px;background:#FEF0EE;border:1px solid #f5c6c0;border-radius:10px">
        <p style="font-family:${e.fontMono};font-size:10px;text-transform:uppercase;color:#C0392B;margin:0 0 8px"> Bad Prompt</p>
        <p style="font-family:${e.fontBody};font-size:13px;font-style:italic;color:#7A1E12;margin:0;line-height:1.5">${A(t.badPrompt||"")}</p>
      </td>
      <td width="4%"></td>
      <td width="48%" valign="top" style="padding:14px;background:${e.accent}0D;border:1px solid ${e.accent}44;border-radius:10px">
        <p style="font-family:${e.fontMono};font-size:10px;text-transform:uppercase;color:${e.accent};margin:0 0 8px"> Good Prompt</p>
        <p style="font-family:${e.fontBody};font-size:13px;color:${e.text};margin:0;line-height:1.5">${A(t.goodPrompt||"")}</p>
      </td>
    </tr>
  </table>
  ${t.explanation?`
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr><td style="padding:12px 16px;background:${e.bg};border-left:3px solid ${e.accent};border-radius:0 8px 8px 0">
      <p style="font-family:${e.fontBody};font-size:13px;color:${e.muted};margin:0;line-height:1.6"><strong>Why this matters:</strong> ${A(t.explanation)}</p>
    </td></tr>
  </table>`:""}
</td></tr>`}function TC(t,e){return`
<tr><td style="padding:12px 32px">
  <p style="font-family:${t.fontMono};font-size:10px;color:${t.muted};text-transform:uppercase;letter-spacing:0.12em;margin:0">[${A(e)}  view in browser for full rendering]</p>
</td></tr>`}function jC(t,e){switch(t.type){case"header":return lC(t,e);case"ticker":return aC(t,e);case"section-divider":return cC(t,e);case"article-grid":return uC(t,e);case"spotlight":return fC(t,e);case"ethics-split":return mC(t,e);case"text":return pC(t,e);case"quick-hits":return hC(t,e);case"humor":return xC(t,e);case"term-of-month":return vC(t,e);case"footer":return gC(t,e);case"spacer":return yC(t);case"image":{const n=t.dataUrl||t.url;return n?`<tr><td style="padding:12px 32px;text-align:${t.alignment||"center"}"><img src="${A(n)}" alt="${A(t.alt||"")}" style="max-width:100%;border-radius:${t.borderRadius||8}px"></td></tr>`:""}case"sbar-prompt":case"clinical-prompt-templates":return TC(e,t.type.replace(/-/g," "));case"prompt-masterclass":return MC(t,e);case"prompt-template":return bC(t,e);case"safety-reminders":return SC(t,e);case"ai-case-file":return kC(t,e);case"ai-safety":return wC(t,e);case"institutional-spotlight":return CC(t,e);case"rss-sidebar":return EC(t,e);case"html-embed":return`<tr><td style="padding:12px 32px">${t.html||""}</td></tr>`;default:return""}}function DC(t){var s;const{theme:e,blocks:n,blockOrder:r}=t,i=sC(e),o=r.map(l=>n[l]?jC(n[l],i):"").join(`
`);return`<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="x-apple-disable-message-reformatting">
  <title>${A(((s=t.meta)==null?void 0:s.title)||"Newsletter")}</title>
  <!--[if mso]>
  <noscript><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch></o:OfficeDocumentSettings></xml></noscript>
  <![endif]-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; padding: 0; background: ${i.bg}; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }
    table { border-spacing: 0; mso-table-lspace: 0; mso-table-rspace: 0; }
    img { border: 0; outline: none; text-decoration: none; }
    a { color: ${i.accent}; }
    @media only screen and (max-width: 620px) {
      .nap-email-shell { width: 100% !important; }
      .nap-email-col { display: block !important; width: 100% !important; }
    }
  </style>
</head>
<body style="margin:0;padding:0;background:${i.bg}">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background:${i.bg};padding:20px 0">
    <tr><td align="center">
      <!-- Email shell: max 600px -->
      <table class="nap-email-shell" width="600" cellpadding="0" cellspacing="0" border="0"
        style="width:600px;max-width:600px;background:${i.surface};border-radius:12px;overflow:hidden;box-shadow:0 4px 24px rgba(0,0,0,0.08)">
        ${o}
      </table>
    </td></tr>
  </table>
</body>
</html>`}function AC(t){var s;const e=DC(t),n=new Blob([e],{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r;const o=(((s=t.meta)==null?void 0:s.issueNumber)||"draft").replace(/\s+/g,"");i.download=`newsletter_issue${o}_email.html`,i.click(),URL.revokeObjectURL(r)}function IC(t="A4"){return`
@media print {
  /*  Page setup  */
  @page {
    ${t==="Letter"?"size: letter portrait; margin: 20mm 18mm 20mm 18mm;":"size: A4 portrait; margin: 18mm 16mm 18mm 16mm;"}
  }

  html, body {
    background: #fff !important;
    color: #000 !important;
    padding: 0 !important;
    margin: 0 !important;
    font-size: 11pt !important;
  }

  /*  Shell: remove card chrome  */
  .nap-export-wrap { display: block !important; }
  .nap-shell {
    max-width: 100% !important;
    border: none !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    overflow: visible !important;
  }

  /*  Collapse all multi-column grids  */
  .nap-2col,
  .nap-3col,
  .nap-5col,
  [style*="grid-template-columns"] {
    display: block !important;
  }
  .nap-2col > *,
  .nap-3col > *,
  .nap-5col > * {
    margin-bottom: 14pt !important;
    break-inside: avoid;
  }

  /*  Hide interactive / animated elements  */
  .nap-ticker,
  .nap-rss-config,
  .nap-copy-btn,
  .nap-expand-btn,
  details > summary,
  [data-editor-ui],
  script { display: none !important; }

  details { display: block !important; }
  details > *:not(summary) { display: block !important; }

  /*  Strip gradient backgrounds, keep text readable  */
  .nap-white-section {
    background: #1A2B4A !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    color-adjust: exact;
  }

  /* Force colour printing for all coloured sections */
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /*  Page breaks  */
  .nap-white-section,
  [style*="padding:28px 40px"],
  [style*="padding:24px 40px"] {
    break-inside: avoid;
    page-break-inside: avoid;
  }

  /*  Images: never overflow page  */
  img {
    max-width: 100% !important;
    max-height: 220pt !important;
    object-fit: contain !important;
  }

  /*  SUPPRESS URL display for clean PDF output  */
  a[href]::after { content: none !important; }

  /*  Typography adjustments for paper  */
  h1 { font-size: 28pt !important; }
  h2 { font-size: 20pt !important; }
  h3 { font-size: 14pt !important; }
  p, li { line-height: 1.55 !important; }
}
`}function Kd(t,e="A4"){var s,l;const n=$1(t,{extraCss:IC(e)}),r=document.createElement("iframe");r.style.cssText="position:fixed;top:-9999px;left:-9999px;width:1px;height:1px;border:0;opacity:0",document.body.appendChild(r);const i=r.contentDocument||((s=r.contentWindow)==null?void 0:s.document);if(!i){const a=window.open("","_blank");a&&(a.document.write(n),a.document.close(),a.focus(),setTimeout(()=>a.print(),800));return}i.open(),i.write(n),i.close();const o=()=>{var a,c;(a=r.contentWindow)==null||a.focus(),(c=r.contentWindow)==null||c.print(),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},2e3)};((l=r.contentDocument)==null?void 0:l.readyState)==="complete"?setTimeout(o,600):r.onload=()=>setTimeout(o,600)}function O1(t){var n;return`newsletter_issue${(((n=t.meta)==null?void 0:n.issueNumber)||"draft").replace(/\s+/g,"")}.json`}function N1(t){const e=O1(t),n=JSON.stringify(t,null,2),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,o.click(),URL.revokeObjectURL(i)}function RC(t,e){const n=zC(t,e);return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Newsletter Viewer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800;1,9..40,300;1,9..40,400&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; background: #F0F4FA; font-family: "DM Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }

    .nap-shell { height: 100%; display: flex; flex-direction: column; }

    .nap-topbar {
      position: sticky; top: 0; z-index: 10;
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 14px; gap: 12px;
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }

    .nap-title { font-family: "DM Mono", ui-monospace, SFMono-Regular, Menlo, monospace; font-size: 12px; letter-spacing: 0.08em; color: #234; opacity: 0.8; text-transform: uppercase; }

    .nap-controls { display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end; }
    .nap-btn {
      border: 1px solid rgba(0,0,0,0.10);
      background: #fff;
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 13px;
      cursor: pointer;
      color: #0f2b46;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }
    .nap-btn[aria-pressed="true"] { border-color: rgba(0,156,222,0.55); box-shadow: 0 8px 24px rgba(0,156,222,0.18); }

    .nap-stage {
      flex: 1;
      display: grid;
      place-items: start center;
      padding: 18px 12px 28px;
      overflow: auto;
    }

    .nap-frame-wrap {
      background: transparent;
      border-radius: 18px;
      padding: 0;
    }

    iframe#nap-frame {
      width: 1100px; /* default desktop */
      height: calc(100vh - 88px);
      border: 1px solid rgba(0,0,0,0.10);
      border-radius: 18px;
      background: #ffffff;
      box-shadow: 0 14px 50px rgba(0,0,0,0.12);
    }

    @media (max-width: 1240px) {
      iframe#nap-frame { width: min(1100px, calc(100vw - 24px)); }
    }
  </style>
</head>
<body>
  <div class="nap-shell">
    <div class="nap-topbar">
      <div class="nap-title">Export Viewer</div>
      <div class="nap-controls">
        <button class="nap-btn" id="nap-desktop" aria-pressed="true">Desktop</button>
        <button class="nap-btn" id="nap-tablet" aria-pressed="false">Tablet</button>
        <button class="nap-btn" id="nap-phone" aria-pressed="false">Phone</button>
        <button class="nap-btn" id="nap-print">Print</button>
      </div>
    </div>

    <div class="nap-stage">
      <div class="nap-frame-wrap">
        <iframe id="nap-frame" title="Newsletter preview" sandbox="allow-same-origin allow-scripts allow-forms allow-popups" referrerpolicy="no-referrer"></iframe>
      </div>
    </div>
  </div>

  <script>
    const INNER_HTML = ${JSON.stringify(n).replace(/<\/script>/gi,"<\\/script>")};
    const frame = document.getElementById('nap-frame');
    frame.srcdoc = INNER_HTML;

    const setPressed = (id) => {
      ['nap-desktop','nap-tablet','nap-phone'].forEach(x => {
        const b = document.getElementById(x);
        b.setAttribute('aria-pressed', x === id ? 'true' : 'false');
      });
    };

    const setMode = (mode) => {
      if (mode === 'desktop') { frame.style.width = '1100px'; setPressed('nap-desktop'); }
      if (mode === 'tablet')  { frame.style.width = '820px';  setPressed('nap-tablet'); }
      if (mode === 'phone')   { frame.style.width = '420px';  setPressed('nap-phone'); }
    };

    document.getElementById('nap-desktop').addEventListener('click', () => setMode('desktop'));
    document.getElementById('nap-tablet').addEventListener('click', () => setMode('tablet'));
    document.getElementById('nap-phone').addEventListener('click', () => setMode('phone'));

    document.getElementById('nap-print').addEventListener('click', () => {
      try {
        frame.contentWindow?.focus();
        frame.contentWindow?.print();
      } catch (e) {
        // Fallback: print the parent page
        window.print();
      }
    });

    // Default
    setMode('desktop');
  <\/script>
</body>
</html>`}function zC(t,e){const n=t?t.replace(/<\/script>/gi,"<\\/script>"):null,r=n?`<script>window.__NEWSLETTER__ = ${n};<\/script>`:"";return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="nap-issue-file" content="${e}">
  <title>Newsletter Viewer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800;1,9..40,300;1,9..40,400&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
  <style>
    /*  Base reset  */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body { font-family: "DM Sans", system-ui, sans-serif; background: #F0F4FA; -webkit-font-smoothing: antialiased; }

    /*  Loading state  */
    #nap-loading {
      position: fixed; inset: 0;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      background: #F0F4FA; z-index: 1000; gap: 16px;
    }
    #nap-loading .spinner {
      width: 40px; height: 40px; border-radius: 50%;
      border: 3px solid #C8D9EE; border-top-color: #009CDE;
      animation: spin 0.8s linear infinite;
    }
    #nap-loading p { font-family: "DM Mono", monospace; font-size: 13px; color: #5A789A; letter-spacing: 0.08em; }

    /*  Error state  */
    #nap-error {
      display: none; position: fixed; inset: 0;
      align-items: center; justify-content: center;
      background: #F0F4FA; z-index: 1000; padding: 24px;
    }
    #nap-error .card {
      background: #fff; border-radius: 16px; padding: 40px;
      max-width: 520px; width: 100%; text-align: center;
      box-shadow: 0 8px 40px rgba(0,0,0,0.10);
    }
    #nap-error .icon { font-size: 48px; margin-bottom: 16px; }
    #nap-error h2 { font-family: "DM Serif Display", Georgia, serif; font-size: 26px; font-weight: 400; color: #1A2B4A; margin-bottom: 10px; }
    #nap-error p { font-size: 14px; color: #5A789A; line-height: 1.6; margin-bottom: 20px; }
    #nap-error code { font-family: "DM Mono", monospace; font-size: 12px; background: #F0F4FA; padding: 2px 6px; border-radius: 4px; color: #003087; }
    #nap-error .hint { font-size: 12px; color: #5A789A; margin-top: 16px; padding: 12px 16px; background: #F0F4FA; border-radius: 8px; text-align: left; line-height: 1.7; }

    /*  Drop zone overlay  */
    #nap-drop-overlay {
      display: none; position: fixed; inset: 0; z-index: 900;
      background: rgba(0,156,222,0.15); border: 4px dashed #009CDE;
      align-items: center; justify-content: center;
      font-family: "DM Mono", monospace; font-size: 18px; color: #003087;
      letter-spacing: 0.1em;
    }

    /*  Toolbar  */
    #nap-toolbar {
      display: none; /* hidden until content loads */
      position: fixed; bottom: 20px; right: 20px; z-index: 800;
      display: flex; gap: 8px;
    }
    #nap-toolbar button {
      display: flex; align-items: center; gap: 7px;
      padding: 9px 16px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.3);
      background: #003087; color: #fff;
      font-family: "DM Sans", system-ui, sans-serif;
      font-size: 13px; font-weight: 500; cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      transition: background 0.15s;
    }
    #nap-toolbar button:hover { background: #0057A8; }
    #nap-toolbar button.secondary {
      background: rgba(255,255,255,0.95); color: #003087;
      border-color: #C8D9EE;
    }
    #nap-toolbar button.secondary:hover { background: #fff; }

    /*  Content  */
    #nap-content { display: none; min-height: 100vh; }

    /*  Animations  */
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes nap_ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }
    @keyframes nap_pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

    /*  Responsive  */
    @media (max-width: 680px) {
      .nap-2col, .nap-3col, .nap-5col { display: block !important; }
      .nap-2col > *, .nap-3col > *, .nap-5col > * { margin-bottom: 14px; }
      #nap-toolbar { bottom: 12px; right: 12px; }
      #nap-toolbar button { font-size: 12px; padding: 8px 12px; }
    }
    @media print {
      #nap-toolbar, #nap-loading, #nap-error, #nap-drop-overlay { display: none !important; }
      body { background: #fff !important; }
      .nap-shell { border: none !important; box-shadow: none !important; border-radius: 0 !important; }
      .nap-ticker { display: none !important; }
      @page { size: A4 portrait; margin: 18mm 16mm; }
    }
  </style>
  ${r}
</head>
<body>

  <!-- Loading indicator -->
  <div id="nap-loading">
    <div class="spinner"></div>
    <p>Loading newsletter</p>
  </div>

  <!-- Error state -->
  <div id="nap-error">
    <div class="card">
      <div class="icon"></div>
      <h2>Newsletter not found</h2>
      <p id="nap-error-msg">Could not load the newsletter JSON file.</p>
      <div class="hint" id="nap-error-hint">
        <strong>To use this viewer:</strong><br>
        1. Place <code id="nap-error-filename">newsletter_issue001.json</code> in the same folder as this HTML file.<br>
        2. Open using a local server: <code>npx serve .</code> or VS Code Live Server.<br>
        3. Or drag &amp; drop the JSON file onto this page.
      </div>
      <p style="margin-top:16px;font-size:12px;color:#5A789A">
        Or <label style="color:#009CDE;cursor:pointer;text-decoration:underline">
          browse for a JSON file
          <input type="file" id="nap-file-input" accept=".json" style="display:none">
        </label>
      </p>
    </div>
  </div>

  <!-- Drop overlay -->
  <div id="nap-drop-overlay"> Drop JSON file here</div>

  <!-- Toolbar (shown after load) -->
  <div id="nap-toolbar">
    <button class="secondary" id="btn-load-file" title="Load a different issue JSON"> Load Issue</button>
    <button id="btn-print" title="Print / Save as PDF"> Print</button>
    <input type="file" id="nap-toolbar-file" accept=".json" style="display:none">
  </div>

  <!-- Rendered content -->
  <div id="nap-content"></div>

<script>
(function() {
  'use strict';

  //  Helpers 
  function esc(s) {
    return (s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  function normalizeTerms(terms) {
    if (!terms) return [];
    if (Array.isArray(terms)) return terms.filter(Boolean).map(String);
    if (typeof terms === 'string') {
      var parts = []; var chunks = terms.split(','); for(var ci=0;ci<chunks.length;ci++){var p=chunks[ci].trim();if(p)parts.push(p);}
      return parts.length ? parts : [terms.trim()];
    }
    return [String(terms)];
  }

  //  CSS injection from theme 
  function applyThemeCss(theme) {
    var el = document.getElementById('nap-theme-css');
    if (!el) { el = document.createElement('style'); el.id = 'nap-theme-css'; document.head.appendChild(el); }
    el.textContent = [
      ':root {',
      '  --c-primary: ' + theme.primary + ';',
      '  --c-secondary: ' + theme.secondary + ';',
      '  --c-accent: ' + theme.accent + ';',
      '  --c-bg: ' + theme.background + ';',
      '  --c-surface: ' + theme.surface + ';',
      '  --c-border: ' + theme.border + ';',
      '  --c-text: ' + theme.text + ';',
      '  --c-muted: ' + theme.muted + ';',
      '  --f-display: ' + theme.fontDisplay + ';',
      '  --f-body: ' + theme.fontBody + ';',
      '  --f-mono: ' + theme.fontMono + ';',
      '}',
      '*, *::before, *::after { box-sizing: border-box; }',
      'html, body { margin: 0; height: auto !important; overflow: auto !important; }',
      'body { font-family: var(--f-body); color: var(--c-text); background: var(--c-bg); padding: 22px 0; -webkit-font-smoothing: antialiased; }',
      'a { color: var(--c-accent); text-decoration: none; }',
      'a:hover { text-decoration: underline; }',
      '.nap-ticker a { color: inherit !important; text-decoration: none !important; }',
      '.nap-ticker span { color: inherit; }',
      '.nap-white-section a { color: inherit; }',
      'img { max-width: 100%; display: block; }',
      '.nap-export-wrap { width: 100%; display: flex; justify-content: center; }',
      '.nap-shell { max-width: 900px; width: 100%; margin: 0 auto; background: var(--c-surface); border: 1px solid var(--c-border); border-radius: 18px; overflow: hidden; box-shadow: 0 14px 40px rgba(0,0,0,0.10); }',
      '[contenteditable] { outline: none !important; }',
      '.nap-ticker-track { display: flex; white-space: nowrap; will-change: transform; }',
      '.nap-tpl-prompt { display: none; padding: 10px 14px; }',
      '.nap-tpl-prompt.open { display: block; }',
      '.nap-copy-btn { cursor: pointer; color: #fff !important; }',
      '.nap-expand-btn { cursor: pointer; }',
      '.nap-rss-scroll { max-height: none !important; overflow: visible !important; }',
      '.nap-sbar-letter { font-size:56px !important; font-weight:400 !important; line-height:1 !important; margin-bottom:6px !important; font-style:italic !important; text-transform:uppercase !important; }',
      '.ai-related-pill { display: inline-block !important; background: #F3F6FF !important; border: 1px solid var(--c-border) !important; color: var(--c-text) !important; padding: 4px 10px !important; border-radius: 999px !important; font-family: var(--f-mono) !important; font-size: 11px !important; line-height: 16px !important; margin: 0 6px 0 0 !important; }',
      '@keyframes nap_ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }',
      '@keyframes nap_pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }',
      '@media (max-width: 680px) { .nap-2col, .nap-3col, .nap-5col { display: block !important; } .nap-2col > *, .nap-3col > *, .nap-5col > * { margin-bottom: 14px; } }'
    ].join(' ');
  }

  //  Block renderers 
  // These are the same HTML strings as export.ts but as vanilla JS functions.

  function renderBlock(block, t) {
    var b = block;
    switch (block.type) {
      case 'header':                    return renderHeader(b, t);
      case 'ticker':                    return renderTicker(b, t);
      case 'section-divider':           return renderSectionDivider(b, t);
      case 'article-grid':              return renderArticleGrid(b, t);
      case 'spotlight':                 return renderSpotlight(b, t);
      case 'ethics-split':              return renderEthicsSplit(b, t);
      case 'image':                     return renderImage(b, t);
      case 'text':                      return renderText(b, t);
      case 'html-embed':                return renderHtmlEmbed(b, t);
      case 'prompt-masterclass':        return renderPromptMasterclass(b, t);
      case 'sbar-prompt':               return renderSbarPrompt(b, t);
      case 'prompt-template':           return renderPromptTemplate(b, t);
      case 'safety-reminders':          return renderSafetyReminders(b, t);
      case 'clinical-prompt-templates': return renderClinicalPromptTemplates(b, t);
      case 'term-of-month':             return renderTermOfMonth(b, t);
      case 'ai-case-file':              return renderAiCaseFile(b, t);
      case 'quick-hits':                return renderQuickHits(b, t);
      case 'humor':                     return renderHumor(b, t);
      case 'spacer':                    return renderSpacer(b, t);
      case 'ai-safety':                 return renderAiSafety(b, t);
      case 'institutional-spotlight':   return renderInstitutionalSpotlight(b, t);
      case 'rss-sidebar':               return renderRssSidebar(b, t);
      case 'footer':                    return renderFooter(b, t);
      default: return '';
    }
  }

  function renderHeader(b, t) {
    var bg = b.backgroundStyle === 'solid' ? t.primary : ('linear-gradient(135deg,' + t.primary + ' 0%,' + t.secondary + ' 60%,' + t.accent + '44 100%)');
    return '<div class="nap-white-section" style="background:' + bg + ';padding:48px 40px;text-align:center;position:relative;overflow:hidden;color:#fff">'
      + '<svg style="position:absolute;bottom:0;left:0;right:0;opacity:0.08" viewBox="0 0 800 60" fill="none" preserveAspectRatio="none" height="60"><path d="M0 40 Q200 0 400 30 Q600 60 800 20 L800 60 L0 60Z" fill="white"/></svg>'
      + ((b.logoDataUrl||b.logoUrl) ? '<div style="margin-bottom:20px"><img src="' + esc(b.logoDataUrl||b.logoUrl) + '" alt="Logo" style="max-height:60px;max-width:240px;border-radius:8px;display:inline-block;margin:0 auto"></div>' : '')
      + '<div style="font-family:' + t.fontMono + ';font-size:11px;letter-spacing:0.22em;text-transform:uppercase;color:rgba(255,255,255,0.8);margin-bottom:12px">' + esc(b.issueNumber) + '  ' + esc(b.issueDate) + '</div>'
      + '<h1 style="font-family:' + t.fontDisplay + ';font-size:46px;font-weight:400;color:#fff;margin:0 0 10px;letter-spacing:-0.02em;line-height:1.1">' + esc(b.title) + '</h1>'
      + '<p style="font-family:' + t.fontDisplay + ';font-size:20px;font-style:italic;color:rgba(255,255,255,0.92);margin:0 0 18px;line-height:1.3">' + esc(b.subtitle) + '</p>'
      + '<div style="height:1px;background:rgba(255,255,255,0.3);max-width:280px;margin:0 auto 18px"></div>'
      + '<p style="font-family:' + t.fontBody + ';font-size:13px;color:rgba(255,255,255,0.85);margin:0;letter-spacing:0.02em">' + esc(b.tagline) + '</p>'
      + '</div>';
  }

  function renderTicker(b, t) {
    var dur = ({slow:60,medium:36,fast:20})[b.speed] || 36;
    var textColor = b.textColor || '#ffffff';
    var bg = b.backgroundColor || t.primary;
    var accentDot = '<span style="width:5px;height:5px;border-radius:50%;background:' + t.accent + ';display:inline-block;flex-shrink:0"></span>';
    var itemStyle = 'font-family:' + t.fontMono + ';font-size:12px;color:' + textColor + ';padding:0 32px;letter-spacing:0.04em;display:inline-flex;align-items:center;gap:10px;text-decoration:none';
    var seedHtml = '';
    if (b.sourceMode === 'rss' || b.useLinks) {
      seedHtml = (b.links || []).filter(function(x){return x&&x.text;}).map(function(x){
        return '<a class="nap-ticker-item" href="' + esc(x.url||'#') + '" target="_blank" rel="noopener noreferrer" style="' + itemStyle + '">' + accentDot + esc(x.text) + '<span style="font-size:10px;opacity:0.6;color:' + textColor + '"></span></a>';
      }).join('');
    } else {
      seedHtml = (b.items || []).map(function(item){
        return '<span class="nap-ticker-item" style="' + itemStyle + '">' + accentDot + esc(item) + '</span>';
      }).join('');
    }
    var dataRss = esc(JSON.stringify((b.rssUrls||[]).filter(Boolean)));
    return '<div class="nap-ticker" data-source="' + esc(b.sourceMode||'manual') + '" data-rss="" data-rss-max="' + esc(String(b.rssMaxItems||20)) + '" data-live="0" data-key="' + esc(b.id||'ticker') + '" style="background:' + bg + ';overflow:hidden;height:40px;display:flex;align-items:center;color:' + textColor + '">'
      + '<div class="nap-ticker-track" style="animation:nap_ticker ' + dur + 's linear infinite">' + seedHtml + seedHtml + '</div>'
      + '</div>';
  }

  function renderSectionDivider(b, t) {
    if (b.style === 'bold') {
      return '<div class="nap-white-section" style="background:' + t.primary + ';padding:18px 40px;display:flex;align-items:center;gap:16px;color:#fff">'
        + (b.number > 0 ? '<span style="font-family:' + t.fontMono + ';font-size:32px;font-weight:300;color:rgba(255,255,255,0.25);line-height:1">' + esc(String(b.number).padStart(2,'0')) + '</span>' : '')
        + '<div><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.22em;text-transform:uppercase;color:rgba(255,255,255,0.5);margin-bottom:2px">Section</div>'
        + '<div style="font-family:' + t.fontDisplay + ';font-size:22px;color:#fff;line-height:1.15">' + esc(b.label) + '</div></div></div>';
    }
    return '<div style="padding:32px 40px 16px">'
      + '<div style="display:flex;align-items:center;gap:14px;margin-bottom:' + (b.description ? 10 : 0) + 'px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.22em;text-transform:uppercase;color:' + t.muted + ';white-space:nowrap">'
      + '<span>' + (b.number > 0 ? '0' + b.number + '  ' : ' ') + '</span>' + esc(b.label) + '<span> </span></div>'
      + '<div style="flex:1;height:1px;background:linear-gradient(90deg,' + t.border + ',transparent)"></div>'
      + '</div>'
      + (b.description ? '<p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0;line-height:1.6">' + esc(b.description) + '</p>' : '')
      + '</div>';
  }

  function renderArticleCard(art, t) {
    var evidenceColors = {High:'#00A651',Moderate:'#F47920',Low:'#C0392B','Expert Opinion':'#7B2D8B'};
    var ec = art.evidenceLevel ? evidenceColors[art.evidenceLevel] : null;
    var titleHtml = art.url
      ? '<a href="' + esc(art.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.text + ';text-decoration:none">' + esc(art.title) + '</a>'
      : esc(art.title);
    return '<div style="border:1px solid ' + t.border + ';border-radius:12px;overflow:hidden;background:' + t.surface + ';display:flex;flex-direction:column">'
      + (art.imageUrl ? '<div style="height:160px;overflow:hidden;flex-shrink:0"><img src="' + esc(art.imageUrl) + '" alt="' + esc(art.title) + '" style="width:100%;height:100%;object-fit:cover"></div>' : '')
      + '<div style="padding:16px;flex:1;display:flex;flex-direction:column">'
      + '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;flex-wrap:wrap;gap:6px">'
      + '<span style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:' + t.muted + '">' + esc(art.source||'') + '</span>'
      + (ec ? '<span style="background:' + ec + '22;color:' + ec + ';border:1px solid ' + ec + '44;border-radius:999px;padding:2px 8px;font-family:' + t.fontMono + ';font-size:10px;font-weight:600">' + esc(art.evidenceLevel) + '</span>' : '')
      + '</div>'
      + '<h3 style="font-family:' + t.fontDisplay + ';font-size:20px;color:' + t.text + ';margin:0 0 10px;line-height:1.25;font-weight:400">' + titleHtml + '</h3>'
      + (art.summary ? '<p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.muted + ';margin:0 0 12px;line-height:1.6;flex:1">' + esc(art.summary) + '</p>' : '')
      + (art.clinicalContext ? '<div style="background:' + t.background + ';border-radius:8px;padding:10px 12px;margin-bottom:10px"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:4px">Clinical Context</div><p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.text + ';margin:0;line-height:1.55">' + esc(art.clinicalContext) + '</p></div>' : '')
      + (art.myTake ? '<p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.secondary + ';font-style:italic;margin:0 0 12px;border-left:3px solid ' + t.accent + ';padding-left:10px;line-height:1.5">' + esc(art.myTake) + '</p>' : '')
      + (art.url ? '<a href="' + esc(art.url) + '" target="_blank" rel="noopener noreferrer" style="margin-top:auto;display:inline-flex;align-items:center;gap:5px;font-family:' + t.fontBody + ';font-size:12px;color:' + t.accent + ';font-weight:600;text-decoration:none">Read full paper <span style="font-size:14px"></span></a>' : '')
      + '</div></div>';
  }

  function renderArticleGrid(b, t) {
    var cols = b.columns || 2;
    var cards = (b.articles || []).map(function(art){ return renderArticleCard(art, t); }).join('');
    return '<div style="padding:24px 40px">'
      + (b.sectionTitle ? '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 20px;font-weight:400">' + esc(b.sectionTitle) + '</h2>' : '')
      + '<div class="nap-' + cols + 'col" style="display:grid;grid-template-columns:repeat(' + cols + ',1fr);gap:20px">' + cards + '</div>'
      + '</div>';
  }

  function renderSpotlight(b, t) {
    var art = b.article || {};
    var accent = b.accentColor || t.accent;
    var isTop = b.layout === 'top-image';
    var isLeft = b.layout === 'left-image';
    var hasImage = !!art.imageUrl;
    var titleHtml = art.url ? '<a href="' + esc(art.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.text + ';text-decoration:none">' + esc(art.title) + '</a>' : esc(art.title);
    var readBtn = art.url ? '<a href="' + esc(art.url) + '" target="_blank" rel="noopener noreferrer" style="display:inline-flex;align-items:center;gap:8px;padding:9px 18px;background:' + accent + ';color:#fff;border-radius:8px;font-family:' + t.fontBody + ';font-size:13px;font-weight:600;text-decoration:none">Read the paper </a>' : '';
    var inner = '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:12px"> Spotlight  ' + esc(art.source||'') + '</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:28px;color:' + t.text + ';margin:0 0 12px;font-weight:400;line-height:1.2">' + titleHtml + '</h2>'
      + (art.summary ? '<p style="font-family:' + t.fontBody + ';font-size:15px;color:' + t.muted + ';margin:0 0 16px;line-height:1.65">' + esc(art.summary) + '</p>' : '')
      + (art.clinicalContext ? '<div style="background:' + t.background + ';border-radius:10px;padding:14px 16px;margin-bottom:14px"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:6px">Clinical Context</div><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.text + ';margin:0;line-height:1.6">' + esc(art.clinicalContext) + '</p></div>' : '')
      + (art.myTake ? '<p style="font-family:' + t.fontBody + ';font-size:14px;font-style:italic;color:' + t.secondary + ';margin:0 0 16px;border-left:3px solid ' + accent + ';padding-left:12px;line-height:1.6">' + esc(art.myTake) + '</p>' : '')
      + readBtn;
    if (isTop && hasImage) {
      return '<div style="padding:24px 40px"><div style="border:1px solid ' + t.border + ';border-radius:14px;overflow:hidden;background:' + t.surface + '"><img src="' + esc(art.imageUrl) + '" alt="' + esc(art.title||'') + '" style="width:100%;height:280px;object-fit:cover"><div style="padding:24px">' + inner + '</div></div></div>';
    }
    var imgHtml = hasImage ? '<div style="width:40%;flex-shrink:0"><img src="' + esc(art.imageUrl) + '" alt="' + esc(art.title||'') + '" style="width:100%;height:100%;object-fit:cover;display:block"></div>' : '';
    var flexDir = hasImage ? (isLeft ? 'row' : 'row-reverse') : 'column';
    var bl = (hasImage && isLeft) ? 'border-left:4px solid ' + accent + ';' : '';
    return '<div style="padding:24px 40px"><div style="border:1px solid ' + t.border + ';border-radius:14px;overflow:hidden;background:' + t.surface + ';display:flex;flex-direction:' + flexDir + '">' + imgHtml + '<div style="flex:1;padding:28px;' + bl + '">' + inner + '</div></div></div>';
  }

  function renderEthicsSplit(b, t) {
    var sourceLink = b.source ? (b.url ? '<a href="' + esc(b.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.accent + '">' + esc(b.source) + '</a>' : esc(b.source)) : '';
    return '<div style="padding:28px 40px">'
      + '<div style="margin-bottom:20px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:6px"> AI Ethics &amp; Governance</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 6px;font-weight:400">' + esc(b.heading||'') + '</h2>'
      + '<p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0">' + esc(b.subheading||'') + '</p>'
      + (b.source !== undefined ? '<div style="font-family:' + t.fontMono + ';font-size:11px;color:' + t.muted + ';margin-top:6px">Source: ' + sourceLink + '</div>' : '')
      + '</div>'
      + '<div class="nap-2col" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px">'
      + '<div style="border:1px solid ' + t.border + ';border-radius:12px;padding:20px;background:' + t.background + '"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:#C0392B;font-weight:700;margin-bottom:10px">' + esc(b.leftTitle||'') + '</div><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.text + ';margin:0;line-height:1.65">' + esc(b.leftContent||'') + '</p></div>'
      + '<div style="border:1px solid ' + t.accent + '44;border-radius:12px;padding:20px;background:' + t.accent + '0A"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:' + t.accent + ';font-weight:700;margin-bottom:10px">' + esc(b.rightTitle||'') + '</div><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.text + ';margin:0;line-height:1.65">' + esc(b.rightContent||'') + '</p></div>'
      + '</div>'
      + '<div style="padding:14px 18px;border:1px solid ' + t.border + ';border-radius:12px;border-left:4px solid ' + t.accent + '"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:6px">Clinical Perspective</div><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.text + ';margin:0;line-height:1.65">' + esc(b.clinicalPerspective||'') + '</p></div>'
      + '</div>';
  }

  function renderImage(b, t) {
    var src = b.dataUrl || b.url;
    if (!src) return '';
    var widthMap = {full:'100%',wide:'80%',medium:'60%',small:'40%'};
    var maxW = widthMap[b.width] || '100%';
    var imgTag = '<img src="' + esc(src) + '" alt="' + esc(b.alt||'') + '" style="max-width:' + maxW + ';border-radius:' + (b.borderRadius||12) + 'px;display:inline-block">';
    return '<div style="padding:16px 40px;text-align:' + esc(b.alignment||'center') + '">'
      + (b.linkUrl ? '<a href="' + esc(b.linkUrl) + '" target="_blank" rel="noopener noreferrer" style="display:inline-block;max-width:' + maxW + '">' + imgTag + '</a>' : imgTag)
      + (b.caption ? '<p style="font-family:' + t.fontBody + ';font-size:12px;color:' + t.muted + ';margin:8px 0 0;text-align:center">' + esc(b.caption) + '</p>' : '')
      + '</div>';
  }

  function renderText(b, t) {
    var maxWidthMap = {full:'100%',reading:'720px',narrow:'560px'};
    return '<div style="padding:16px 40px"><div style="font-family:' + t.fontBody + ';color:' + t.text + ';line-height:1.7;max-width:' + (maxWidthMap[b.maxWidth]||'100%') + ';margin:0 auto;text-align:' + esc(b.alignment||'left') + ';font-size:15px">' + (b.html||'') + '</div></div>';
  }

  function renderHtmlEmbed(b, t) {
    return '<div style="padding:16px 40px">' + (b.label ? '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:8px"> ' + esc(b.label) + '</div>' : '') + '<div>' + (b.html||'') + '</div></div>';
  }

  function renderPromptMasterclass(b, t) {
    return '<div style="padding:28px 40px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:8px"> Prompt Like a Rockstar</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 6px;font-weight:400">' + esc(b.heading||'') + '</h2>'
      + '<div style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin-bottom:20px">' + esc(b.step||'') + '  Framework: <strong>' + esc(b.framework||'') + '</strong></div>'
      + '<div class="nap-2col" style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:14px">'
      + '<div style="border:1px solid #f5c6c0;border-radius:12px;padding:16px;background:#FEF0EE"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:#C0392B;margin-bottom:8px"> Bad Prompt</div><p style="font-family:' + t.fontBody + ';font-size:14px;font-style:italic;color:#7A1E12;margin:0;line-height:1.55">' + esc(b.badPrompt||'') + '</p></div>'
      + '<div style="border:1px solid ' + t.accent + '44;border-radius:12px;padding:16px;background:' + t.accent + '0D"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:8px"> Good Prompt</div><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.text + ';margin:0;line-height:1.55">' + esc(b.goodPrompt||'') + '</p></div>'
      + '</div>'
      + '<div style="padding:12px 16px;background:' + t.background + ';border-radius:10px;border-left:3px solid ' + t.accent + '"><p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.muted + ';margin:0;line-height:1.6"><strong>Why this matters:</strong> ' + esc(b.explanation||'') + '</p></div>'
      + '</div>';
  }

  function renderSbarPrompt(b, t) {
    var colors = [t.primary, t.secondary, t.accent, '#7B2D8B', '#00A651'];
    var stepsHtml = (b.steps||[]).map(function(step, i) {
      var c = colors[i] || t.primary;
      return '<div style="border:1px solid ' + t.border + ';border-radius:10px;padding:14px;background:' + t.surface + '">'
        + '<div class="nap-sbar-letter" style="font-family:' + t.fontDisplay + ';color:' + c + ';">' + esc((step.letter||'').toUpperCase()) + '</div>'
        + '<div style="font-family:' + t.fontMono + ';font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:8px;padding-bottom:8px;border-bottom:2px solid ' + c + '">' + esc(step.name||'') + '</div>'
        + '<p style="font-family:' + t.fontBody + ';font-size:12px;color:' + t.text + ';margin:0 0 10px;line-height:1.5">' + esc(step.description||'') + '</p>'
        + '<div style="background:' + t.background + ';border-radius:6px;padding:8px 10px;border-left:3px solid ' + c + '"><p style="font-family:' + t.fontBody + ';font-size:11px;color:' + t.muted + ';margin:0;font-style:italic;line-height:1.45">' + esc(step.example||'') + '</p></div>'
        + '</div>';
    }).join('');
    return '<div style="padding:28px 40px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:8px"> Clinical AI Prompting</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 20px;font-weight:400">' + esc(b.heading||'') + '</h2>'
      + '<div class="nap-5col" style="display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:20px">' + stepsHtml + '</div>'
      + '</div>';
  }

  function renderPromptTemplate(b, t) {
    var prompt = String(b.prompt||'');
    var heading = String(b.heading||'Template Prompt');
    return '<div style="padding:18px 40px">'
      + '<details style="border:1px solid ' + t.border + ';border-radius:12px;overflow:hidden;background:' + t.surface + '">'
      + '<summary style="list-style:none;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 14px;user-select:none">'
      + '<div style="display:flex;flex-direction:column;gap:2px"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + '"> Template Prompt</div><div style="font-family:' + t.fontDisplay + ';font-size:18px;color:' + t.text + ';font-weight:500">' + esc(heading) + '</div></div>'
      + '<button class="nap-copy-btn" data-copy="' + esc(prompt) + '" style="padding:7px 12px;background:' + t.primary + ';border:none;border-radius:8px;font-family:' + t.fontBody + ';font-size:12px;color:#fff;cursor:pointer;white-space:nowrap"> Copy</button>'
      + '</summary>'
      + '<div style="padding:12px 14px;background:' + t.background + ';border-top:1px solid ' + t.border + '"><pre style="font-family:' + t.fontMono + ';font-size:12px;color:' + t.text + ';margin:0;white-space:pre-wrap;line-height:1.6">' + esc(prompt) + '</pre></div>'
      + '</details></div>';
  }

  function renderSafetyReminders(b, t) {
    var items = (b.items||[]).filter(Boolean);
    if (!items.length) return '';
    var gridCols = items.length <= 2 ? '1fr' : '1fr 1fr';
    return '<div style="padding:10px 40px 18px">'
      + '<div style="background:#FFF7E6;border:1px solid #F4D38B;border-radius:12px;padding:14px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:#8A5A00;margin-bottom:10px"> ' + esc(b.heading||'Safety Reminders') + '</div>'
      + '<div style="display:grid;grid-template-columns:' + gridCols + ';gap:10px">'
      + items.map(function(txt){ return '<div style="background:rgba(255,255,255,0.65);border:1px solid ' + t.border + ';border-radius:10px;padding:12px;display:flex;gap:10px"><div style="font-family:' + t.fontMono + ';font-size:11px;color:#8A5A00;margin-top:1px"></div><div style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.text + ';line-height:1.6">' + esc(txt) + '</div></div>'; }).join('')
      + '</div></div></div>';
  }

  function renderClinicalPromptTemplates(b, t) {
    var categoryColors = {'Differential Diagnosis':t.primary,'Discharge Summary':t.secondary,'Literature Review':t.accent,'Patient Education':'#00A651','EEG / EMG Report':'#7B2D8B','Research':'#F47920'};
    var templatesHtml = (b.templates||[]).map(function(tpl) {
      var catColor = categoryColors[tpl.category] || t.primary;
      var tplId = 'tpl-' + esc(String(tpl.id||Math.random().toString(36).slice(2)));
      return '<div style="border:1px solid ' + t.border + ';border-radius:10px;overflow:hidden;background:' + t.surface + '">'
        + '<div style="padding:12px 14px"><div style="display:flex;align-items:flex-start;justify-content:space-between;gap:8px">'
        + '<div style="flex:1"><div style="display:flex;align-items:center;gap:6px;margin-bottom:4px"><span style="font-family:' + t.fontMono + ';font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:#fff;padding:2px 7px;background:' + catColor + ';border-radius:999px">' + esc(tpl.category) + '</span></div><div style="font-family:' + t.fontBody + ';font-size:13px;font-weight:600;color:' + t.text + ';margin-bottom:3px">' + esc(tpl.title) + '</div><div style="font-family:' + t.fontBody + ';font-size:11px;color:' + t.muted + '">' + esc(tpl.useCase) + '</div></div>'
        + '<div style="display:flex;gap:4px;flex-shrink:0"><button class="nap-expand-btn" data-target="' + tplId + '" style="padding:5px 8px;background:none;border:1px solid ' + t.border + ';border-radius:6px;font-family:' + t.fontBody + ';font-size:11px;color:' + t.muted + '">Preview</button><button class="nap-copy-btn" data-copy="' + esc(tpl.prompt) + '" style="padding:5px 10px;background:' + t.primary + ';border:none;border-radius:6px;font-family:' + t.fontBody + ';font-size:11px;color:#fff"> Copy</button></div>'
        + '</div></div>'
        + '<div id="' + tplId + '" class="nap-tpl-prompt" style="background:' + t.background + '"><pre style="font-family:' + t.fontMono + ';font-size:11px;color:' + t.text + ';margin:0;white-space:pre-wrap;line-height:1.6">' + esc(tpl.prompt) + '</pre></div>'
        + '</div>';
    }).join('');
    return '<div style="padding:28px 40px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:8px"> Ready-to-Use Prompts</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 6px;font-weight:400">' + esc(b.heading||'') + '</h2>'
      + '<p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0 0 20px">' + esc(b.description||'') + '</p>'
      + '<div class="nap-2col" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px">' + templatesHtml + '</div>'
      + '</div>';
  }

  function renderTermOfMonth(b, t) {
    var sections = [{title:'Definition',content:b.definition},{title:'Relevance to Medicine',content:b.relevance},{title:'Clinical Application',content:b.clinicalApplication}];
    var terms = normalizeTerms(b.relatedTerms);
    return '<div style="padding:28px 40px">'
      + '<div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:8px"> AI Term of the Month</div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:34px;color:' + t.text + ';margin:0 0 20px;font-weight:400">' + esc(b.term||'') + '</h2>'
      + '<div class="nap-3col" style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">'
      + sections.map(function(s){ return '<div style="border:1px solid ' + t.border + ';border-radius:10px;padding:16px;background:' + t.surface + '"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:' + t.muted + ';margin-bottom:8px">' + esc(s.title) + '</div><p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.text + ';margin:0;line-height:1.6">' + esc(s.content||'') + '</p></div>'; }).join('')
      + '</div>'
      + (terms.length ? '<div style="margin-top:14px;display:flex;flex-wrap:wrap;gap:8px;align-items:center"><strong style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.text + ';font-weight:700">Related:</strong>' + terms.map(function(term){ return '<span class="ai-related-pill">' + esc(term) + '</span>'; }).join('') + '</div>' : '')
      + '</div>';
  }

  function renderAiCaseFile(b, t) {
    var imgSrc = b.imageDataUrl || b.imageUrl;
    return '<div style="padding:28px 40px"><div style="display:flex;gap:24px;align-items:flex-start">'
      + '<div style="display:flex;flex-direction:column;align-items:center;gap:10px;flex-shrink:0"><div style="background:' + t.primary + ';border-radius:10px;padding:14px 18px;text-align:center;color:#fff !important"><div style="font-family:' + t.fontDisplay + ';font-size:28px;color:#fff !important;line-height:1">' + esc(b.year||'') + '</div><div style="font-family:' + t.fontMono + ';font-size:10px;color:rgba(255,255,255,0.92) !important;letter-spacing:0.12em;text-transform:uppercase;margin-top:4px">AI Case File</div></div>'
      + (imgSrc ? '<div style="width:100px;height:80px;border-radius:8px;overflow:hidden;border:1px solid ' + t.border + '"><img src="' + esc(imgSrc) + '" alt="' + esc(b.title||'') + '" style="width:100%;height:100%;object-fit:cover"></div>' : '')
      + '</div>'
      + '<div style="flex:1"><h3 style="font-family:' + t.fontDisplay + ';font-size:22px;color:' + t.text + ';margin:0 0 10px;font-weight:400">' + esc(b.title||'') + '</h3><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0 0 12px;line-height:1.65">' + esc(b.content||'') + '</p>'
      + (b.significance ? '<div style="background:' + t.background + ';border-radius:8px;padding:10px 14px;border-left:3px solid ' + t.accent + ';margin-bottom:12px"><p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.muted + ';margin:0;line-height:1.55"><strong>Significance:</strong> ' + esc(b.significance) + '</p></div>' : '')
      + ((b.sourceUrl||b.sourceLabel) ? '<div style="font-family:' + t.fontMono + ';font-size:11px;color:' + t.muted + '">Source: ' + (b.sourceUrl ? '<a href="' + esc(b.sourceUrl) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.accent + '">' + esc(b.sourceLabel||b.sourceUrl) + '</a>' : esc(b.sourceLabel)) + '</div>' : '')
      + '</div></div></div>';
  }

  function renderQuickHits(b, t) {
    var hits = (b.hits||[]).map(function(hit, i) {
      var titleHtml = hit.url ? '<a href="' + esc(hit.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.text + ';text-decoration:none">' + esc(hit.title||'') + '</a>' : esc(hit.title||'');
      return '<div style="display:flex;gap:14px;align-items:flex-start;padding:12px 14px;border:1px solid ' + t.border + ';border-radius:10px;background:' + t.surface + '">'
        + '<span style="font-family:' + t.fontMono + ';font-size:18px;color:' + t.accent + ';line-height:1;flex-shrink:0;min-width:28px">' + String(i+1).padStart(2,'0') + '</span>'
        + '<div style="flex:1"><div style="font-family:' + t.fontBody + ';font-size:14px;font-weight:600;color:' + t.text + ';margin-bottom:4px;line-height:1.3">' + titleHtml + '</div><div style="font-family:' + t.fontMono + ';font-size:10px;color:' + t.muted + ';letter-spacing:0.1em;text-transform:uppercase;margin-bottom:4px">' + esc(hit.source||'') + '</div>' + (hit.summary ? '<p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.muted + ';margin:0;line-height:1.5">' + esc(hit.summary) + '</p>' : '') + '</div>'
        + (hit.url ? '<a href="' + esc(hit.url) + '" target="_blank" rel="noopener noreferrer" style="flex-shrink:0;font-family:' + t.fontBody + ';font-size:11px;color:' + t.accent + ';font-weight:600;text-decoration:none">Read </a>' : '')
        + '</div>';
    }).join('');
    return '<div style="padding:24px 40px"><h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 16px;font-weight:400"> ' + esc(b.heading||'') + '</h2><div style="display:flex;flex-direction:column;gap:10px">' + hits + '</div></div>';
  }

  function renderHumor(b, t) {
    var imgSrc = b.imageDataUrl || b.imageUrl;
    var imgFit = b.imageFit || 'contain';
    var imgHeight = b.imageHeight;
    var imgStyle = imgHeight ? 'width:100%;height:' + imgHeight + 'px;object-fit:' + imgFit + ';display:block' : 'width:100%;height:auto;display:block';
    return '<div style="padding:28px 40px">'
      + '<div style="background:linear-gradient(135deg,' + t.background + ',' + t.surface + ');border:1px solid ' + t.border + ';border-radius:16px;overflow:hidden">'
      + '<div style="padding:16px 18px;border-bottom:1px solid ' + t.border + ';display:flex;align-items:center;gap:10px"><span style="font-size:18px"></span><div style="font-family:' + t.fontDisplay + ';font-size:20px;color:' + t.text + ';font-weight:400">' + esc(b.heading||'Humor') + '</div></div>'
      + (imgSrc ? '<img src="' + esc(imgSrc) + '" alt="" style="' + imgStyle + '">' : '')
      + '<div style="padding:18px 22px;text-align:center">'
      + (!imgSrc ? '<div style="font-size:44px;margin-bottom:10px">' + esc(b.emojiDecor||'') + '</div>' : '')
      + (b.attribution ? '<div style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin-bottom:10px">' + esc(b.attribution) + '</div>' : '')
      + '<div style="font-family:' + t.fontBody + ';font-size:16px;color:' + t.text + ';font-style:italic;line-height:1.65;max-width:760px;margin:0 auto">' + esc(b.content||'') + '</div>'
      + (b.sourceUrl ? '<div style="margin-top:10px"><a href="' + esc(b.sourceUrl) + '" target="_blank" rel="noopener noreferrer" style="font-family:' + t.fontBody + ';font-size:12px;color:' + t.accent + ';text-decoration:none">Source </a></div>' : '')
      + '</div></div></div>';
  }

  function renderSpacer(b, t) {
    return '<div style="height:' + (b.height||24) + 'px;' + (b.showLine ? 'border-top:1px ' + esc(b.lineStyle||'solid') + ' ' + t.border + ';margin:0 40px' : '') + '"></div>';
  }

  function renderAiSafety(b, t) {
    var severityConfig = {
      critical:      {color:'#C0392B',bg:'#FEF0EE',border:'#f5c6c0',label:'CRITICAL',icon:''},
      high:          {color:'#C06500',bg:'#FFF4E6',border:'#F6D860',label:'HIGH',icon:''},
      medium:        {color:'#0057A8',bg:'#EEF4FF',border:'#C8D9EE',label:'MEDIUM',icon:''},
      informational: {color:'#005F6B',bg:'#F0FAFA',border:'#B2E0E4',label:'INFO',icon:''},
    };
    var updatesHtml = (b.updates||[]).map(function(u) {
      var sev = severityConfig[u.severity] || severityConfig.informational;
      var titleHtml = u.url ? '<a href="' + esc(u.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.text + ';text-decoration:none">' + esc(u.title||'') + '</a>' : esc(u.title||'');
      return '<div style="border:1px solid ' + sev.border + ';border-radius:10px;background:' + sev.bg + '">'
        + '<div style="display:flex;align-items:flex-start;gap:12px;padding:14px 16px">'
        + '<div style="flex-shrink:0;display:flex;flex-direction:column;align-items:center;gap:4px;padding-top:2px"><span style="font-size:14px">' + sev.icon + '</span><span style="font-family:' + t.fontMono + ';font-size:8px;letter-spacing:0.1em;text-transform:uppercase;color:' + sev.color + ';font-weight:700">' + sev.label + '</span></div>'
        + '<div style="flex:1"><div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;flex-wrap:wrap"><span style="font-family:' + t.fontMono + ';font-size:9px;letter-spacing:0.1em;text-transform:uppercase;color:' + sev.color + ';padding:2px 7px;background:' + sev.color + '18;border-radius:999px">' + esc(u.category||'') + '</span><span style="font-family:' + t.fontMono + ';font-size:10px;color:' + t.muted + '">' + esc(u.date||'') + '</span></div>'
        + '<div style="font-family:' + t.fontBody + ';font-size:14px;font-weight:600;color:' + t.text + ';margin-bottom:4px">' + titleHtml + '</div>'
        + '<p style="font-family:' + t.fontBody + ';font-size:13px;color:' + t.muted + ';margin:0;line-height:1.55">' + esc(u.summary||'') + '</p>'
        + (u.url ? '<a href="' + esc(u.url) + '" target="_blank" rel="noopener noreferrer" style="display:inline-block;margin-top:8px;font-family:' + t.fontBody + ';font-size:11px;color:' + sev.color + ';font-weight:600">View full guidance </a>' : '')
        + '</div></div></div>';
    }).join('');
    return '<div style="padding:28px 40px">'
      + '<div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:10px"><div><div style="display:flex;align-items:center;gap:8px;margin-bottom:6px"><span style="font-size:18px"></span><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:#C0392B">AI Safety Monitor</div></div><h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 4px;font-weight:400">' + esc(b.heading||'') + '</h2><p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0">' + esc(b.subheading||'') + '</p></div>'
      + (b.showLastUpdated ? '<div style="font-family:' + t.fontMono + ';font-size:10px;color:' + t.muted + ';text-align:right;line-height:1.4">Last updated<br>' + new Date().toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) + '</div>' : '')
      + '</div>'
      + '<div style="display:flex;flex-direction:column;gap:12px">' + updatesHtml + '</div>'
      + '</div>';
  }

  function renderInstitutionalSpotlight(b, t) {
    var items = (b.items||[]).slice(0, b.maxItems||6).map(function(item) {
      return '<div style="border:1px solid ' + t.border + ';border-radius:10px;overflow:hidden;background:' + t.surface + ';display:flex;flex-direction:column">'
        + (item.imageUrl ? '<div style="height:120px;overflow:hidden"><img src="' + esc(item.imageUrl) + '" alt="' + esc(item.title) + '" style="width:100%;height:100%;object-fit:cover"></div>' : '')
        + '<div style="padding:14px;flex:1;display:flex;flex-direction:column">'
        + (item.category ? '<span style="font-family:' + t.fontMono + ';font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:' + t.accent + ';margin-bottom:6px;display:block">' + esc(item.category) + '</span>' : '')
        + '<div style="font-family:' + t.fontBody + ';font-size:13px;font-weight:600;color:' + t.text + ';margin-bottom:6px;line-height:1.35;flex:1">' + (item.url ? '<a href="' + esc(item.url) + '" target="_blank" rel="noopener noreferrer" style="color:' + t.text + ';text-decoration:none">' + esc(item.title) + '</a>' : esc(item.title)) + '</div>'
        + (item.summary ? '<p style="font-family:' + t.fontBody + ';font-size:12px;color:' + t.muted + ';margin:0 0 8px;line-height:1.5">' + esc(item.summary) + '</p>' : '')
        + (item.url ? '<a href="' + esc(item.url) + '" target="_blank" rel="noopener noreferrer" style="margin-top:8px;font-family:' + t.fontBody + ';font-size:11px;color:' + t.accent + ';font-weight:600;text-decoration:none">Read more </a>' : '')
        + '</div></div>';
    }).join('');
    return '<div style="padding:28px 40px">'
      + '<div style="display:flex;align-items:center;gap:10px;margin-bottom:6px"><div style="width:28px;height:28px;background:' + t.primary + ';border-radius:6px;display:flex;align-items:center;justify-content:center;flex-shrink:0"><span style="font-size:14px"></span></div><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.18em;text-transform:uppercase;color:' + t.primary + '">' + esc(b.institutionLabel||'Your Institution') + '</div></div>'
      + '<h2 style="font-family:' + t.fontDisplay + ';font-size:26px;color:' + t.text + ';margin:0 0 4px;font-weight:400">' + esc(b.heading||'') + '</h2>'
      + (b.subheading ? '<p style="font-family:' + t.fontBody + ';font-size:14px;color:' + t.muted + ';margin:0 0 20px">' + esc(b.subheading) + '</p>' : '')
      + '<div class="nap-3col" style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px">' + items + '</div>'
      + '</div>';
  }

  function renderRssSidebar(b, t) {
    var urls = (b.feedUrls||[]).filter(Boolean);
    var dataFeeds = esc(JSON.stringify(urls));
    var max = typeof b.maxItems === 'number' ? b.maxItems : 10;
    var safeMax = Math.min(50, Math.max(1, max));
    var itemsHtml = (b.items||[]).slice(0, safeMax).map(function(item, i) {
      return '<div style="padding:11px 18px;border-bottom:1px solid ' + t.border + ';display:flex;gap:10px;align-items:flex-start">'
        + '<span style="font-family:' + t.fontMono + ';font-size:12px;color:' + t.accent + ';flex-shrink:0;min-width:20px;margin-top:1px">' + String(i+1).padStart(2,'0') + '</span>'
        + '<div style="flex:1"><div style="font-family:' + t.fontBody + ';font-size:13px;font-weight:600;color:' + t.text + ';line-height:1.3;margin-bottom:3px">' + (item.url ? '<a href="' + esc(item.url) + '" target="_blank" rel="noopener" style="color:' + t.text + ';text-decoration:none">' + esc(item.title||'') + '</a>' : esc(item.title||'')) + '</div>'
        + '<div style="display:flex;gap:8px;align-items:center">' + (item.source ? '<span style="font-family:' + t.fontMono + ';font-size:9px;color:' + t.muted + ';text-transform:uppercase;letter-spacing:0.08em">' + esc(item.source) + '</span>' : '') + (item.pubDate ? '<span style="font-family:' + t.fontMono + ';font-size:9px;color:' + t.muted + '">' + new Date(item.pubDate).toLocaleDateString() + '</span>' : '') + '</div>'
        + '</div>'
        + (item.url ? '<a href="' + esc(item.url) + '" target="_blank" rel="noopener" style="flex-shrink:0;font-family:' + t.fontBody + ';font-size:11px;color:' + t.accent + ';font-weight:600;text-decoration:none;padding-top:1px"></a>' : '')
        + '</div>';
    }).join('');
    return '<div style="padding:24px 40px">'
      + '<div class="nap-rss-sidebar" data-feeds="" data-max="' + safeMax + '" data-live="0" data-key="' + esc(b.id||(b.heading||'rss')) + '" style="border:1px solid ' + t.border + ';border-radius:12px;overflow:hidden;background:' + t.surface + '">'
      + '<div style="background:' + t.primary + ';padding:12px 18px;display:flex;align-items:center;gap:8px;color:#fff"><span style="font-size:14px"></span><span style="font-family:' + t.fontMono + ';font-size:11px;letter-spacing:0.14em;text-transform:uppercase;color:#fff;font-weight:600">' + esc(b.heading||'News') + '</span><span style="margin-left:auto;font-family:' + t.fontMono + ';font-size:9px;color:rgba(255,255,255,0.7)" class="nap-rss-timestamp">' + (b.lastFetched ? 'Updated ' + new Date(b.lastFetched).toLocaleDateString() : 'Snapshot') + '</span></div>'
      + '<div class="nap-rss-scroll"><div class="nap-rss-items">' + (itemsHtml || (!urls.length ? '<div style="padding:24px 18px;text-align:center;color:' + t.muted + ';font-family:' + t.fontBody + ';font-size:13px">No feeds configured.</div>' : '<div style="padding:24px 18px;text-align:center;color:' + t.muted + ';font-family:' + t.fontBody + ';font-size:13px">Enable Live RSS to fetch content.</div>')) + '</div></div>'
      + '</div></div>';
  }

  function renderFooter(b, t) {
    var contactEmail = b.contactEmail || '';
    var contactHref = contactEmail ? 'mailto:' + esc(contactEmail) + '?subject=' + encodeURIComponent('Newsletter Feedback') : '#';
    return '<div class="nap-white-section" style="background:' + t.primary + ';padding:44px 40px 36px;text-align:center;color:#fff">'
      + ((b.nextIssueDate||b.nextIssueTeaser) ? '<div style="background:rgba(255,255,255,0.12);border-radius:10px;padding:14px 20px;margin-bottom:28px;display:inline-block"><div style="font-family:' + t.fontMono + ';font-size:10px;letter-spacing:0.14em;text-transform:uppercase;color:rgba(255,255,255,0.75);margin-bottom:4px">Next Issue</div><div style="font-family:' + t.fontBody + ';font-size:14px;color:#fff">' + esc(b.nextIssueDate||'') + (b.nextIssueTeaser ? '  ' + esc(b.nextIssueTeaser) : '') + '</div></div>' : '')
      + '<div style="font-family:' + t.fontDisplay + ';font-size:22px;color:#fff;margin-bottom:4px;font-weight:400">' + esc(b.institution||'') + '</div>'
      + '<div style="font-family:' + t.fontBody + ';font-size:14px;color:rgba(255,255,255,0.85);margin-bottom:4px">' + esc(b.department||'') + '</div>'
      + (b.editors ? '<div style="font-family:' + t.fontBody + ';font-size:13px;color:rgba(255,255,255,0.75);margin-bottom:22px">' + esc(b.editors) + '</div>' : '')
      + '<div style="display:flex;justify-content:center;margin-bottom:22px"><a href="' + esc(contactHref) + '" style="display:inline-flex;align-items:center;gap:10px;font-family:' + t.fontBody + ';font-size:13px;font-weight:700;color:#fff;text-decoration:none;padding:10px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.35);background:rgba(255,255,255,0.10)">Contact Us <span style="opacity:0.8"></span></a></div>'
      + '<div style="height:1px;background:rgba(255,255,255,0.18);max-width:240px;margin:0 auto 18px"></div>'
      + (b.disclaimer ? '<p style="font-family:' + t.fontBody + ';font-size:11px;color:rgba(255,255,255,0.75);margin:0 0 8px;max-width:580px;margin-left:auto;margin-right:auto;line-height:1.6">' + esc(b.disclaimer) + '</p>' : '')
      + '<p style="font-family:' + t.fontMono + ';font-size:10px;color:rgba(255,255,255,0.65);margin:0;letter-spacing:0.1em"> ' + esc(b.copyrightYear||String(new Date().getFullYear())) + ' ' + esc(b.institution||'') + '</p>'
      + '</div>';
  }

  //  Main render function 
  function renderNewsletter(data) {
    var t = data.theme;
    applyThemeCss(t);

    var body = (data.blockOrder || []).map(function(id) {
      var block = data.blocks && data.blocks[id];
      return block ? renderBlock(block, t) : '';
    }).join('\\n');

    var contentEl = document.getElementById('nap-content');
    contentEl.innerHTML = '<div class="nap-export-wrap"><div class="nap-shell">' + body + '</div></div>';
    contentEl.style.display = 'block';
    contentEl.style.animation = 'fadeIn 0.3s ease';

    document.title = (data.meta && data.meta.title) || 'Newsletter';

    // Show toolbar with issue info
    var toolbar = document.getElementById('nap-toolbar');
    var issueTitle = (data.meta && data.meta.title) || '';
    var issueNum = (data.meta && data.meta.issueNumber) ? 'Issue ' + data.meta.issueNumber : '';
    var issueMeta = [issueNum, issueTitle].filter(Boolean).join('  ');
    if (issueMeta) {
      var metaEl = document.createElement('span');
      metaEl.style.cssText = 'font-family:"DM Mono",monospace;font-size:11px;letter-spacing:0.1em;color:rgba(255,255,255,0.6);padding:0 4px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap';
      metaEl.textContent = issueMeta;
      toolbar.insertBefore(metaEl, toolbar.firstChild);
    }

    // Show toolbar
    document.getElementById('nap-toolbar').style.display = 'flex';

    // Hide loading
    document.getElementById('nap-loading').style.display = 'none';

    // Boot the runtime (RSS, copy buttons, etc.)
    bootRuntime();
  }

  //  JSON loading 
  function showError(msg, filename) {
    document.getElementById('nap-loading').style.display = 'none';
    var errorEl = document.getElementById('nap-error');
    errorEl.style.display = 'flex';
    if (msg) document.getElementById('nap-error-msg').textContent = msg;
    if (filename) {
      document.getElementById('nap-error-filename').textContent = filename;
      document.getElementById('nap-error-hint').querySelector('code').textContent = filename;
    }
  }

  async function tryFetch(filename) {
    try {
      var res = await fetch('./' + filename, { cache: 'no-store' });
      if (!res.ok) return null;
      return await res.json();
    } catch (e) {
      return null;
    }
  }

  async function loadNewsletter() {
    // 1) Embedded JSON  works with file:// protocol, no server needed
    if (window.__NEWSLETTER__) {
      renderNewsletter(window.__NEWSLETTER__);
      return;
    }

    // 2) URL param: ?json=newsletter_issue001.json
    var params = new URLSearchParams(window.location.search);
    var paramFile = params.get('json');
    if (paramFile) {
      var data = await tryFetch(paramFile);
      if (data) { renderNewsletter(data); return; }
      showError('Could not fetch: ' + paramFile, paramFile);
      return;
    }

    // 3) Meta tag hint: <meta name="nap-issue-file" content="newsletter_issue001.json">
    var metaTag = document.querySelector('meta[name="nap-issue-file"]');
    var metaFile = metaTag && metaTag.getAttribute('content');
    if (metaFile) {
      var data2 = await tryFetch(metaFile);
      if (data2) { renderNewsletter(data2); return; }
    }

    // 4) Auto-detect: try common filenames
    var candidates = [];
    for (var i = 1; i <= 10; i++) {
      candidates.push('newsletter_issue' + String(i).padStart(3,'0') + '.json');
      candidates.push('newsletter_issue' + i + '.json');
    }
    candidates.push('newsletter.json');
    for (var j = 0; j < candidates.length; j++) {
      var d = await tryFetch(candidates[j]);
      if (d && d.blocks) { renderNewsletter(d); return; }
    }

    // 5) Nothing found  show error with drop/browse UI
    var hint = metaFile || 'newsletter_issue001.json';
    showError(
      'Place the JSON file in the same folder and open via a local server, or drag & drop it here.',
      hint
    );
  }

  //  Drag & drop + file browse 
  function loadFromFile(file) {
    var reader = new FileReader();
    reader.onload = function(e) {
      try {
        var data = JSON.parse(e.target.result);
        document.getElementById('nap-error').style.display = 'none';
        renderNewsletter(data);
      } catch (err) {
        showError('Invalid JSON file: ' + err.message);
      }
    };
    reader.readAsText(file);
  }

  document.addEventListener('dragover', function(e) {
    e.preventDefault();
    document.getElementById('nap-drop-overlay').style.display = 'flex';
  });
  document.addEventListener('dragleave', function(e) {
    if (!e.relatedTarget) document.getElementById('nap-drop-overlay').style.display = 'none';
  });
  document.addEventListener('drop', function(e) {
    e.preventDefault();
    document.getElementById('nap-drop-overlay').style.display = 'none';
    var file = e.dataTransfer.files[0];
    if (file && file.name.endsWith('.json')) loadFromFile(file);
  });

  // Error page browse button
  var fileInput = document.getElementById('nap-file-input');
  if (fileInput) fileInput.addEventListener('change', function() {
    if (this.files[0]) loadFromFile(this.files[0]);
  });

  // Toolbar buttons
  var toolbarFile = document.getElementById('nap-toolbar-file');
  document.getElementById('btn-load-file').addEventListener('click', function() {
    toolbarFile.click();
  });
  toolbarFile.addEventListener('change', function() {
    if (this.files[0]) loadFromFile(this.files[0]);
  });
  document.getElementById('btn-print').addEventListener('click', function() {
    window.print();
  });

  //  Runtime (RSS, copy, expand) 
  // This is the same runtime from export.ts, extracted verbatim and called after render.
  function bootRuntime() {
    // Inline the full runtime script here  same as runtimeScript() in export.ts
    // (Injected as a string eval to keep separation clean)
    var s = document.createElement('script');
    s.textContent = RUNTIME_SCRIPT;
    document.body.appendChild(s);
  }

  // Start loading
  loadNewsletter();

})();
<\/script>

<!-- Runtime script (RSS feeds, copy buttons, expand toggles) -->
<!-- This is injected after renderNewsletter() completes via bootRuntime() -->
<script id="nap-runtime-src" type="text/nap-runtime">
RUNTIME_PLACEHOLDER
<\/script>
<script>
// Wire the runtime script text for bootRuntime()
var RUNTIME_SCRIPT = document.getElementById('nap-runtime-src').textContent;
<\/script>

</body>
</html>`}function L1(t,e="sidecar"){const n=O1(t),r=e==="embedded"?JSON.stringify(t):null;let i=RC(r,n);const o=z1.replace(/<\/script>/g,"<\\/script>");i=i.replace("RUNTIME_PLACEHOLDER",o);const s=new Blob([i],{type:"text/html"}),l=URL.createObjectURL(s),a=document.createElement("a");a.href=l,a.download="index.html",a.click(),URL.revokeObjectURL(l)}function $C(t){N1(t),setTimeout(()=>L1(t,"sidecar"),400)}function OC(t){L1(t,"embedded")}const NC=[{id:"viewer-embedded",icon:d.jsx(bg,{size:14}),label:"Viewer + JSON (self-contained)",sub:"Single .html with JSON embedded  double-click to open anywhere",highlight:!0},{id:"viewer-bundle",icon:d.jsx(bg,{size:14}),label:"Viewer + JSON (sidecar)",sub:"viewer.html + newsletter_issue#.json  serve or host together"},{divider:!0},{id:"html",icon:d.jsx(v2,{size:14}),label:"Export HTML",sub:"Standalone page  exact match to builder preview"},{id:"email",icon:d.jsx(k2,{size:14}),label:"Export Email HTML",sub:"Table-based, Gmail / Outlook compatible"},{divider:!0},{id:"pdf-a4",icon:d.jsx(wg,{size:14}),label:"Print / PDF (A4)",sub:"Opens browser print dialog  Save as PDF"},{id:"pdf-letter",icon:d.jsx(wg,{size:14}),label:"Print / PDF (Letter)",sub:"US Letter format  Opens print dialog"},{divider:!0},{id:"json",icon:d.jsx(b2,{size:14}),label:"Export JSON",sub:"newsletter_issue#.json  re-importable backup"}];function LC({newsletter:t,editorState:e,lastSaved:n,isMobile:r,isTablet:i,drawerOpen:o,onToggleDrawer:s,onSave:l,onSaveVersion:a,onImport:c,onTogglePreview:u,onZoomChange:f}){const p=S.useRef(null),[h,m]=S.useState(!1),[g,v]=S.useState(!1),y=S.useRef(null),x=[75,90,100,110,125],b=x.indexOf(e.zoom),w=r||i;S.useEffect(()=>{if(!g)return;const E=k=>{y.current&&!y.current.contains(k.target)&&v(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[g]);function C(E){switch(v(!1),E){case"html":oC(t);break;case"email":AC(t);break;case"pdf":Kd(t,"A4");break;case"pdf-a4":Kd(t,"A4");break;case"pdf-letter":Kd(t,"Letter");break;case"viewer-bundle":$C(t);break;case"viewer-embedded":OC(t);break;case"json":N1(t);break}}return d.jsxs("div",{style:{height:56,background:"var(--color-primary)",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",gap:8,flexShrink:0,fontFamily:"var(--font-body)",position:"relative",zIndex:400},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,minWidth:0,flex:1},children:[w&&d.jsx(nr,{icon:o?d.jsx(Gc,{size:16}):d.jsx(C2,{size:16}),onClick:s,title:"Toggle panels"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{color:"#fff",fontFamily:"var(--font-display)",fontSize:r?13:15,fontWeight:400,lineHeight:1.1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:r?140:220},children:t.meta.title||"Newsletter Builder"}),!r&&d.jsxs("span",{style:{color:"rgba(255,255,255,0.5)",fontFamily:"var(--font-mono)",fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase"},children:["Issue ",t.meta.issueNumber," Builder"]})]})]}),!r&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[d.jsx(nr,{icon:d.jsx(I2,{size:14}),title:"Zoom out",onClick:()=>f(x[Math.max(0,b-1)]),disabled:b<=0}),d.jsxs("span",{style:{color:"rgba(255,255,255,0.7)",fontFamily:"var(--font-mono)",fontSize:12,minWidth:36,textAlign:"center"},children:[e.zoom,"%"]}),d.jsx(nr,{icon:d.jsx(A2,{size:14}),title:"Zoom in",onClick:()=>f(x[Math.min(x.length-1,b+1)]),disabled:b>=x.length-1})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexShrink:0},children:[n&&!w&&d.jsx("span",{style:{color:"rgba(255,255,255,0.45)",fontFamily:"var(--font-mono)",fontSize:11,marginRight:4},children:n}),d.jsx(nr,{icon:e.previewMode?d.jsx(y2,{size:14}):d.jsx(x2,{size:14}),label:r?void 0:e.previewMode?"Edit":"Preview",onClick:u,active:e.previewMode,title:"Toggle preview"}),d.jsxs("div",{ref:y,style:{position:"relative"},children:[d.jsxs("button",{onClick:()=>v(E=>!E),style:{display:"inline-flex",alignItems:"center",gap:6,padding:r?"6px 8px":"6px 12px",background:"rgba(255,255,255,0.22)",border:"1px solid rgba(255,255,255,0.4)",borderRadius:8,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer",transition:"all 0.15s",whiteSpace:"nowrap"},title:"Export options",children:[d.jsx(I1,{size:14}),!r&&d.jsx("span",{children:"Export"}),!r&&d.jsx(A1,{size:11,style:{opacity:.7,transform:g?"rotate(180deg)":"none",transition:"transform 0.15s"}})]}),g&&d.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:6,background:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.22)",zIndex:600,padding:6,minWidth:280,animation:"fadeInUp 0.15s ease"},children:[d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:9,letterSpacing:"0.16em",textTransform:"uppercase",color:"var(--color-muted)",padding:"6px 12px 4px"},children:"Export Options"}),NC.map((E,k)=>"divider"in E?d.jsx("div",{style:{height:1,background:"var(--color-border)",margin:"4px 8px"}},k):d.jsxs("button",{onClick:()=>C(E.id),style:{display:"flex",alignItems:"flex-start",gap:10,width:"100%",padding:"9px 12px",background:E.highlight?"var(--color-accent)0F":"none",border:E.highlight?"1px solid var(--color-accent)33":"1px solid transparent",borderRadius:8,fontFamily:"var(--font-body)",fontSize:13,color:"var(--color-text)",cursor:"pointer",textAlign:"left",marginBottom:2},onMouseEnter:M=>{M.currentTarget.style.background="var(--color-bg)"},onMouseLeave:M=>{M.currentTarget.style.background=E.highlight?"var(--color-accent)0F":"none"},children:[d.jsx("span",{style:{color:E.highlight?"var(--color-accent)":"var(--color-muted)",marginTop:1,flexShrink:0},children:E.icon}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:E.highlight?600:400,color:E.highlight?"var(--color-accent)":"var(--color-text)"},children:E.label}),E.sub&&d.jsx("div",{style:{fontSize:11,color:"var(--color-muted)",marginTop:1},children:E.sub})]})]},E.id))]})]}),!w&&d.jsxs(d.Fragment,{children:[d.jsx(nr,{icon:d.jsx(kg,{size:14}),label:"Save",onClick:l}),d.jsx(nr,{icon:d.jsx(Sg,{size:14}),label:"Version",onClick:a}),d.jsx(nr,{icon:d.jsx(Cg,{size:14}),label:"Import",onClick:()=>{var E;return(E=p.current)==null?void 0:E.click()}})]}),w&&d.jsxs("div",{style:{position:"relative"},children:[d.jsx(nr,{icon:d.jsx(E2,{size:16}),onClick:()=>m(E=>!E),active:h,title:"More actions"}),h&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:6,background:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:10,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",zIndex:500,padding:6,minWidth:160,animation:"fadeInUp 0.15s ease"},onClick:()=>m(!1),children:[{icon:d.jsx(kg,{size:14}),label:"Save",action:l},{icon:d.jsx(Sg,{size:14}),label:"Save Version",action:a},{icon:d.jsx(Cg,{size:14}),label:"Import JSON",action:()=>{var E;return(E=p.current)==null?void 0:E.click()}}].map(({icon:E,label:k,action:M})=>d.jsxs("button",{onClick:M,style:{display:"flex",alignItems:"center",gap:10,width:"100%",padding:"9px 12px",background:"none",border:"none",borderRadius:7,fontFamily:"var(--font-body)",fontSize:13,color:"var(--color-text)",cursor:"pointer",textAlign:"left"},onMouseEnter:$=>{$.currentTarget.style.background="var(--color-bg)"},onMouseLeave:$=>{$.currentTarget.style.background="none"},children:[d.jsx("span",{style:{color:"var(--color-muted)"},children:E}),k]},k))})]})]}),d.jsx("input",{ref:p,type:"file",accept:".json",style:{display:"none"},onChange:E=>{var M;const k=(M=E.target.files)==null?void 0:M[0];k&&c(k),E.target.value=""}})]})}function nr({icon:t,label:e,onClick:n,title:r,active:i,disabled:o}){return d.jsxs("button",{onClick:n,disabled:o,title:r,style:{display:"inline-flex",alignItems:"center",gap:6,padding:e?"6px 12px":"6px 8px",background:i?"rgba(255,255,255,0.16)":"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:8,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:o?"not-allowed":"pointer",opacity:o?.4:1,transition:"all 0.15s",whiteSpace:"nowrap"},onMouseEnter:s=>{o||(s.currentTarget.style.background="rgba(255,255,255,0.22)")},onMouseLeave:s=>{s.currentTarget.style.background=i?"rgba(255,255,255,0.16)":"rgba(255,255,255,0.08)"},children:[t,e&&d.jsx("span",{children:e})]})}const Pa=[{id:"frontiers-in-neuroscience-rss",label:"Frontiers in Neuroscience  RSS",url:"https://www.frontiersin.org/journals/neuroscience/rss",tags:["neuroscience","journal"]},{id:"frontiers-in-neurology-rss",label:"Frontiers in Neurology  RSS",url:"https://www.frontiersin.org/journals/neurology/rss",tags:["neurology","journal"]},{id:"mit-news-artificial-intelligence",label:"MIT News  Artificial Intelligence",url:"https://news.mit.edu/rss/topic/artificial-intelligence2",tags:["ai","news"]},{id:"sciencedaily-artificial-intelligence",label:"ScienceDaily  Artificial Intelligence",url:"https://www.sciencedaily.com/rss/computers_math/artificial_intelligence.xml",tags:["ai","news"]},{id:"marktechpost-ai-news",label:"MarkTechPost  AI News",url:"https://www.marktechpost.com/feed/",tags:["ai","news"]},{id:"the-lancet-neurology-current",label:"The Lancet Neurology  Current",url:"https://www.thelancet.com/rssfeed/laneur_current.xml",tags:["neurology","journal"]},{id:"jama-neurology-rss",label:"JAMA Neurology  RSS",url:"https://jamanetwork.com/rss/site_16/0.xml",tags:["neurology","journal"]},{id:"npj-digital-medicine-rss",label:"npj Digital Medicine  RSS",url:"https://www.nature.com/npjdigitalmed.rss",tags:["digital-medicine","journal"]},{id:"pubmed-rss-neurology-ai-search",label:"PubMed RSS  Neurology AI Search",url:"https://pubmed.ncbi.nlm.nih.gov/rss/search/1x9bY_ZPGMIgWOrGWvQbkjt2X1J5zCH66gaj5UHwPTuOP_TklI/?limit=15&utm_campaign=pubmed-2&fc=20260222062849",tags:["pubmed","ai","neurology"]},{id:"jama-neuro-onlinefirst",label:"JAMA Neurology  Online First",url:"https://jamanetwork.com/rss/site_16/onlineFirst_72.xml",tags:["neurology","journal"]},{id:"jama-neuro-current",label:"JAMA Neurology  Current Issue",url:"https://jamanetwork.com/rss/site_16/72.xml",tags:["neurology","journal"]},{id:"practical-neurology-current",label:"Practical Neurology (BMJ)  Current Issue",url:"https://pn.bmj.com/rss/current.xml",tags:["neurology","journal"]},{id:"fierce-healthcare-healthtech",label:"Fierce Healthcare  Health Tech",url:"https://www.fiercehealthcare.com/rss/health%20%26%20tech/xml",tags:["ai","health-it","news"]},{id:"fierce-healthcare-all",label:"Fierce Healthcare  All Stories",url:"https://www.fiercehealthcare.com/rss/xml",tags:["health-it","news"]},{id:"nejm-ai-podcast",label:"NEJM AI Grand Rounds (Podcast RSS)",url:"https://ai-podcast.nejm.org/feed.xml",tags:["ai","medicine","podcast"]}];function PC({block:t,onClose:e,onUpdateBlock:n,onAddArticle:r,onUpdateArticle:i,onDeleteArticle:o,onAddQuickHit:s,onUpdateQuickHit:l,onDeleteQuickHit:a}){const c=u=>n(t.id,u);return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:11,letterSpacing:"0.1em",textTransform:"uppercase",color:"var(--color-muted)"},children:"Block Settings"}),d.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-muted)",padding:4,borderRadius:4},children:d.jsx(Gc,{size:16})})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:0},children:[t.type==="header"&&d.jsx(FC,{block:t,upd:c}),t.type==="ticker"&&d.jsx(iE,{block:t,upd:c}),t.type==="section-divider"&&d.jsx(BC,{block:t,upd:c}),t.type==="article-grid"&&d.jsx(_C,{block:t,upd:c,onAddArticle:()=>r(t.id),onUpdateArticle:(u,f)=>i(t.id,u,f),onDeleteArticle:u=>o(t.id,u)}),t.type==="spotlight"&&d.jsx(HC,{block:t,upd:c,onUpdateArticle:(u,f)=>i(t.id,u,f)}),t.type==="ethics-split"&&d.jsx(UC,{block:t,upd:c}),t.type==="image"&&d.jsx(WC,{block:t,upd:c}),t.type==="text"&&d.jsx(KC,{block:t,upd:c}),t.type==="html-embed"&&d.jsx(qC,{block:t,upd:c}),t.type==="prompt-masterclass"&&d.jsx(JC,{block:t,upd:c}),t.type==="sbar-prompt"&&d.jsx(GC,{block:t,upd:c}),t.type==="prompt-template"&&d.jsx(YC,{block:t,upd:c}),t.type==="safety-reminders"&&d.jsx(QC,{block:t,upd:c}),t.type==="term-of-month"&&d.jsx(XC,{block:t,upd:c}),t.type==="ai-case-file"&&d.jsx(rE,{block:t,upd:c}),t.type==="quick-hits"&&d.jsx(ZC,{block:t,upd:c,onAddHit:()=>s(t.id),onUpdateHit:(u,f)=>l(t.id,u,f),onDeleteHit:u=>a(t.id,u)}),t.type==="humor"&&d.jsx(nE,{block:t,upd:c}),t.type==="spacer"&&d.jsx(eE,{block:t,upd:c}),t.type==="footer"&&d.jsx(tE,{block:t,upd:c}),t.type==="ai-safety"&&d.jsx(VC,{block:t,upd:c}),t.type==="institutional-spotlight"&&d.jsx(oE,{block:t,upd:c}),t.type==="rss-sidebar"&&d.jsx(sE,{block:t,upd:c}),t.type==="clinical-prompt-templates"&&d.jsx(lE,{block:t,upd:c})]})]})}function FC({block:t,upd:e}){const n=S.useRef(null);return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:t.title,onChange:r=>e({title:r.target.value})})}),d.jsx(j,{label:"Subtitle",children:d.jsx("input",{style:D,value:t.subtitle,onChange:r=>e({subtitle:r.target.value})})}),d.jsx(j,{label:"Issue Number",children:d.jsx("input",{style:D,value:t.issueNumber,onChange:r=>e({issueNumber:r.target.value})})}),d.jsx(j,{label:"Issue Date",children:d.jsx("input",{style:D,value:t.issueDate,onChange:r=>e({issueDate:r.target.value})})}),d.jsx(j,{label:"Tagline",children:d.jsx("textarea",{style:ne,value:t.tagline,onChange:r=>e({tagline:r.target.value})})}),d.jsx(j,{label:"Background Style",children:d.jsxs("select",{style:D,value:t.backgroundStyle,onChange:r=>e({backgroundStyle:r.target.value}),children:[d.jsx("option",{value:"gradient",children:"Gradient"}),d.jsx("option",{value:"solid",children:"Solid"}),d.jsx("option",{value:"mesh",children:"Mesh"}),d.jsx("option",{value:"wave",children:"Wave"})]})}),d.jsx(j,{label:"Logo URL",children:d.jsx("input",{style:D,value:t.logoUrl,onChange:r=>e({logoUrl:r.target.value}),placeholder:"https://"})}),d.jsxs(j,{label:"Logo Upload",children:[d.jsx("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:"Click to upload image"}),d.jsx("input",{ref:n,type:"file",accept:"image/*",style:{display:"none"},onChange:r=>{var s;const i=(s=r.target.files)==null?void 0:s[0];if(!i)return;const o=new FileReader;o.onload=l=>{var a;return e({logoDataUrl:(a=l.target)==null?void 0:a.result})},o.readAsDataURL(i)}}),t.logoDataUrl&&d.jsx("div",{style:{marginTop:8,padding:8,background:"var(--color-bg)",borderRadius:8,textAlign:"center"},children:d.jsx("img",{src:t.logoDataUrl,alt:"Logo",style:{maxHeight:48,maxWidth:"100%"}})})]})]})}function BC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Label",children:d.jsx("input",{style:D,value:t.label,onChange:n=>e({label:n.target.value})})}),d.jsx(j,{label:"Number",children:d.jsx("input",{style:D,type:"number",value:t.number,onChange:n=>e({number:Number(n.target.value)})})}),d.jsx(j,{label:"Description",children:d.jsx("textarea",{style:ne,value:t.description,onChange:n=>e({description:n.target.value})})}),d.jsx(j,{label:"Style",children:d.jsxs("select",{style:D,value:t.style,onChange:n=>e({style:n.target.value}),children:[d.jsx("option",{value:"gradient",children:"Gradient"}),d.jsx("option",{value:"line",children:"Line"}),d.jsx("option",{value:"bold",children:"Bold"}),d.jsx("option",{value:"numbered",children:"Numbered"})]})})]})}function P1({article:t,onUpdate:e,onDelete:n}){const r=S.useRef(null);return d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:12,marginBottom:12},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.1em",textTransform:"uppercase"},children:"Article"}),d.jsx("button",{onClick:n,style:{background:"#FEF0EE",border:"1px solid #f5c6c0",borderRadius:6,color:"#7A1E12",cursor:"pointer",padding:"3px 8px",fontSize:11,fontFamily:"var(--font-body)"},children:"Delete"})]}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:t.title,onChange:i=>e({title:i.target.value})})}),d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:t.url,onChange:i=>e({url:i.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Source / Journal",children:d.jsx("input",{style:D,value:t.source,onChange:i=>e({source:i.target.value})})}),d.jsx(j,{label:"Date",children:d.jsx("input",{style:D,type:"date",value:t.pubDate,onChange:i=>e({pubDate:i.target.value})})}),d.jsx(j,{label:"Image URL",children:d.jsx("input",{style:D,value:t.imageUrl,onChange:i=>e({imageUrl:i.target.value}),placeholder:"https:// (optional)"})}),d.jsxs(j,{label:"Upload Image",children:[d.jsx("button",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:"Upload image"}),d.jsx("input",{ref:r,type:"file",accept:"image/*",style:{display:"none"},onChange:i=>{var l;const o=(l=i.target.files)==null?void 0:l[0];if(!o)return;const s=new FileReader;s.onload=a=>{var c;return e({imageUrl:(c=a.target)==null?void 0:c.result})},s.readAsDataURL(o)}})]}),d.jsx(j,{label:"Summary",children:d.jsx("textarea",{style:ne,value:t.summary,onChange:i=>e({summary:i.target.value})})}),d.jsx(j,{label:"Clinical Context",children:d.jsx("textarea",{style:ne,value:t.clinicalContext,onChange:i=>e({clinicalContext:i.target.value})})}),d.jsx(j,{label:"My Take",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:t.myTake,onChange:i=>e({myTake:i.target.value})})}),d.jsx(j,{label:"Evidence Level",children:d.jsxs("select",{style:D,value:t.evidenceLevel,onChange:i=>e({evidenceLevel:i.target.value}),children:[d.jsx("option",{value:"",children:""}),d.jsx("option",{children:"High"}),d.jsx("option",{children:"Moderate"}),d.jsx("option",{children:"Low"}),d.jsx("option",{children:"Expert Opinion"})]})})]})}function _C({block:t,upd:e,onAddArticle:n,onUpdateArticle:r,onDeleteArticle:i}){var o;return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Section Title",children:d.jsx("input",{style:D,value:t.sectionTitle,onChange:s=>e({sectionTitle:s.target.value})})}),d.jsx(j,{label:"Columns",children:d.jsxs("select",{style:D,value:t.columns,onChange:s=>e({columns:Number(s.target.value)}),children:[d.jsx("option",{value:1,children:"1 column"}),d.jsx("option",{value:2,children:"2 columns"}),d.jsx("option",{value:3,children:"3 columns"})]})}),d.jsx(j,{label:"Layout",children:d.jsxs("select",{style:D,value:t.layout,onChange:s=>e({layout:s.target.value}),children:[d.jsx("option",{value:"card",children:"Card"}),d.jsx("option",{value:"editorial",children:"Editorial"}),d.jsx("option",{value:"compact",children:"Compact"})]})}),d.jsxs("div",{style:{marginTop:16},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.12em",textTransform:"uppercase"},children:[((o=t.articles)==null?void 0:o.length)||0," Articles"]}),d.jsxs("button",{onClick:n,style:{display:"flex",alignItems:"center",gap:4,padding:"5px 10px",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:11})," Add Article"]})]}),(t.articles||[]).map(s=>d.jsx(P1,{article:s,onUpdate:l=>r(s.id,l),onDelete:()=>i(s.id)},s.id))]})]})}function HC({block:t,upd:e,onUpdateArticle:n}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Layout",children:d.jsxs("select",{style:D,value:t.layout,onChange:r=>e({layout:r.target.value}),children:[d.jsx("option",{value:"left-image",children:"Image Left"}),d.jsx("option",{value:"right-image",children:"Image Right"}),d.jsx("option",{value:"top-image",children:"Image Top"}),d.jsx("option",{value:"no-image",children:"No Image"})]})}),d.jsx(j,{label:"Accent Color",children:d.jsx("input",{type:"color",value:t.accentColor,onChange:r=>e({accentColor:r.target.value})})}),d.jsxs("div",{style:{marginTop:8},children:[d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.12em",textTransform:"uppercase",marginBottom:8},children:"Article"}),d.jsx(P1,{article:t.article,onUpdate:r=>n(t.article.id,r),onDelete:()=>{}})]})]})}function UC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:n=>e({heading:n.target.value})})}),d.jsx(j,{label:"Subheading",children:d.jsx("input",{style:D,value:t.subheading,onChange:n=>e({subheading:n.target.value})})}),d.jsx(j,{label:"Source / Publication",children:d.jsx("input",{style:D,value:t.source,onChange:n=>e({source:n.target.value})})}),d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:t.url,onChange:n=>e({url:n.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Left Title",children:d.jsx("input",{style:D,value:t.leftTitle,onChange:n=>e({leftTitle:n.target.value})})}),d.jsx(j,{label:"Left Content",children:d.jsx("textarea",{style:ne,value:t.leftContent,onChange:n=>e({leftContent:n.target.value})})}),d.jsx(j,{label:"Right Title",children:d.jsx("input",{style:D,value:t.rightTitle,onChange:n=>e({rightTitle:n.target.value})})}),d.jsx(j,{label:"Right Content",children:d.jsx("textarea",{style:ne,value:t.rightContent,onChange:n=>e({rightContent:n.target.value})})}),d.jsx(j,{label:"Clinical Perspective",children:d.jsx("textarea",{style:ne,value:t.clinicalPerspective,onChange:n=>e({clinicalPerspective:n.target.value})})})]})}function VC({block:t,upd:e}){const n=t.updates||[],r=(s,l)=>{const a=n.map(c=>c.id===s?{...c,...l}:c);e({updates:a})},i=()=>{const s=`su_${Math.random().toString(36).slice(2,10)}`,l=new Date,a=l.getFullYear(),c=String(l.getMonth()+1).padStart(2,"0"),u=String(l.getDate()).padStart(2,"0"),f={id:s,date:`${a}-${c}-${u}`,category:"Guideline",title:"New safety update",summary:"Edit this safety recommendation and add a link (optional).",url:"",severity:"informational"};e({updates:[...n,f]})},o=s=>{e({updates:n.filter(l=>l.id!==s)})};return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:s=>e({heading:s.target.value})})}),d.jsx(j,{label:"Subheading",children:d.jsx("textarea",{style:ne,value:t.subheading,onChange:s=>e({subheading:s.target.value})})}),d.jsx(j,{label:"Show last updated",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:10,fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-text)"},children:[d.jsx("input",{type:"checkbox",checked:!!t.showLastUpdated,onChange:s=>e({showLastUpdated:s.target.checked})}),'Display "last updated" date']})}),d.jsxs("div",{style:{marginTop:14},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.12em",textTransform:"uppercase"},children:[n.length," Updates"]}),d.jsxs("button",{onClick:i,style:{display:"flex",alignItems:"center",gap:6,padding:"6px 10px",background:"var(--color-accent)",border:"none",borderRadius:8,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:12})," Add Update"]})]}),n.map(s=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:10,padding:12,marginBottom:12,background:"var(--color-surface)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.1em",textTransform:"uppercase"},children:"Safety update"}),d.jsx("button",{onClick:()=>o(s.id),style:{background:"#FEF0EE",border:"1px solid #f5c6c0",borderRadius:8,color:"#7A1E12",cursor:"pointer",padding:"4px 10px",fontSize:11,fontFamily:"var(--font-body)"},children:"Remove"})]}),d.jsx(j,{label:"Date",children:d.jsx("input",{style:D,type:"date",value:s.date,onChange:l=>r(s.id,{date:l.target.value})})}),d.jsx(j,{label:"Category",children:d.jsxs("select",{style:D,value:s.category,onChange:l=>r(s.id,{category:l.target.value}),children:[d.jsx("option",{value:"FDA",children:"FDA"}),d.jsx("option",{value:"Policy",children:"Policy"}),d.jsx("option",{value:"Guideline",children:"Guideline"}),d.jsx("option",{value:"Incident",children:"Incident"}),d.jsx("option",{value:"Alert",children:"Alert"}),d.jsx("option",{value:"Research",children:"Research"})]})}),d.jsx(j,{label:"Severity",children:d.jsxs("select",{style:D,value:s.severity,onChange:l=>r(s.id,{severity:l.target.value}),children:[d.jsx("option",{value:"critical",children:"critical"}),d.jsx("option",{value:"high",children:"high"}),d.jsx("option",{value:"medium",children:"medium"}),d.jsx("option",{value:"informational",children:"informational"})]})}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:s.title,onChange:l=>r(s.id,{title:l.target.value})})}),d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:s.url,onChange:l=>r(s.id,{url:l.target.value}),placeholder:"https:// (optional)"})}),d.jsx(j,{label:"Safety recommendation / summary",children:d.jsx("textarea",{style:{...ne,minHeight:90},value:s.summary,onChange:l=>r(s.id,{summary:l.target.value})})})]},s.id))]})]})}function WC({block:t,upd:e}){const n=S.useRef(null);return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Image URL",children:d.jsx("input",{style:D,value:t.url,onChange:r=>e({url:r.target.value}),placeholder:"https://"})}),d.jsxs(j,{label:"Upload Image",children:[d.jsx("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:t.dataUrl?" Image uploaded  click to replace":"Click to upload image"}),d.jsx("input",{ref:n,type:"file",accept:"image/*",style:{display:"none"},onChange:r=>{var s;const i=(s=r.target.files)==null?void 0:s[0];if(!i)return;const o=new FileReader;o.onload=l=>{var a;return e({dataUrl:(a=l.target)==null?void 0:a.result})},o.readAsDataURL(i)}})]}),(t.dataUrl||t.url)&&d.jsx("div",{style:{marginBottom:14,padding:8,background:"var(--color-bg)",borderRadius:8,textAlign:"center"},children:d.jsx("img",{src:t.dataUrl||t.url,alt:"Preview",style:{maxHeight:120,maxWidth:"100%",borderRadius:6}})}),d.jsx(j,{label:"Alt Text",children:d.jsx("input",{style:D,value:t.alt,onChange:r=>e({alt:r.target.value})})}),d.jsx(j,{label:"Caption",children:d.jsx("input",{style:D,value:t.caption,onChange:r=>e({caption:r.target.value})})}),d.jsxs("details",{style:{marginTop:6},children:[d.jsx("summary",{style:{cursor:"pointer",fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.12em",textTransform:"uppercase"},children:"Links / URLs"}),d.jsx("div",{style:{marginTop:10},children:d.jsx(j,{label:"Link URL",children:d.jsx("input",{style:D,value:t.linkUrl,onChange:r=>e({linkUrl:r.target.value}),placeholder:"https://"})})})]}),d.jsx(j,{label:"Width",children:d.jsxs("select",{style:D,value:t.width,onChange:r=>e({width:r.target.value}),children:[d.jsx("option",{value:"full",children:"Full width"}),d.jsx("option",{value:"wide",children:"Wide (80%)"}),d.jsx("option",{value:"medium",children:"Medium (60%)"}),d.jsx("option",{value:"small",children:"Small (40%)"})]})}),d.jsx(j,{label:"Alignment",children:d.jsxs("select",{style:D,value:t.alignment,onChange:r=>e({alignment:r.target.value}),children:[d.jsx("option",{value:"left",children:"Left"}),d.jsx("option",{value:"center",children:"Center"}),d.jsx("option",{value:"right",children:"Right"})]})}),d.jsxs(j,{label:"Border Radius",children:[d.jsx("input",{type:"range",min:0,max:32,value:t.borderRadius,onChange:r=>e({borderRadius:Number(r.target.value)}),style:{width:"100%",accentColor:"var(--color-accent)"}}),d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:11,color:"var(--color-muted)"},children:[t.borderRadius,"px"]})]})]})}function KC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Content (HTML)",hint:"Supports <strong>, <em>, <a>, <ul>, <ol>, <h3>, etc.",children:d.jsx("textarea",{style:{...ne,minHeight:200,fontFamily:"var(--font-mono)",fontSize:12},value:t.html,onChange:n=>e({html:n.target.value})})}),d.jsx(j,{label:"Alignment",children:d.jsxs("select",{style:D,value:t.alignment,onChange:n=>e({alignment:n.target.value}),children:[d.jsx("option",{value:"left",children:"Left"}),d.jsx("option",{value:"center",children:"Center"}),d.jsx("option",{value:"right",children:"Right"})]})}),d.jsx(j,{label:"Max Width",children:d.jsxs("select",{style:D,value:t.maxWidth,onChange:n=>e({maxWidth:n.target.value}),children:[d.jsx("option",{value:"full",children:"Full"}),d.jsx("option",{value:"reading",children:"Reading (720px)"}),d.jsx("option",{value:"narrow",children:"Narrow (560px)"})]})})]})}function qC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Label",children:d.jsx("input",{style:D,value:t.label,onChange:n=>e({label:n.target.value})})}),d.jsx(j,{label:"HTML Source",hint:"Inline styles are safe. Scripts are not supported.",children:d.jsx("textarea",{style:{...ne,minHeight:240,fontFamily:"var(--font-mono)",fontSize:12},value:t.html,onChange:n=>e({html:n.target.value})})})]})}function JC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:n=>e({heading:n.target.value})})}),d.jsx(j,{label:"Step Label",children:d.jsx("input",{style:D,value:t.step,onChange:n=>e({step:n.target.value})})}),d.jsx(j,{label:"Framework",children:d.jsx("input",{style:D,value:t.framework,onChange:n=>e({framework:n.target.value})})}),d.jsx(j,{label:"Bad Prompt",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:t.badPrompt,onChange:n=>e({badPrompt:n.target.value})})}),d.jsx(j,{label:"Good Prompt",children:d.jsx("textarea",{style:{...ne,minHeight:120},value:t.goodPrompt,onChange:n=>e({goodPrompt:n.target.value})})}),d.jsx(j,{label:"Explanation",children:d.jsx("textarea",{style:ne,value:t.explanation,onChange:n=>e({explanation:n.target.value})})})]})}function GC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:n=>e({heading:n.target.value})})}),(t.steps||[]).map((n,r)=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:10,marginBottom:10},children:[d.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:11,color:"var(--color-muted)",marginBottom:8},children:[n.letter,"  ",n.name]}),d.jsx(j,{label:"Description",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:n.description,onChange:i=>{const o=[...t.steps];o[r]={...n,description:i.target.value},e({steps:o})}})}),d.jsx(j,{label:"Example",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:n.example,onChange:i=>{const o=[...t.steps];o[r]={...n,example:i.target.value},e({steps:o})}})})]},n.letter))]})}function YC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:n=>e({heading:n.target.value})})}),d.jsx(j,{label:"Prompt",hint:"Plain text. Rendered as a collapsible, copyable <pre> in the newsletter.",children:d.jsx("textarea",{style:{...ne,minHeight:220,fontFamily:"var(--font-mono)",fontSize:12},value:t.prompt,onChange:n=>e({prompt:n.target.value})})})]})}const qd=["Always verify AI-generated clinical reasoning against primary sources before acting.","Never submit patient-identifiable information (PHI) to consumer AI tools  use only approved institutional platforms.","AI supports clinical judgment; it does not replace it. Final decisions remain with the treating clinician.","Document AI tool use in the medical record where institutional policy requires it."];function QC({block:t,upd:e}){const n=Array.isArray(t.items)?t.items:[],r=(s,l)=>{const a=l?Array.from(new Set([...n,s])):n.filter(c=>c!==s);e({items:a})},i=s=>{const l=s.split(`
`).map(c=>c.trim()).filter(Boolean),a=qd.filter(c=>n.includes(c));e({items:[...a,...l]})},o=n.filter(s=>!qd.includes(s));return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:s=>e({heading:s.target.value})})}),d.jsx(j,{label:"Standard reminders",hint:"Choose 14 defaults, then optionally add custom lines below.",children:d.jsx("div",{style:{display:"grid",gap:8},children:qd.map(s=>d.jsxs("label",{style:{display:"flex",gap:10,alignItems:"flex-start",fontFamily:"var(--font-body)",fontSize:13,cursor:"pointer"},children:[d.jsx("input",{type:"checkbox",checked:n.includes(s),onChange:l=>r(s,l.target.checked),style:{accentColor:"var(--color-accent)",marginTop:2}}),d.jsx("span",{style:{color:"var(--color-text)",lineHeight:1.45},children:s})]},s))})}),d.jsx(j,{label:"Custom reminders",hint:"One per line. These are added in addition to checked defaults.",children:d.jsx("textarea",{style:{...ne,minHeight:140,fontFamily:"var(--font-body)",fontSize:13},value:o.join(`
`),onChange:s=>i(s.target.value),placeholder:"Add your own reminder lines"})})]})}function XC({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Term",children:d.jsx("input",{style:D,value:t.term,onChange:n=>e({term:n.target.value})})}),d.jsx(j,{label:"Definition",children:d.jsx("textarea",{style:ne,value:t.definition,onChange:n=>e({definition:n.target.value})})}),d.jsx(j,{label:"Relevance to Medicine",children:d.jsx("textarea",{style:ne,value:t.relevance,onChange:n=>e({relevance:n.target.value})})}),d.jsx(j,{label:"Clinical Application",children:d.jsx("textarea",{style:ne,value:t.clinicalApplication,onChange:n=>e({clinicalApplication:n.target.value})})}),d.jsx(j,{label:"Related Terms",hint:"Comma-separated",children:d.jsx("input",{style:D,value:(t.relatedTerms||[]).join(", "),onChange:n=>e({relatedTerms:n.target.value.split(",").map(r=>r.trim()).filter(Boolean)})})})]})}function ZC({block:t,upd:e,onAddHit:n,onUpdateHit:r,onDeleteHit:i}){var o;return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:s=>e({heading:s.target.value})})}),d.jsxs("div",{style:{marginTop:12},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.12em",textTransform:"uppercase"},children:[((o=t.hits)==null?void 0:o.length)||0," Hits"]}),d.jsxs("button",{onClick:n,style:{display:"flex",alignItems:"center",gap:4,padding:"5px 10px",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:11})," Add Hit"]})]}),(t.hits||[]).map(s=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:10,marginBottom:10},children:[d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:8},children:d.jsx("button",{onClick:()=>i(s.id),style:{background:"none",border:"none",cursor:"pointer",color:"#C0392B"},children:d.jsx(wo,{size:13})})}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:s.title,onChange:l=>r(s.id,{title:l.target.value})})}),d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:s.url,onChange:l=>r(s.id,{url:l.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Source",children:d.jsx("input",{style:D,value:s.source,onChange:l=>r(s.id,{source:l.target.value})})}),d.jsx(j,{label:"Summary",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:s.summary,onChange:l=>r(s.id,{summary:l.target.value})})})]},s.id))]})]})}function eE({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:`Height: ${t.height}px`,children:d.jsx("input",{type:"range",min:8,max:200,value:t.height,onChange:n=>e({height:Number(n.target.value)}),style:{width:"100%"}})}),d.jsx(j,{label:"Show Divider Line",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontFamily:"var(--font-body)",fontSize:13,cursor:"pointer"},children:[d.jsx("input",{type:"checkbox",checked:!!t.showLine,onChange:n=>e({showLine:n.target.checked}),style:{accentColor:"var(--color-accent)"}}),"Show divider line"]})}),t.showLine&&d.jsx(j,{label:"Line Style",children:d.jsxs("select",{style:D,value:t.lineStyle,onChange:n=>e({lineStyle:n.target.value}),children:[d.jsx("option",{value:"solid",children:"Solid"}),d.jsx("option",{value:"dashed",children:"Dashed"}),d.jsx("option",{value:"dotted",children:"Dotted"})]})})]})}function tE({block:t,upd:e}){return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Institution",children:d.jsx("input",{style:D,value:t.institution,onChange:n=>e({institution:n.target.value})})}),d.jsx(j,{label:"Department",children:d.jsx("input",{style:D,value:t.department,onChange:n=>e({department:n.target.value})})}),d.jsx(j,{label:"Editors",children:d.jsx("input",{style:D,value:t.editors,onChange:n=>e({editors:n.target.value})})}),d.jsx(j,{label:"Contact Email",children:d.jsx("input",{style:D,type:"email",value:t.contactEmail,onChange:n=>e({contactEmail:n.target.value})})}),d.jsx(j,{label:"Website URL",children:d.jsx("input",{style:D,value:t.websiteUrl,onChange:n=>e({websiteUrl:n.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Subscribe URL",children:d.jsx("input",{style:D,value:t.subscribeUrl,onChange:n=>e({subscribeUrl:n.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Unsubscribe URL",children:d.jsx("input",{style:D,value:t.unsubscribeUrl,onChange:n=>e({unsubscribeUrl:n.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Copyright Year",children:d.jsx("input",{style:D,value:t.copyrightYear,onChange:n=>e({copyrightYear:n.target.value})})}),d.jsx(j,{label:"Disclaimer",children:d.jsx("textarea",{style:ne,value:t.disclaimer,onChange:n=>e({disclaimer:n.target.value})})}),d.jsx(j,{label:"Next Issue Date",children:d.jsx("input",{style:D,value:t.nextIssueDate,onChange:n=>e({nextIssueDate:n.target.value})})}),d.jsx(j,{label:"Next Issue Teaser",children:d.jsx("input",{style:D,value:t.nextIssueTeaser,onChange:n=>e({nextIssueTeaser:n.target.value})})})]})}function nE({block:t,upd:e}){const n=S.useRef(null);return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:r=>e({heading:r.target.value})})}),d.jsx(j,{label:"Emoji Decoration",children:d.jsx("input",{style:D,value:t.emojiDecor,onChange:r=>e({emojiDecor:r.target.value}),placeholder:"  "})}),d.jsx(j,{label:"Content",children:d.jsx("textarea",{style:{...ne,minHeight:120},value:t.content,onChange:r=>e({content:r.target.value})})}),d.jsx(j,{label:"Attribution",children:d.jsx("input",{style:D,value:t.attribution,onChange:r=>e({attribution:r.target.value})})}),d.jsx(j,{label:"Source URL (optional)",children:d.jsx("input",{style:D,value:t.sourceUrl||"",onChange:r=>e({sourceUrl:r.target.value}),placeholder:"https://"})}),d.jsx(j,{label:"Image URL (optional)",children:d.jsx("input",{style:D,value:t.imageUrl||"",onChange:r=>e({imageUrl:r.target.value}),placeholder:"https://"})}),d.jsxs(j,{label:"Upload Image",children:[d.jsx("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:t.imageDataUrl?" Uploaded  click to replace":"Click to upload image"}),d.jsx("input",{ref:n,type:"file",accept:"image/*",style:{display:"none"},onChange:r=>{var s;const i=(s=r.target.files)==null?void 0:s[0];if(!i)return;const o=new FileReader;o.onload=l=>{var a;return e({imageDataUrl:(a=l.target)==null?void 0:a.result})},o.readAsDataURL(i)}}),(t.imageDataUrl||t.imageUrl)&&d.jsx("div",{style:{marginTop:8},children:d.jsx("img",{src:t.imageDataUrl||t.imageUrl,alt:"Preview",style:{maxHeight:100,maxWidth:"100%",borderRadius:8}})})]}),(t.imageDataUrl||t.imageUrl)&&d.jsxs(d.Fragment,{children:[d.jsxs(j,{label:"Image Height",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("input",{type:"range",min:80,max:600,step:20,value:t.imageHeight||300,onChange:r=>e({imageHeight:Number(r.target.value)}),style:{flex:1,accentColor:"var(--color-accent)"}}),d.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:11,color:"var(--color-muted)",minWidth:44},children:t.imageHeight?`${t.imageHeight}px`:"Auto"})]}),d.jsx("button",{onClick:()=>e({imageHeight:void 0}),style:{...D,marginTop:4,cursor:"pointer",textAlign:"center",fontSize:11,color:"var(--color-muted)"},children:"Reset to Auto (show full image)"})]}),d.jsx(j,{label:"Image Fit",children:d.jsxs("select",{style:D,value:t.imageFit||"contain",onChange:r=>e({imageFit:r.target.value}),children:[d.jsx("option",{value:"contain",children:"Fit  show entire image"}),d.jsx("option",{value:"cover",children:"Fill  crop to fit height"}),d.jsx("option",{value:"fill",children:"Stretch  fill exactly"})]})})]})]})}function rE({block:t,upd:e}){const n=S.useRef(null);return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Year",children:d.jsx("input",{style:D,value:t.year,onChange:r=>e({year:r.target.value})})}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:t.title,onChange:r=>e({title:r.target.value})})}),d.jsx(j,{label:"Content",children:d.jsx("textarea",{style:{...ne,minHeight:140},value:t.content,onChange:r=>e({content:r.target.value})})}),d.jsx(j,{label:"Significance",children:d.jsx("textarea",{style:ne,value:t.significance,onChange:r=>e({significance:r.target.value})})}),d.jsx(j,{label:"Source URL",children:d.jsx("input",{style:D,value:t.sourceUrl||"",onChange:r=>e({sourceUrl:r.target.value}),placeholder:"https://doi.org/"})}),d.jsx(j,{label:"Source Label",children:d.jsx("input",{style:D,value:t.sourceLabel||"",onChange:r=>e({sourceLabel:r.target.value}),placeholder:"Author, Year  Journal"})}),d.jsx(j,{label:"Image URL (optional)",children:d.jsx("input",{style:D,value:t.imageUrl||"",onChange:r=>e({imageUrl:r.target.value}),placeholder:"https://"})}),d.jsxs(j,{label:"Upload Image",children:[d.jsx("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:t.imageDataUrl?" Uploaded  click to replace":"Click to upload image"}),d.jsx("input",{ref:n,type:"file",accept:"image/*",style:{display:"none"},onChange:r=>{var s;const i=(s=r.target.files)==null?void 0:s[0];if(!i)return;const o=new FileReader;o.onload=l=>{var a;return e({imageDataUrl:(a=l.target)==null?void 0:a.result})},o.readAsDataURL(i)}}),(t.imageDataUrl||t.imageUrl)&&d.jsx("div",{style:{marginTop:8},children:d.jsx("img",{src:t.imageDataUrl||t.imageUrl,alt:"Preview",style:{maxHeight:100,maxWidth:"100%",borderRadius:8}})})]})]})}function iE({block:t,upd:e}){const n=t.links||[],r=t.items||[],[i,o]=S.useState((t.rssUrls||[]).join(`
`));return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Source",children:d.jsxs("select",{style:D,value:t.sourceMode||"manual",onChange:s=>e({sourceMode:s.target.value}),children:[d.jsx("option",{value:"manual",children:"Manual"}),d.jsx("option",{value:"rss",children:"RSS feeds"})]})}),t.sourceMode==="rss"&&d.jsxs("details",{style:{marginTop:6},children:[d.jsx("summary",{style:{cursor:"pointer",fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase",letterSpacing:"0.12em"},children:"RSS settings"}),d.jsxs("div",{style:{marginTop:10},children:[d.jsx(j,{label:"Quick add from presets",hint:"Select a preset to append it to your RSS list. You can still edit/remove URLs below.",children:d.jsxs("select",{style:D,defaultValue:"",onChange:s=>{const l=s.target.value;if(!l)return;const a=Pa.find(u=>u.id===l);if(!a)return;const c=(t.rssUrls||[]).map(u=>u.trim()).filter(Boolean);if(!c.includes(a.url)){const u=[...c,a.url];o(u.join(`
`)),e({rssUrls:u})}s.currentTarget.value=""},children:[d.jsx("option",{value:"",children:" Choose a feed "}),Pa.map(s=>d.jsx("option",{value:s.id,children:s.label},s.id))]})}),d.jsx(j,{label:"RSS URLs (one per line)",children:d.jsx("textarea",{style:{...ne,minHeight:110},value:i,onChange:s=>o(s.target.value),onBlur:()=>{const s=i.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);e({rssUrls:s})},placeholder:"https:///rss.xml\\nhttps:///feed"})}),d.jsx(j,{label:"Max RSS items",children:d.jsx("input",{style:D,type:"number",min:5,max:100,value:t.rssMaxItems??20,onChange:s=>e({rssMaxItems:Number(s.target.value)||20})})}),d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-muted)"},children:"The ticker will aggregate titles across feeds and render them as clickable links."})]})]}),d.jsx(j,{label:"Speed",children:d.jsxs("select",{style:D,value:t.speed,onChange:s=>e({speed:s.target.value}),children:[d.jsx("option",{value:"slow",children:"Slow"}),d.jsx("option",{value:"medium",children:"Medium"}),d.jsx("option",{value:"fast",children:"Fast"})]})}),d.jsx(j,{label:"Background Color",children:d.jsx("input",{type:"color",value:t.backgroundColor||"#003087",onChange:s=>e({backgroundColor:s.target.value})})}),d.jsx(j,{label:"Text Color",children:d.jsx("input",{type:"color",value:t.textColor||"#ffffff",onChange:s=>e({textColor:s.target.value})})}),t.sourceMode!=="rss"&&d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Mode",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontFamily:"var(--font-body)",fontSize:13,cursor:"pointer",marginBottom:8},children:[d.jsx("input",{type:"checkbox",checked:!!t.useLinks,onChange:s=>e({useLinks:s.target.checked}),style:{accentColor:"var(--color-accent)"}}),"Use clickable linked headlines"]})}),t.useLinks?d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase",letterSpacing:"0.12em"},children:[n.length," Linked Items"]}),d.jsxs("button",{onClick:()=>e({links:[...n,{text:"New headline",url:""}]}),style:{display:"flex",alignItems:"center",gap:4,padding:"4px 10px",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:10})," Add"]})]}),n.map((s,l)=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:10,marginBottom:8},children:[d.jsx(j,{label:"Headline",children:d.jsx("input",{style:D,value:s.text,onChange:a=>{const c=[...n];c[l]={...s,text:a.target.value},e({links:c})}})}),d.jsxs("details",{children:[d.jsx("summary",{style:{cursor:"pointer",fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase",letterSpacing:"0.12em"},children:"URL"}),d.jsx("div",{style:{marginTop:10},children:d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:s.url,onChange:a=>{const c=[...n];c[l]={...s,url:a.target.value},e({links:c})},placeholder:"https://"})})})]}),d.jsxs("button",{onClick:()=>e({links:n.filter((a,c)=>c!==l)}),style:{background:"none",border:"none",color:"#C0392B",fontSize:12,cursor:"pointer",fontFamily:"var(--font-body)",padding:0,display:"flex",alignItems:"center",gap:4},children:[d.jsx(wo,{size:11})," Remove"]})]},l))]}):d.jsx(j,{label:`Plain Text Items (${r.length})`,hint:"One headline per line",children:d.jsx("textarea",{style:{...ne,minHeight:120},value:r.join(`
`),onChange:s=>e({items:s.target.value.split(`
`).filter(l=>l.trim())})})})]})]})}function oE({block:t,upd:e}){const n=S.useRef({}),r=t.items||[];return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:i=>e({heading:i.target.value})})}),d.jsx(j,{label:"Subheading",children:d.jsx("input",{style:D,value:t.subheading,onChange:i=>e({subheading:i.target.value})})}),d.jsx(j,{label:"Institution Label",children:d.jsx("input",{style:D,value:t.institutionLabel||"",onChange:i=>e({institutionLabel:i.target.value}),placeholder:"e.g. Northwell Health, Mayo Clinic"})}),d.jsx(j,{label:"Max Items (16)",children:d.jsx("input",{style:D,type:"number",min:1,max:6,value:t.maxItems||6,onChange:i=>e({maxItems:Number(i.target.value)})})}),d.jsxs("div",{style:{marginTop:16},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase",letterSpacing:"0.12em"},children:[r.length," Items"]}),d.jsxs("button",{onClick:()=>e({items:[...r,{id:String(Date.now()),title:"New Item",url:"",pubDate:new Date().toISOString(),summary:"",imageUrl:"",category:"Innovation"}]}),style:{display:"flex",alignItems:"center",gap:4,padding:"5px 10px",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:11})," Add Item"]})]}),r.map((i,o)=>{var s;return d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:12,marginBottom:12},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase"},children:["Item ",o+1]}),d.jsxs("button",{onClick:()=>e({items:r.filter((l,a)=>a!==o)}),style:{background:"#FEF0EE",border:"1px solid #f5c6c0",borderRadius:5,color:"#7A1E12",cursor:"pointer",padding:"3px 8px",fontSize:11,display:"flex",alignItems:"center",gap:4},children:[d.jsx(wo,{size:11})," Delete"]})]}),d.jsx(j,{label:"Category",children:d.jsx("input",{style:D,value:i.category,onChange:l=>{const a=[...r];a[o]={...i,category:l.target.value},e({items:a})}})}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:i.title,onChange:l=>{const a=[...r];a[o]={...i,title:l.target.value},e({items:a})}})}),d.jsx(j,{label:"URL",children:d.jsx("input",{style:D,value:i.url,onChange:l=>{const a=[...r];a[o]={...i,url:l.target.value},e({items:a})},placeholder:"https://"})}),d.jsx(j,{label:"Summary",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:i.summary,onChange:l=>{const a=[...r];a[o]={...i,summary:l.target.value},e({items:a})}})}),d.jsx(j,{label:"Image URL",children:d.jsx("input",{style:D,value:i.imageUrl,onChange:l=>{const a=[...r];a[o]={...i,imageUrl:l.target.value},e({items:a})},placeholder:"https://"})}),d.jsxs(j,{label:"Upload Image",children:[d.jsx("button",{onClick:()=>{var l;return(l=n.current[o])==null?void 0:l.click()},style:{...D,cursor:"pointer",textAlign:"center",color:"var(--color-muted)"},children:"Upload image"}),d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},ref:l=>{n.current[o]=l},onChange:l=>{var u;const a=(u=l.target.files)==null?void 0:u[0];if(!a)return;const c=new FileReader;c.onload=f=>{var h;const p=[...r];p[o]={...i,imageUrl:(h=f.target)==null?void 0:h.result},e({items:p})},c.readAsDataURL(a)}})]}),d.jsx(j,{label:"Pub Date",children:d.jsx("input",{style:D,type:"date",value:((s=i.pubDate)==null?void 0:s.split("T")[0])||"",onChange:l=>{const a=[...r];a[o]={...i,pubDate:l.target.value},e({items:a})}})})]},i.id)})]})]})}function sE({block:t,upd:e}){const[n,r]=ee.useState(!1),[i,o]=ee.useState(""),s="https://api.allorigins.win/get?url=",l=async()=>{var f,p,h,m,g,v,y,x;r(!0),o("");const a=[];for(const b of t.feedUrls||[])try{const C=await(await fetch(s+encodeURIComponent(b))).json(),E=C&&typeof C.contents=="string"?C.contents:"",M=new DOMParser().parseFromString(E,"text/xml"),$=((p=(f=M.querySelector("channel > title"))==null?void 0:f.textContent)==null?void 0:p.trim())||b;for(const O of Array.from(M.querySelectorAll("item")).slice(0,10))a.push({title:((m=(h=O.querySelector("title"))==null?void 0:h.textContent)==null?void 0:m.trim())||"",url:((v=(g=O.querySelector("link"))==null?void 0:g.textContent)==null?void 0:v.trim())||"",source:$,pubDate:((x=(y=O.querySelector("pubDate"))==null?void 0:y.textContent)==null?void 0:x.trim())||""})}catch{o(`Failed to fetch: ${b}`)}const c=new Set,u=a.filter(b=>!b.url||c.has(b.url)?!1:(c.add(b.url),!0));u.sort((b,w)=>(Date.parse(w.pubDate)||0)-(Date.parse(b.pubDate)||0)),e({items:u.slice(0,t.maxItems||15),lastFetched:new Date().toISOString()}),r(!1)};return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:a=>e({heading:a.target.value})})}),d.jsx(j,{label:"Max Items (320)",children:d.jsx("input",{style:D,type:"number",min:3,max:20,value:t.maxItems||8,onChange:a=>e({maxItems:Number(a.target.value)})})}),d.jsx(j,{label:"Scrolling",hint:"If off, the RSS box will expand to show all items (recommended for export).",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontFamily:"var(--font-body)",fontSize:13,cursor:"pointer"},children:[d.jsx("input",{type:"checkbox",checked:!!t.enableScroll,onChange:a=>e({enableScroll:a.target.checked}),style:{accentColor:"var(--color-accent)"}}),"Enable internal scroll (fixed height)"]})}),d.jsx(j,{label:"Quick add from presets",hint:"Append a known-working feed URL.",children:d.jsxs("select",{style:D,defaultValue:"",onChange:a=>{const c=a.target.value;if(!c)return;const u=Pa.find(p=>p.id===c);if(!u)return;const f=(t.feedUrls||[]).map(p=>p.trim()).filter(Boolean);f.includes(u.url)||e({feedUrls:[...f,u.url]}),a.currentTarget.value=""},children:[d.jsx("option",{value:"",children:" Choose a feed "}),Pa.map(a=>d.jsx("option",{value:a.id,children:a.label},a.id))]})}),d.jsx(j,{label:`RSS Feed URLs (${(t.feedUrls||[]).length})`,hint:"One URL per line",children:d.jsx("textarea",{style:{...ne,minHeight:120,fontFamily:"var(--font-mono)",fontSize:11},value:(t.feedUrls||[]).join(`
`),onChange:a=>e({feedUrls:a.target.value.split(`
`).map(c=>c.trim()).filter(Boolean)})})}),d.jsx("button",{onClick:l,disabled:n,style:{width:"100%",padding:"9px 0",background:n?"var(--color-muted)":"var(--color-accent)",border:"none",borderRadius:8,color:"#fff",fontSize:13,fontFamily:"var(--font-body)",cursor:n?"not-allowed":"pointer",marginBottom:8},children:n?" Fetching":` Refresh Feed (${(t.items||[]).length} items loaded)`}),i&&d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:11,color:"#C0392B",marginBottom:8},children:i}),t.lastFetched&&d.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textAlign:"center"},children:["Last fetched: ",new Date(t.lastFetched).toLocaleString()]})]})}function lE({block:t,upd:e}){const n=t.templates||[];return d.jsxs(d.Fragment,{children:[d.jsx(j,{label:"Heading",children:d.jsx("input",{style:D,value:t.heading,onChange:r=>e({heading:r.target.value})})}),d.jsx(j,{label:"Description",children:d.jsx("textarea",{style:{...ne,minHeight:60},value:t.description,onChange:r=>e({description:r.target.value})})}),d.jsxs("div",{style:{marginTop:12},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase",letterSpacing:"0.12em"},children:[n.length," Templates"]}),d.jsxs("button",{onClick:()=>e({templates:[...n,{id:String(Date.now()),category:"General",title:"New Template",prompt:"Act as a [ROLE]. [TASK]. [CONSTRAINTS].",useCase:"Use case"}]}),style:{display:"flex",alignItems:"center",gap:4,padding:"5px 10px",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(Pr,{size:11})," Add Template"]})]}),n.map((r,i)=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:12,marginBottom:12,background:"var(--color-background)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",textTransform:"uppercase"},children:["Template ",i+1]}),d.jsxs("button",{onClick:()=>e({templates:n.filter((o,s)=>s!==i)}),style:{background:"#FEF0EE",border:"1px solid #f5c6c0",borderRadius:5,color:"#7A1E12",cursor:"pointer",padding:"3px 8px",fontSize:11,display:"flex",alignItems:"center",gap:4},children:[d.jsx(wo,{size:11})," Delete"]})]}),d.jsx(j,{label:"Category",children:d.jsx("input",{style:D,value:r.category,onChange:o=>{const s=[...n];s[i]={...r,category:o.target.value},e({templates:s})}})}),d.jsx(j,{label:"Title",children:d.jsx("input",{style:D,value:r.title,onChange:o=>{const s=[...n];s[i]={...r,title:o.target.value},e({templates:s})}})}),d.jsx(j,{label:"Use Case",children:d.jsx("input",{style:D,value:r.useCase,onChange:o=>{const s=[...n];s[i]={...r,useCase:o.target.value},e({templates:s})}})}),d.jsx(j,{label:"Prompt",hint:"Use [BRACKETS] for fill-in variables",children:d.jsx("textarea",{style:{...ne,minHeight:180,fontFamily:"var(--font-mono)",fontSize:11},value:r.prompt,onChange:o=>{const s=[...n];s[i]={...r,prompt:o.target.value},e({templates:s})}})})]},r.id))]})]})}const aE=[{id:"blocks",icon:d.jsx(w2,{size:16}),label:"Blocks"},{id:"settings",icon:d.jsx(R1,{size:16}),label:"Settings"},{id:"rss",icon:d.jsx(D2,{size:16}),label:"RSS"},{id:"theme",icon:d.jsx(M2,{size:16}),label:"Theme"},{id:"export",icon:d.jsx(I1,{size:16}),label:"Versions"}],cE=[{label:"Structure",types:["header","ticker","section-divider","spacer","footer"]},{label:"Content",types:["article-grid","spotlight","ethics-split","quick-hits","text","image","html-embed"]},{label:"Clinical AI Skills",types:["prompt-masterclass","sbar-prompt","prompt-template","safety-reminders","clinical-prompt-templates","term-of-month","ai-case-file"]},{label:"Safety & Institutional",types:["ai-safety","institutional-spotlight","rss-sidebar","humor"]}];function dE(t){const{newsletter:e,editorState:n,isMobile:r,isTablet:i,drawerOpen:o,onCloseDrawer:s,rss:l,versions:a,onSetPanel:c}=t,{activePanel:u,selectedBlockId:f}=n,p=f?e.blocks[f]:null,h=r||i,m=d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--color-border)",background:"var(--color-bg)",flexShrink:0},children:[aE.map(g=>d.jsxs("button",{onClick:()=>c(g.id),title:g.label,style:{flex:1,padding:"10px 4px",display:"flex",flexDirection:"column",alignItems:"center",gap:3,background:"none",border:"none",cursor:"pointer",color:u===g.id?"var(--color-accent)":"var(--color-muted)",borderBottom:u===g.id?"2px solid var(--color-accent)":"2px solid transparent",fontSize:10,fontFamily:"var(--font-body)",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",transition:"all 0.15s"},children:[g.icon,d.jsx("span",{children:g.label})]},g.id)),h&&d.jsx("button",{onClick:s,style:{padding:"10px 12px",background:"none",border:"none",cursor:"pointer",color:"var(--color-muted)",display:"flex",alignItems:"center"},children:d.jsx(Gc,{size:16})})]}),d.jsxs("div",{style:{flex:1,overflowY:"auto"},children:[u==="blocks"&&(p?d.jsx(PC,{block:p,newsletter:e,onClose:()=>{t.onSelectBlock(null),h&&s()},onUpdateBlock:t.onUpdateBlock,onAddArticle:t.onAddArticle,onUpdateArticle:t.onUpdateArticle,onDeleteArticle:t.onDeleteArticle,onAddQuickHit:t.onAddQuickHit,onUpdateQuickHit:t.onUpdateQuickHit,onDeleteQuickHit:t.onDeleteQuickHit}):d.jsx(uE,{onAddBlock:g=>{t.onAddBlock(g),h&&s()}})),u==="settings"&&d.jsx(fE,{newsletter:e,onUpdateMeta:()=>{}}),u==="rss"&&d.jsx(pE,{rss:l,onAddToNewsletter:g=>{const v=e.blockOrder.find(y=>{var x;return((x=e.blocks[y])==null?void 0:x.type)==="article-grid"});v&&t.onAddArticle(v)}}),u==="theme"&&d.jsx(hE,{current:e.theme,onUpdateTheme:t.onUpdateTheme}),u==="export"&&d.jsx(mE,{versions:a,onRestore:t.onRestoreVersion,onDelete:t.onDeleteVersion})]})]});return h?r?o?d.jsx("div",{className:"nap-bottom-sheet",children:m}):null:d.jsx("div",{className:`nap-sidebar-drawer ${o?"open":""}`,style:{display:"flex",flexDirection:"column",background:"var(--color-surface)",borderRight:"1px solid var(--color-border)",overflow:"hidden",width:320},children:m}):d.jsx("div",{style:{width:320,flexShrink:0,display:"flex",flexDirection:"column",background:"var(--color-surface)",borderRight:"1px solid var(--color-border)",overflow:"hidden"},children:m})}function uE({onAddBlock:t}){return d.jsxs("div",{style:{padding:16},children:[d.jsxs("div",{style:{marginBottom:12},children:[d.jsx("h3",{style:{fontFamily:"var(--font-display)",fontSize:18,color:"var(--color-text)",margin:"0 0 4px"},children:"Add Block"}),d.jsx("p",{style:{fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-muted)",margin:0},children:"Click to add at the end. Select a block in the canvas to insert after it."})]}),cE.map(e=>d.jsxs("div",{style:{marginBottom:20},children:[d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:"var(--color-muted)",marginBottom:8,paddingBottom:6,borderBottom:"1px solid var(--color-border)"},children:e.label}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:e.types.map(n=>d.jsxs("button",{onClick:()=>t(n),style:{display:"flex",alignItems:"center",gap:10,padding:"9px 12px",background:"none",border:"1px solid var(--color-border)",borderRadius:8,cursor:"pointer",textAlign:"left",fontFamily:"var(--font-body)",fontSize:13,color:"var(--color-text)",transition:"all 0.12s"},onMouseEnter:r=>{r.currentTarget.style.background="var(--color-bg)",r.currentTarget.style.borderColor="var(--color-accent)"},onMouseLeave:r=>{r.currentTarget.style.background="none",r.currentTarget.style.borderColor="var(--color-border)"},children:[d.jsx("span",{style:{fontSize:16},children:Mf[n].split("  ")[0]}),d.jsx("span",{children:Mf[n].split("  ").slice(1).join("").trim()}),d.jsx(Pr,{size:12,style:{marginLeft:"auto",color:"var(--color-muted)",flexShrink:0}})]},n))})]},e.label))]})}function fE({newsletter:t,onUpdateMeta:e}){return d.jsxs("div",{style:{padding:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-display)",fontSize:18,color:"var(--color-text)",margin:"0 0 16px"},children:"Issue Settings"}),d.jsx(j,{label:"Issue Title",children:d.jsx("input",{style:D,defaultValue:t.meta.title,onBlur:n=>e({title:n.target.value})})}),d.jsx(j,{label:"Issue Number",children:d.jsx("input",{style:D,defaultValue:t.meta.issueNumber,onBlur:n=>e({issueNumber:n.target.value})})})]})}function pE({rss:t,onAddToNewsletter:e}){const[n,r]=S.useState(""),[i,o]=S.useState("");return d.jsxs("div",{style:{padding:16},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[d.jsx("h3",{style:{fontFamily:"var(--font-display)",fontSize:18,color:"var(--color-text)",margin:0},children:"RSS Feeds"}),d.jsxs("button",{onClick:t.refresh,disabled:t.loading,style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"var(--color-accent)",border:"none",borderRadius:8,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer",opacity:t.loading?.6:1},children:[d.jsx(T2,{size:12,style:{animation:t.loading?"spin 1s linear infinite":"none"}}),t.loading?"Refreshing":"Refresh"]})]}),d.jsx("div",{style:{marginBottom:16},children:t.feeds.map(s=>d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 0",borderBottom:"1px solid var(--color-border)"},children:[d.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>t.toggleFeed(s.url),style:{accentColor:"var(--color-accent)",flexShrink:0}}),d.jsx("span",{style:{flex:1,fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-text)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:s.url,children:s.label}),d.jsx("button",{onClick:()=>t.removeFeed(s.url),style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-muted)",padding:2,display:"flex",alignItems:"center"},children:d.jsx(Gc,{size:12})})]},s.url))}),d.jsxs("div",{style:{background:"var(--color-bg)",borderRadius:8,padding:12,marginBottom:16},children:[d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"var(--color-muted)",marginBottom:8},children:"Add Feed"}),d.jsx("input",{placeholder:"RSS URL",value:n,onChange:s=>r(s.target.value),style:{...D,marginBottom:6}}),d.jsx("input",{placeholder:"Label",value:i,onChange:s=>o(s.target.value),style:{...D,marginBottom:8}}),d.jsx("button",{onClick:()=>{n&&(t.addFeed(n,i||n),r(""),o(""))},style:{width:"100%",padding:"7px 0",background:"var(--color-primary)",border:"none",borderRadius:8,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:"+ Add Feed"})]}),t.items.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Filter articles",value:t.filter,onChange:s=>t.setFilter(s.target.value),style:{...D,marginBottom:12}}),t.errors.map((s,l)=>d.jsxs("div",{style:{background:"#FEF0EE",border:"1px solid #f5c6c0",borderRadius:8,padding:"8px 12px",marginBottom:8,fontFamily:"var(--font-body)",fontSize:12,color:"#7A1E12"},children:[" ",s]},l)),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.items.slice(0,30).map((s,l)=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:10,background:"var(--color-surface)"},children:[d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:12,fontWeight:600,color:"var(--color-text)",marginBottom:4,lineHeight:1.35},children:s.title}),d.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",marginBottom:6},children:[s.source,"  ",s.pubDate?new Date(s.pubDate).toLocaleDateString():""]}),d.jsxs("div",{style:{display:"flex",gap:6},children:[d.jsx("button",{onClick:()=>e(s),style:{flex:1,padding:"5px 0",background:"var(--color-accent)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontFamily:"var(--font-body)",cursor:"pointer"},children:"+ Add to Issue"}),s.link&&d.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",padding:"5px 8px",border:"1px solid var(--color-border)",borderRadius:6,color:"var(--color-muted)",fontSize:11},children:d.jsx(g2,{size:11})})]})]},l))})]}),t.items.length===0&&!t.loading&&d.jsx("div",{style:{textAlign:"center",padding:"32px 16px",color:"var(--color-muted)",fontFamily:"var(--font-body)",fontSize:13},children:"Press Refresh to load articles"})]})}function hE({current:t,onUpdateTheme:e}){return d.jsxs("div",{style:{padding:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-display)",fontSize:18,color:"var(--color-text)",margin:"0 0 16px"},children:"Theme"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:D1.map(n=>d.jsxs("button",{onClick:()=>e(n),style:{display:"flex",alignItems:"center",gap:12,padding:12,background:t.id===n.id?"var(--color-bg)":"var(--color-surface)",border:`2px solid ${t.id===n.id?"var(--color-accent)":"var(--color-border)"}`,borderRadius:10,cursor:"pointer",textAlign:"left"},children:[d.jsx("div",{style:{display:"flex",gap:3,flexShrink:0},children:[n.primary,n.accent,n.background,n.surface].map((r,i)=>d.jsx("div",{style:{width:14,height:14,background:r,borderRadius:3,border:"1px solid rgba(0,0,0,0.1)"}},i))}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:13,fontWeight:600,color:"var(--color-text)",marginBottom:2},children:n.name}),d.jsxs("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",letterSpacing:"0.08em"},children:[n.primary,"  ",n.accent]})]}),t.id===n.id&&d.jsx("div",{style:{marginLeft:"auto",width:8,height:8,background:"var(--color-accent)",borderRadius:"50%"}})]},n.id))}),d.jsxs("div",{style:{marginTop:20},children:[d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"var(--color-muted)",marginBottom:12},children:"Customize"}),[["Primary","primary"],["Accent","accent"],["Background","background"],["Surface","surface"]].map(([n,r])=>d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[d.jsx("input",{type:"color",value:String(t[r]),onChange:i=>e({...t,[r]:i.target.value}),style:{width:32,height:32,borderRadius:6,border:"1px solid var(--color-border)",padding:2,cursor:"pointer"}}),d.jsx("span",{style:{flex:1,fontFamily:"var(--font-body)",fontSize:13,color:"var(--color-text)"},children:n}),d.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:11,color:"var(--color-muted)"},children:String(t[r])})]},String(r)))]})]})}function mE({versions:t,onRestore:e,onDelete:n}){return d.jsxs("div",{style:{padding:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-display)",fontSize:18,color:"var(--color-text)",margin:"0 0 4px"},children:"Saved Versions"}),d.jsx("p",{style:{fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-muted)",margin:"0 0 16px"},children:"Up to 20 versions stored in browser."}),t.length===0?d.jsx("div",{style:{textAlign:"center",padding:"32px 16px",color:"var(--color-muted)",fontFamily:"var(--font-body)",fontSize:13},children:"No saved versions yet. Use Save Version in the toolbar."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.map(r=>d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,padding:12},children:[d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:13,fontWeight:600,color:"var(--color-text)",marginBottom:4},children:r.label}),d.jsx("div",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"var(--color-muted)",marginBottom:10},children:new Date(r.createdAt).toLocaleString()}),d.jsxs("div",{style:{display:"flex",gap:6},children:[d.jsxs("button",{onClick:()=>e(r),style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:6,padding:"6px 0",background:"var(--color-primary)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontFamily:"var(--font-body)",cursor:"pointer"},children:[d.jsx(j2,{size:11})," Restore"]}),d.jsx("button",{onClick:()=>{confirm("Delete this version?")&&n(r.id)},style:{padding:"6px 10px",background:"none",border:"1px solid var(--color-border)",borderRadius:6,color:"var(--color-muted)",cursor:"pointer",display:"flex",alignItems:"center"},children:d.jsx(wo,{size:12})})]})]},r.id))})]})}function j({label:t,children:e,hint:n}){return d.jsxs("div",{style:{marginBottom:14},children:[d.jsx("label",{style:{display:"block",fontFamily:"var(--font-mono)",fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"var(--color-muted)",marginBottom:6,fontWeight:500},children:t}),e,n&&d.jsx("div",{style:{fontFamily:"var(--font-body)",fontSize:11,color:"var(--color-muted)",marginTop:4},children:n})]})}const D={width:"100%",padding:"8px 10px",background:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:8,fontFamily:"var(--font-body)",fontSize:13,color:"var(--color-text)",outline:"none",boxSizing:"border-box"},ne={...D,minHeight:80,resize:"vertical",fontFamily:"var(--font-body)",lineHeight:1.5};function gE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return S.useMemo(()=>r=>{e.forEach(i=>i(r))},e)}const Yc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ko(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function ih(t){return"nodeType"in t}function Et(t){var e,n;return t?ko(t)?t:ih(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function oh(t){const{Document:e}=Et(t);return t instanceof e}function ll(t){return ko(t)?!1:t instanceof Et(t).HTMLElement}function F1(t){return t instanceof Et(t).SVGElement}function Co(t){return t?ko(t)?t.document:ih(t)?oh(t)?t:ll(t)||F1(t)?t.ownerDocument:document:document:document}const Tn=Yc?S.useLayoutEffect:S.useEffect;function sh(t){const e=S.useRef(t);return Tn(()=>{e.current=t}),S.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function yE(){const t=S.useRef(null),e=S.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=S.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Bs(t,e){e===void 0&&(e=[t]);const n=S.useRef(t);return Tn(()=>{n.current!==t&&(n.current=t)},e),n}function al(t,e){const n=S.useRef();return S.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function Fa(t){const e=sh(t),n=S.useRef(null),r=S.useCallback(i=>{i!==n.current&&(e==null||e(i,n.current)),n.current=i},[]);return[n,r]}function Tf(t){const e=S.useRef();return S.useEffect(()=>{e.current=t},[t]),e.current}let Jd={};function cl(t,e){return S.useMemo(()=>{if(e)return e;const n=Jd[t]==null?0:Jd[t]+1;return Jd[t]=n,t+"-"+n},[t,e])}function B1(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((o,s)=>{const l=Object.entries(s);for(const[a,c]of l){const u=o[a];u!=null&&(o[a]=u+t*c)}return o},{...e})}}const no=B1(1),Ba=B1(-1);function xE(t){return"clientX"in t&&"clientY"in t}function lh(t){if(!t)return!1;const{KeyboardEvent:e}=Et(t.target);return e&&t instanceof e}function vE(t){if(!t)return!1;const{TouchEvent:e}=Et(t.target);return e&&t instanceof e}function jf(t){if(vE(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return xE(t)?{x:t.clientX,y:t.clientY}:null}const _s=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[_s.Translate.toString(t),_s.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),Eg="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function bE(t){return t.matches(Eg)?t:t.querySelector(Eg)}const SE={display:"none"};function wE(t){let{id:e,value:n}=t;return ee.createElement("div",{id:e,style:SE},n)}function kE(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ee.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function CE(){const[t,e]=S.useState("");return{announce:S.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const _1=S.createContext(null);function EE(t){const e=S.useContext(_1);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function ME(){const[t]=S.useState(()=>new Set),e=S.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[S.useCallback(r=>{let{type:i,event:o}=r;t.forEach(s=>{var l;return(l=s[i])==null?void 0:l.call(s,o)})},[t]),e]}const TE={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},jE={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function DE(t){let{announcements:e=jE,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=TE}=t;const{announce:o,announcement:s}=CE(),l=cl("DndLiveRegion"),[a,c]=S.useState(!1);if(S.useEffect(()=>{c(!0)},[]),EE(S.useMemo(()=>({onDragStart(f){let{active:p}=f;o(e.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;e.onDragMove&&o(e.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;o(e.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;o(e.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;o(e.onDragCancel({active:p,over:h}))}}),[o,e])),!a)return null;const u=ee.createElement(ee.Fragment,null,ee.createElement(wE,{id:r,value:i.draggable}),ee.createElement(kE,{id:l,announcement:s}));return n?Qr.createPortal(u,n):u}var Ie;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ie||(Ie={}));function _a(){}function Mg(t,e){return S.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function AE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return S.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const pn=Object.freeze({x:0,y:0});function IE(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function RE(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function zE(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function $E(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function Tg(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const OE=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=Tg(e,e.left,e.top),o=[];for(const s of r){const{id:l}=s,a=n.get(l);if(a){const c=IE(Tg(a),i);o.push({id:l,data:{droppableContainer:s,value:c}})}}return o.sort(RE)};function NE(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height),s=i-r,l=o-n;if(r<i&&n<o){const a=e.width*e.height,c=t.width*t.height,u=s*l,f=u/(a+c-u);return Number(f.toFixed(4))}return 0}const LE=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=[];for(const o of r){const{id:s}=o,l=n.get(s);if(l){const a=NE(l,e);a>0&&i.push({id:s,data:{droppableContainer:o,value:a}})}}return i.sort(zE)};function PE(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function H1(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:pn}function FE(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.reduce((s,l)=>({...s,top:s.top+t*l.y,bottom:s.bottom+t*l.y,left:s.left+t*l.x,right:s.right+t*l.x}),{...n})}}const BE=FE(1);function _E(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function HE(t,e,n){const r=_E(e);if(!r)return t;const{scaleX:i,scaleY:o,x:s,y:l}=r,a=t.left-s-(1-i)*parseFloat(n),c=t.top-l-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),u=i?t.width/i:t.width,f=o?t.height/o:t.height;return{width:u,height:f,top:c,right:a+u,bottom:c+f,left:a}}const UE={ignoreTransform:!1};function Eo(t,e){e===void 0&&(e=UE);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:u}=Et(t).getComputedStyle(t);c&&(n=HE(n,c,u))}const{top:r,left:i,width:o,height:s,bottom:l,right:a}=n;return{top:r,left:i,width:o,height:s,bottom:l,right:a}}function jg(t){return Eo(t,{ignoreTransform:!0})}function VE(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function WE(t,e){return e===void 0&&(e=Et(t).getComputedStyle(t)),e.position==="fixed"}function KE(t,e){e===void 0&&(e=Et(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?n.test(o):!1})}function ah(t,e){const n=[];function r(i){if(e!=null&&n.length>=e||!i)return n;if(oh(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!ll(i)||F1(i)||n.includes(i))return n;const o=Et(t).getComputedStyle(i);return i!==t&&KE(i,o)&&n.push(i),WE(i,o)?n:r(i.parentNode)}return t?r(t):n}function U1(t){const[e]=ah(t,1);return e??null}function Gd(t){return!Yc||!t?null:ko(t)?t:ih(t)?oh(t)||t===Co(t).scrollingElement?window:ll(t)?t:null:null}function V1(t){return ko(t)?t.scrollX:t.scrollLeft}function W1(t){return ko(t)?t.scrollY:t.scrollTop}function Df(t){return{x:V1(t),y:W1(t)}}var Le;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Le||(Le={}));function K1(t){return!Yc||!t?!1:t===document.scrollingElement}function q1(t){const e={x:0,y:0},n=K1(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=e.y,o=t.scrollLeft<=e.x,s=t.scrollTop>=r.y,l=t.scrollLeft>=r.x;return{isTop:i,isLeft:o,isBottom:s,isRight:l,maxScroll:r,minScroll:e}}const qE={x:.2,y:.2};function JE(t,e,n,r,i){let{top:o,left:s,right:l,bottom:a}=n;r===void 0&&(r=10),i===void 0&&(i=qE);const{isTop:c,isBottom:u,isLeft:f,isRight:p}=q1(t),h={x:0,y:0},m={x:0,y:0},g={height:e.height*i.y,width:e.width*i.x};return!c&&o<=e.top+g.height?(h.y=Le.Backward,m.y=r*Math.abs((e.top+g.height-o)/g.height)):!u&&a>=e.bottom-g.height&&(h.y=Le.Forward,m.y=r*Math.abs((e.bottom-g.height-a)/g.height)),!p&&l>=e.right-g.width?(h.x=Le.Forward,m.x=r*Math.abs((e.right-g.width-l)/g.width)):!f&&s<=e.left+g.width&&(h.x=Le.Backward,m.x=r*Math.abs((e.left+g.width-s)/g.width)),{direction:h,speed:m}}function GE(t){if(t===document.scrollingElement){const{innerWidth:o,innerHeight:s}=window;return{top:0,left:0,right:o,bottom:s,width:o,height:s}}const{top:e,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function J1(t){return t.reduce((e,n)=>no(e,Df(n)),pn)}function YE(t){return t.reduce((e,n)=>e+V1(n),0)}function QE(t){return t.reduce((e,n)=>e+W1(n),0)}function XE(t,e){if(e===void 0&&(e=Eo),!t)return;const{top:n,left:r,bottom:i,right:o}=e(t);U1(t)&&(i<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const ZE=[["x",["left","right"],YE],["y",["top","bottom"],QE]];class ch{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ah(n),i=J1(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,s,l]of ZE)for(const a of s)Object.defineProperty(this,a,{get:()=>{const c=l(r),u=i[o]-c;return this.rect[a]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ss{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var i;(i=this.target)==null||i.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function eM(t){const{EventTarget:e}=Et(t);return t instanceof e?t:Co(t)}function Yd(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Ut;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Ut||(Ut={}));function Dg(t){t.preventDefault()}function tM(t){t.stopPropagation()}var re;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(re||(re={}));const G1={start:[re.Space,re.Enter],cancel:[re.Esc],end:[re.Space,re.Enter,re.Tab]},nM=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case re.Right:return{...n,x:n.x+25};case re.Left:return{...n,x:n.x-25};case re.Down:return{...n,y:n.y+25};case re.Up:return{...n,y:n.y-25}}};class dh{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new ss(Co(n)),this.windowListeners=new ss(Et(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ut.Resize,this.handleCancel),this.windowListeners.add(Ut.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ut.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&XE(r),n(pn)}handleKeyDown(e){if(lh(e)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:o=G1,coordinateGetter:s=nM,scrollBehavior:l="smooth"}=i,{code:a}=e;if(o.end.includes(a)){this.handleEnd(e);return}if(o.cancel.includes(a)){this.handleCancel(e);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:pn;this.referenceCoordinates||(this.referenceCoordinates=u);const f=s(e,{active:n,context:r.current,currentCoordinates:u});if(f){const p=Ba(f,u),h={x:0,y:0},{scrollableAncestors:m}=r.current;for(const g of m){const v=e.code,{isTop:y,isRight:x,isLeft:b,isBottom:w,maxScroll:C,minScroll:E}=q1(g),k=GE(g),M={x:Math.min(v===re.Right?k.right-k.width/2:k.right,Math.max(v===re.Right?k.left:k.left+k.width/2,f.x)),y:Math.min(v===re.Down?k.bottom-k.height/2:k.bottom,Math.max(v===re.Down?k.top:k.top+k.height/2,f.y))},$=v===re.Right&&!x||v===re.Left&&!b,O=v===re.Down&&!w||v===re.Up&&!y;if($&&M.x!==f.x){const _=g.scrollLeft+p.x,oe=v===re.Right&&_<=C.x||v===re.Left&&_>=E.x;if(oe&&!p.y){g.scrollTo({left:_,behavior:l});return}oe?h.x=g.scrollLeft-_:h.x=v===re.Right?g.scrollLeft-C.x:g.scrollLeft-E.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(O&&M.y!==f.y){const _=g.scrollTop+p.y,oe=v===re.Down&&_<=C.y||v===re.Up&&_>=E.y;if(oe&&!p.x){g.scrollTo({top:_,behavior:l});return}oe?h.y=g.scrollTop-_:h.y=v===re.Down?g.scrollTop-C.y:g.scrollTop-E.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(e,no(Ba(f,this.referenceCoordinates),h))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}dh.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=G1,onActivation:i}=e,{active:o}=n;const{code:s}=t.nativeEvent;if(r.start.includes(s)){const l=o.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i==null||i({event:t.nativeEvent}),!0)}return!1}}];function Ag(t){return!!(t&&"distance"in t)}function Ig(t){return!!(t&&"delay"in t)}class uh{constructor(e,n,r){var i;r===void 0&&(r=eM(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:o}=e,{target:s}=o;this.props=e,this.events=n,this.document=Co(s),this.documentListeners=new ss(this.document),this.listeners=new ss(r),this.windowListeners=new ss(Et(s)),this.initialCoordinates=(i=jf(o))!=null?i:pn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Ut.Resize,this.handleCancel),this.windowListeners.add(Ut.DragStart,Dg),this.windowListeners.add(Ut.VisibilityChange,this.handleCancel),this.windowListeners.add(Ut.ContextMenu,Dg),this.documentListeners.add(Ut.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ig(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ag(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Ut.Click,tM,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ut.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:i,props:o}=this,{onMove:s,options:{activationConstraint:l}}=o;if(!i)return;const a=(n=jf(e))!=null?n:pn,c=Ba(i,a);if(!r&&l){if(Ag(l)){if(l.tolerance!=null&&Yd(c,l.tolerance))return this.handleCancel();if(Yd(c,l.distance))return this.handleStart()}if(Ig(l)&&Yd(c,l.tolerance))return this.handleCancel();this.handlePending(l,c);return}e.cancelable&&e.preventDefault(),s(a)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===re.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const rM={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class fh extends uh{constructor(e){const{event:n}=e,r=Co(n.target);super(e,rM,r)}}fh.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const iM={move:{name:"mousemove"},end:{name:"mouseup"}};var Af;(function(t){t[t.RightClick=2]="RightClick"})(Af||(Af={}));class oM extends uh{constructor(e){super(e,iM,Co(e.event.target))}}oM.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Af.RightClick?!1:(r==null||r({event:n}),!0)}}];const Qd={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class sM extends uh{constructor(e){super(e,Qd)}static setup(){return window.addEventListener(Qd.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Qd.move.name,e)};function e(){}}}sM.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var ls;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(ls||(ls={}));var Ha;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ha||(Ha={}));function lM(t){let{acceleration:e,activator:n=ls.Pointer,canScroll:r,draggingRect:i,enabled:o,interval:s=5,order:l=Ha.TreeOrder,pointerCoordinates:a,scrollableAncestors:c,scrollableAncestorRects:u,delta:f,threshold:p}=t;const h=cM({delta:f,disabled:!o}),[m,g]=yE(),v=S.useRef({x:0,y:0}),y=S.useRef({x:0,y:0}),x=S.useMemo(()=>{switch(n){case ls.Pointer:return a?{top:a.y,bottom:a.y,left:a.x,right:a.x}:null;case ls.DraggableRect:return i}},[n,i,a]),b=S.useRef(null),w=S.useCallback(()=>{const E=b.current;if(!E)return;const k=v.current.x*y.current.x,M=v.current.y*y.current.y;E.scrollBy(k,M)},[]),C=S.useMemo(()=>l===Ha.TreeOrder?[...c].reverse():c,[l,c]);S.useEffect(()=>{if(!o||!c.length||!x){g();return}for(const E of C){if((r==null?void 0:r(E))===!1)continue;const k=c.indexOf(E),M=u[k];if(!M)continue;const{direction:$,speed:O}=JE(E,M,x,e,p);for(const _ of["x","y"])h[_][$[_]]||(O[_]=0,$[_]=0);if(O.x>0||O.y>0){g(),b.current=E,m(w,s),v.current=O,y.current=$;return}}v.current={x:0,y:0},y.current={x:0,y:0},g()},[e,w,r,g,o,s,JSON.stringify(x),JSON.stringify(h),m,c,C,u,JSON.stringify(p)])}const aM={x:{[Le.Backward]:!1,[Le.Forward]:!1},y:{[Le.Backward]:!1,[Le.Forward]:!1}};function cM(t){let{delta:e,disabled:n}=t;const r=Tf(e);return al(i=>{if(n||!r||!i)return aM;const o={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Le.Backward]:i.x[Le.Backward]||o.x===-1,[Le.Forward]:i.x[Le.Forward]||o.x===1},y:{[Le.Backward]:i.y[Le.Backward]||o.y===-1,[Le.Forward]:i.y[Le.Forward]||o.y===1}}},[n,e,r])}function dM(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return al(i=>{var o;return e==null?null:(o=r??i)!=null?o:null},[r,e])}function uM(t,e){return S.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,o=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,r)}));return[...n,...o]},[]),[t,e])}var Hs;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Hs||(Hs={}));var If;(function(t){t.Optimized="optimized"})(If||(If={}));const Rg=new Map;function fM(t,e){let{dragging:n,dependencies:r,config:i}=e;const[o,s]=S.useState(null),{frequency:l,measure:a,strategy:c}=i,u=S.useRef(t),f=v(),p=Bs(f),h=S.useCallback(function(y){y===void 0&&(y=[]),!p.current&&s(x=>x===null?y:x.concat(y.filter(b=>!x.includes(b))))},[p]),m=S.useRef(null),g=al(y=>{if(f&&!n)return Rg;if(!y||y===Rg||u.current!==t||o!=null){const x=new Map;for(let b of t){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const w=b.node.current,C=w?new ch(a(w),w):null;b.rect.current=C,C&&x.set(b.id,C)}return x}return y},[t,o,n,f,a]);return S.useEffect(()=>{u.current=t},[t]),S.useEffect(()=>{f||h()},[n,f]),S.useEffect(()=>{o&&o.length>0&&s(null)},[JSON.stringify(o)]),S.useEffect(()=>{f||typeof l!="number"||m.current!==null||(m.current=setTimeout(()=>{h(),m.current=null},l))},[l,f,h,...r]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:o!=null};function v(){switch(c){case Hs.Always:return!1;case Hs.BeforeDragging:return n;default:return!n}}}function Y1(t,e){return al(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function pM(t,e){return Y1(t,e)}function hM(t){let{callback:e,disabled:n}=t;const r=sh(e),i=S.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Qc(t){let{callback:e,disabled:n}=t;const r=sh(e),i=S.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function mM(t){return new ch(Eo(t),t)}function zg(t,e,n){e===void 0&&(e=mM);const[r,i]=S.useState(null);function o(){i(a=>{if(!t)return null;if(t.isConnected===!1){var c;return(c=a??n)!=null?c:null}const u=e(t);return JSON.stringify(a)===JSON.stringify(u)?a:u})}const s=hM({callback(a){if(t)for(const c of a){const{type:u,target:f}=c;if(u==="childList"&&f instanceof HTMLElement&&f.contains(t)){o();break}}}}),l=Qc({callback:o});return Tn(()=>{o(),t?(l==null||l.observe(t),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),s==null||s.disconnect())},[t]),r}function gM(t){const e=Y1(t);return H1(t,e)}const $g=[];function yM(t){const e=S.useRef(t),n=al(r=>t?r&&r!==$g&&t&&e.current&&t.parentNode===e.current.parentNode?r:ah(t):$g,[t]);return S.useEffect(()=>{e.current=t},[t]),n}function xM(t){const[e,n]=S.useState(null),r=S.useRef(t),i=S.useCallback(o=>{const s=Gd(o.target);s&&n(l=>l?(l.set(s,Df(s)),new Map(l)):null)},[]);return S.useEffect(()=>{const o=r.current;if(t!==o){s(o);const l=t.map(a=>{const c=Gd(a);return c?(c.addEventListener("scroll",i,{passive:!0}),[c,Df(c)]):null}).filter(a=>a!=null);n(l.length?new Map(l):null),r.current=t}return()=>{s(t),s(o)};function s(l){l.forEach(a=>{const c=Gd(a);c==null||c.removeEventListener("scroll",i)})}},[i,t]),S.useMemo(()=>t.length?e?Array.from(e.values()).reduce((o,s)=>no(o,s),pn):J1(t):pn,[t,e])}function Og(t,e){e===void 0&&(e=[]);const n=S.useRef(null);return S.useEffect(()=>{n.current=null},e),S.useEffect(()=>{const r=t!==pn;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Ba(t,n.current):pn}function vM(t){S.useEffect(()=>{if(!Yc)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function bM(t,e){return S.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:o}=r;return n[i]=s=>{o(s,e)},n},{}),[t,e])}function Q1(t){return S.useMemo(()=>t?VE(t):null,[t])}const Ng=[];function SM(t,e){e===void 0&&(e=Eo);const[n]=t,r=Q1(n?Et(n):null),[i,o]=S.useState(Ng);function s(){o(()=>t.length?t.map(a=>K1(a)?r:new ch(e(a),a)):Ng)}const l=Qc({callback:s});return Tn(()=>{l==null||l.disconnect(),s(),t.forEach(a=>l==null?void 0:l.observe(a))},[t]),i}function wM(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return ll(e)?e:t}function kM(t){let{measure:e}=t;const[n,r]=S.useState(null),i=S.useCallback(c=>{for(const{target:u}of c)if(ll(u)){r(f=>{const p=e(u);return f?{...f,width:p.width,height:p.height}:p});break}},[e]),o=Qc({callback:i}),s=S.useCallback(c=>{const u=wM(c);o==null||o.disconnect(),u&&(o==null||o.observe(u)),r(u?e(u):null)},[e,o]),[l,a]=Fa(s);return S.useMemo(()=>({nodeRef:l,rect:n,setRef:a}),[n,l,a])}const CM=[{sensor:fh,options:{}},{sensor:dh,options:{}}],EM={current:{}},oa={draggable:{measure:jg},droppable:{measure:jg,strategy:Hs.WhileDragging,frequency:If.Optimized},dragOverlay:{measure:Eo}};class as extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const MM={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new as,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_a},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:oa,measureDroppableContainers:_a,windowRect:null,measuringScheduled:!1},TM={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_a,draggableNodes:new Map,over:null,measureDroppableContainers:_a},Xc=S.createContext(TM),X1=S.createContext(MM);function jM(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new as}}}function DM(t,e){switch(e.type){case Ie.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Ie.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Ie.DragEnd:case Ie.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ie.RegisterDroppable:{const{element:n}=e,{id:r}=n,i=new as(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Ie.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=e,o=t.droppable.containers.get(n);if(!o||r!==o.key)return t;const s=new as(t.droppable.containers);return s.set(n,{...o,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Ie.UnregisterDroppable:{const{id:n,key:r}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const o=new as(t.droppable.containers);return o.delete(n),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function AM(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:i}=S.useContext(Xc),o=Tf(r),s=Tf(n==null?void 0:n.id);return S.useEffect(()=>{if(!e&&!r&&o&&s!=null){if(!lh(o)||document.activeElement===o.target)return;const l=i.get(s);if(!l)return;const{activatorNode:a,node:c}=l;if(!a.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[a.current,c.current]){if(!u)continue;const f=bE(u);if(f){f.focus();break}}})}},[r,e,i,s,o]),null}function IM(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((i,o)=>o({transform:i,...r}),n):n}function RM(t){return S.useMemo(()=>({draggable:{...oa.draggable,...t==null?void 0:t.draggable},droppable:{...oa.droppable,...t==null?void 0:t.droppable},dragOverlay:{...oa.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function zM(t){let{activeNode:e,measure:n,initialRect:r,config:i=!0}=t;const o=S.useRef(!1),{x:s,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Tn(()=>{if(!s&&!l||!e){o.current=!1;return}if(o.current||!r)return;const c=e==null?void 0:e.node.current;if(!c||c.isConnected===!1)return;const u=n(c),f=H1(u,r);if(s||(f.x=0),l||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=U1(c);p&&p.scrollBy({top:f.y,left:f.x})}},[e,s,l,r,n])}const Z1=S.createContext({...pn,scaleX:1,scaleY:1});var lr;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(lr||(lr={}));const $M=S.memo(function(e){var n,r,i,o;let{id:s,accessibility:l,autoScroll:a=!0,children:c,sensors:u=CM,collisionDetection:f=LE,measuring:p,modifiers:h,...m}=e;const g=S.useReducer(DM,void 0,jM),[v,y]=g,[x,b]=ME(),[w,C]=S.useState(lr.Uninitialized),E=w===lr.Initialized,{draggable:{active:k,nodes:M,translate:$},droppable:{containers:O}}=v,_=k!=null?M.get(k):null,oe=S.useRef({initial:null,translated:null}),ae=S.useMemo(()=>{var nt;return k!=null?{id:k,data:(nt=_==null?void 0:_.data)!=null?nt:EM,rect:oe}:null},[k,_]),me=S.useRef(null),[Oe,Ee]=S.useState(null),[ue,N]=S.useState(null),U=Bs(m,Object.values(m)),W=cl("DndDescribedBy",s),X=S.useMemo(()=>O.getEnabled(),[O]),Z=RM(p),{droppableRects:tt,measureDroppableContainers:Ue,measuringScheduled:tn}=fM(X,{dragging:E,dependencies:[$.x,$.y],config:Z.droppable}),ye=dM(M,k),nn=S.useMemo(()=>ue?jf(ue):null,[ue]),mn=pS(),Ft=pM(ye,Z.draggable.measure);zM({activeNode:k!=null?M.get(k):null,config:mn.layoutShiftCompensation,initialRect:Ft,measure:Z.draggable.measure});const ie=zg(ye,Z.draggable.measure,Ft),q=zg(ye?ye.parentElement:null),Se=S.useRef({activatorEvent:null,active:null,activeNode:ye,collisionRect:null,collisions:null,droppableRects:tt,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ci=O.getNodeFor((n=Se.current.over)==null?void 0:n.id),An=kM({measure:Z.dragOverlay.measure}),Ei=(r=An.nodeRef.current)!=null?r:ye,Mi=E?(i=An.rect)!=null?i:ie:null,Gh=!!(An.nodeRef.current&&An.rect),Yh=gM(Gh?null:ie),pd=Q1(Ei?Et(Ei):null),Yn=yM(E?Ci??ye:null),pl=SM(Yn),hl=IM(h,{transform:{x:$.x-Yh.x,y:$.y-Yh.y,scaleX:1,scaleY:1},activatorEvent:ue,active:ae,activeNodeRect:ie,containerNodeRect:q,draggingNodeRect:Mi,over:Se.current.over,overlayNodeRect:An.rect,scrollableAncestors:Yn,scrollableAncestorRects:pl,windowRect:pd}),Qh=nn?no(nn,$):null,Xh=xM(Yn),sS=Og(Xh),lS=Og(Xh,[ie]),Ti=no(hl,sS),ji=Mi?BE(Mi,hl):null,To=ae&&ji?f({active:ae,collisionRect:ji,droppableRects:tt,droppableContainers:X,pointerCoordinates:Qh}):null,Zh=$E(To,"id"),[Qn,em]=S.useState(null),aS=Gh?hl:no(hl,lS),cS=PE(aS,(o=Qn==null?void 0:Qn.rect)!=null?o:null,ie),hd=S.useRef(null),tm=S.useCallback((nt,Mt)=>{let{sensor:Tt,options:Xn}=Mt;if(me.current==null)return;const Bt=M.get(me.current);if(!Bt)return;const jt=nt.nativeEvent,gn=new Tt({active:me.current,activeNode:Bt,event:jt,options:Xn,context:Se,onAbort(Ve){if(!M.get(Ve))return;const{onDragAbort:yn}=U.current,In={id:Ve};yn==null||yn(In),x({type:"onDragAbort",event:In})},onPending(Ve,Zn,yn,In){if(!M.get(Ve))return;const{onDragPending:Do}=U.current,er={id:Ve,constraint:Zn,initialCoordinates:yn,offset:In};Do==null||Do(er),x({type:"onDragPending",event:er})},onStart(Ve){const Zn=me.current;if(Zn==null)return;const yn=M.get(Zn);if(!yn)return;const{onDragStart:In}=U.current,jo={activatorEvent:jt,active:{id:Zn,data:yn.data,rect:oe}};Qr.unstable_batchedUpdates(()=>{In==null||In(jo),C(lr.Initializing),y({type:Ie.DragStart,initialCoordinates:Ve,active:Zn}),x({type:"onDragStart",event:jo}),Ee(hd.current),N(jt)})},onMove(Ve){y({type:Ie.DragMove,coordinates:Ve})},onEnd:Di(Ie.DragEnd),onCancel:Di(Ie.DragCancel)});hd.current=gn;function Di(Ve){return async function(){const{active:yn,collisions:In,over:jo,scrollAdjustedTranslate:Do}=Se.current;let er=null;if(yn&&Do){const{cancelDrop:Ao}=U.current;er={activatorEvent:jt,active:yn,collisions:In,delta:Do,over:jo},Ve===Ie.DragEnd&&typeof Ao=="function"&&await Promise.resolve(Ao(er))&&(Ve=Ie.DragCancel)}me.current=null,Qr.unstable_batchedUpdates(()=>{y({type:Ve}),C(lr.Uninitialized),em(null),Ee(null),N(null),hd.current=null;const Ao=Ve===Ie.DragEnd?"onDragEnd":"onDragCancel";if(er){const md=U.current[Ao];md==null||md(er),x({type:Ao,event:er})}})}}},[M]),dS=S.useCallback((nt,Mt)=>(Tt,Xn)=>{const Bt=Tt.nativeEvent,jt=M.get(Xn);if(me.current!==null||!jt||Bt.dndKit||Bt.defaultPrevented)return;const gn={active:jt};nt(Tt,Mt.options,gn)===!0&&(Bt.dndKit={capturedBy:Mt.sensor},me.current=Xn,tm(Tt,Mt))},[M,tm]),nm=uM(u,dS);vM(u),Tn(()=>{ie&&w===lr.Initializing&&C(lr.Initialized)},[ie,w]),S.useEffect(()=>{const{onDragMove:nt}=U.current,{active:Mt,activatorEvent:Tt,collisions:Xn,over:Bt}=Se.current;if(!Mt||!Tt)return;const jt={active:Mt,activatorEvent:Tt,collisions:Xn,delta:{x:Ti.x,y:Ti.y},over:Bt};Qr.unstable_batchedUpdates(()=>{nt==null||nt(jt),x({type:"onDragMove",event:jt})})},[Ti.x,Ti.y]),S.useEffect(()=>{const{active:nt,activatorEvent:Mt,collisions:Tt,droppableContainers:Xn,scrollAdjustedTranslate:Bt}=Se.current;if(!nt||me.current==null||!Mt||!Bt)return;const{onDragOver:jt}=U.current,gn=Xn.get(Zh),Di=gn&&gn.rect.current?{id:gn.id,rect:gn.rect.current,data:gn.data,disabled:gn.disabled}:null,Ve={active:nt,activatorEvent:Mt,collisions:Tt,delta:{x:Bt.x,y:Bt.y},over:Di};Qr.unstable_batchedUpdates(()=>{em(Di),jt==null||jt(Ve),x({type:"onDragOver",event:Ve})})},[Zh]),Tn(()=>{Se.current={activatorEvent:ue,active:ae,activeNode:ye,collisionRect:ji,collisions:To,droppableRects:tt,draggableNodes:M,draggingNode:Ei,draggingNodeRect:Mi,droppableContainers:O,over:Qn,scrollableAncestors:Yn,scrollAdjustedTranslate:Ti},oe.current={initial:Mi,translated:ji}},[ae,ye,To,ji,M,Ei,Mi,tt,O,Qn,Yn,Ti]),lM({...mn,delta:$,draggingRect:ji,pointerCoordinates:Qh,scrollableAncestors:Yn,scrollableAncestorRects:pl});const uS=S.useMemo(()=>({active:ae,activeNode:ye,activeNodeRect:ie,activatorEvent:ue,collisions:To,containerNodeRect:q,dragOverlay:An,draggableNodes:M,droppableContainers:O,droppableRects:tt,over:Qn,measureDroppableContainers:Ue,scrollableAncestors:Yn,scrollableAncestorRects:pl,measuringConfiguration:Z,measuringScheduled:tn,windowRect:pd}),[ae,ye,ie,ue,To,q,An,M,O,tt,Qn,Ue,Yn,pl,Z,tn,pd]),fS=S.useMemo(()=>({activatorEvent:ue,activators:nm,active:ae,activeNodeRect:ie,ariaDescribedById:{draggable:W},dispatch:y,draggableNodes:M,over:Qn,measureDroppableContainers:Ue}),[ue,nm,ae,ie,y,W,M,Qn,Ue]);return ee.createElement(_1.Provider,{value:b},ee.createElement(Xc.Provider,{value:fS},ee.createElement(X1.Provider,{value:uS},ee.createElement(Z1.Provider,{value:cS},c)),ee.createElement(AM,{disabled:(l==null?void 0:l.restoreFocus)===!1})),ee.createElement(DE,{...l,hiddenTextDescribedById:W}));function pS(){const nt=(Oe==null?void 0:Oe.autoScrollEnabled)===!1,Mt=typeof a=="object"?a.enabled===!1:a===!1,Tt=E&&!nt&&!Mt;return typeof a=="object"?{...a,enabled:Tt}:{enabled:Tt}}}),OM=S.createContext(null),Lg="button",NM="Draggable";function LM(t){let{id:e,data:n,disabled:r=!1,attributes:i}=t;const o=cl(NM),{activators:s,activatorEvent:l,active:a,activeNodeRect:c,ariaDescribedById:u,draggableNodes:f,over:p}=S.useContext(Xc),{role:h=Lg,roleDescription:m="draggable",tabIndex:g=0}=i??{},v=(a==null?void 0:a.id)===e,y=S.useContext(v?Z1:OM),[x,b]=Fa(),[w,C]=Fa(),E=bM(s,e),k=Bs(n);Tn(()=>(f.set(e,{id:e,key:o,node:x,activatorNode:w,data:k}),()=>{const $=f.get(e);$&&$.key===o&&f.delete(e)}),[f,e]);const M=S.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":r,"aria-pressed":v&&h===Lg?!0:void 0,"aria-roledescription":m,"aria-describedby":u.draggable}),[r,h,g,v,m,u.draggable]);return{active:a,activatorEvent:l,activeNodeRect:c,attributes:M,isDragging:v,listeners:r?void 0:E,node:x,over:p,setNodeRef:b,setActivatorNodeRef:C,transform:y}}function PM(){return S.useContext(X1)}const FM="Droppable",BM={timeout:25};function _M(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const o=cl(FM),{active:s,dispatch:l,over:a,measureDroppableContainers:c}=S.useContext(Xc),u=S.useRef({disabled:n}),f=S.useRef(!1),p=S.useRef(null),h=S.useRef(null),{disabled:m,updateMeasurementsFor:g,timeout:v}={...BM,...i},y=Bs(g??r),x=S.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{c(Array.isArray(y.current)?y.current:[y.current]),h.current=null},v)},[v]),b=Qc({callback:x,disabled:m||!s}),w=S.useCallback((M,$)=>{b&&($&&(b.unobserve($),f.current=!1),M&&b.observe(M))},[b]),[C,E]=Fa(w),k=Bs(e);return S.useEffect(()=>{!b||!C.current||(b.disconnect(),f.current=!1,b.observe(C.current))},[C,b]),S.useEffect(()=>(l({type:Ie.RegisterDroppable,element:{id:r,key:o,disabled:n,node:C,rect:p,data:k}}),()=>l({type:Ie.UnregisterDroppable,key:o,id:r})),[r]),S.useEffect(()=>{n!==u.current.disabled&&(l({type:Ie.SetDroppableDisabled,id:r,key:o,disabled:n}),u.current.disabled=n)},[r,o,n,l]),{active:s,rect:p,isOver:(a==null?void 0:a.id)===r,node:C,over:a,setNodeRef:E}}function ev(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function HM(t,e){return t.reduce((n,r,i)=>{const o=e.get(r);return o&&(n[i]=o),n},Array(t.length))}function $l(t){return t!==null&&t>=0}function UM(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function VM(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const tv=t=>{let{rects:e,activeIndex:n,overIndex:r,index:i}=t;const o=ev(e,r,n),s=e[i],l=o[i];return!l||!s?null:{x:l.left-s.left,y:l.top-s.top,scaleX:l.width/s.width,scaleY:l.height/s.height}},Ol={scaleX:1,scaleY:1},WM=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:i,rects:o,overIndex:s}=t;const l=(e=o[n])!=null?e:r;if(!l)return null;if(i===n){const c=o[s];return c?{x:0,y:n<s?c.top+c.height-(l.top+l.height):c.top-l.top,...Ol}:null}const a=KM(o,i,n);return i>n&&i<=s?{x:0,y:-l.height-a,...Ol}:i<n&&i>=s?{x:0,y:l.height+a,...Ol}:{x:0,y:0,...Ol}};function KM(t,e,n){const r=t[e],i=t[e-1],o=t[e+1];return r?n<e?i?r.top-(i.top+i.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const nv="Sortable",rv=ee.createContext({activeIndex:-1,containerId:nv,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:tv,disabled:{draggable:!1,droppable:!1}});function qM(t){let{children:e,id:n,items:r,strategy:i=tv,disabled:o=!1}=t;const{active:s,dragOverlay:l,droppableRects:a,over:c,measureDroppableContainers:u}=PM(),f=cl(nv,n),p=l.rect!==null,h=S.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),m=s!=null,g=s?h.indexOf(s.id):-1,v=c?h.indexOf(c.id):-1,y=S.useRef(h),x=!UM(h,y.current),b=v!==-1&&g===-1||x,w=VM(o);Tn(()=>{x&&m&&u(h)},[x,h,m,u]),S.useEffect(()=>{y.current=h},[h]);const C=S.useMemo(()=>({activeIndex:g,containerId:f,disabled:w,disableTransforms:b,items:h,overIndex:v,useDragOverlay:p,sortedRects:HM(h,a),strategy:i}),[g,f,w.draggable,w.droppable,b,h,v,a,p,i]);return ee.createElement(rv.Provider,{value:C},e)}const JM=t=>{let{id:e,items:n,activeIndex:r,overIndex:i}=t;return ev(n,r,i).indexOf(e)},GM=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:i,items:o,newIndex:s,previousItems:l,previousContainerId:a,transition:c}=t;return!c||!r||l!==o&&i===s?!1:n?!0:s!==i&&e===a},YM={duration:200,easing:"ease"},iv="transform",QM=_s.Transition.toString({property:iv,duration:0,easing:"linear"}),XM={roleDescription:"sortable"};function ZM(t){let{disabled:e,index:n,node:r,rect:i}=t;const[o,s]=S.useState(null),l=S.useRef(n);return Tn(()=>{if(!e&&n!==l.current&&r.current){const a=i.current;if(a){const c=Eo(r.current,{ignoreTransform:!0}),u={x:a.left-c.left,y:a.top-c.top,scaleX:a.width/c.width,scaleY:a.height/c.height};(u.x||u.y)&&s(u)}}n!==l.current&&(l.current=n)},[e,n,r,i]),S.useEffect(()=>{o&&s(null)},[o]),o}function eT(t){let{animateLayoutChanges:e=GM,attributes:n,disabled:r,data:i,getNewIndex:o=JM,id:s,strategy:l,resizeObserverConfig:a,transition:c=YM}=t;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:m,sortedRects:g,overIndex:v,useDragOverlay:y,strategy:x}=S.useContext(rv),b=tT(r,h),w=u.indexOf(s),C=S.useMemo(()=>({sortable:{containerId:f,index:w,items:u},...i}),[f,i,w,u]),E=S.useMemo(()=>u.slice(u.indexOf(s)),[u,s]),{rect:k,node:M,isOver:$,setNodeRef:O}=_M({id:s,data:C,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...a}}),{active:_,activatorEvent:oe,activeNodeRect:ae,attributes:me,setNodeRef:Oe,listeners:Ee,isDragging:ue,over:N,setActivatorNodeRef:U,transform:W}=LM({id:s,data:C,attributes:{...XM,...n},disabled:b.draggable}),X=gE(O,Oe),Z=!!_,tt=Z&&!m&&$l(p)&&$l(v),Ue=!y&&ue,tn=Ue&&tt?W:null,nn=tt?tn??(l??x)({rects:g,activeNodeRect:ae,activeIndex:p,overIndex:v,index:w}):null,mn=$l(p)&&$l(v)?o({id:s,items:u,activeIndex:p,overIndex:v}):w,Ft=_==null?void 0:_.id,ie=S.useRef({activeId:Ft,items:u,newIndex:mn,containerId:f}),q=u!==ie.current.items,Se=e({active:_,containerId:f,isDragging:ue,isSorting:Z,id:s,index:w,items:u,newIndex:ie.current.newIndex,previousItems:ie.current.items,previousContainerId:ie.current.containerId,transition:c,wasDragging:ie.current.activeId!=null}),Ci=ZM({disabled:!Se,index:w,node:M,rect:k});return S.useEffect(()=>{Z&&ie.current.newIndex!==mn&&(ie.current.newIndex=mn),f!==ie.current.containerId&&(ie.current.containerId=f),u!==ie.current.items&&(ie.current.items=u)},[Z,mn,f,u]),S.useEffect(()=>{if(Ft===ie.current.activeId)return;if(Ft&&!ie.current.activeId){ie.current.activeId=Ft;return}const Ei=setTimeout(()=>{ie.current.activeId=Ft},50);return()=>clearTimeout(Ei)},[Ft]),{active:_,activeIndex:p,attributes:me,data:C,rect:k,index:w,newIndex:mn,items:u,isOver:$,isSorting:Z,isDragging:ue,listeners:Ee,node:M,overIndex:v,over:N,setNodeRef:X,setActivatorNodeRef:U,setDroppableNodeRef:O,setDraggableNodeRef:Oe,transform:Ci??nn,transition:An()};function An(){if(Ci||q&&ie.current.newIndex===w)return QM;if(!(Ue&&!lh(oe)||!c)&&(Z||Se))return _s.Transition.toString({...c,property:iv})}}function tT(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t==null?void 0:t.draggable)!=null?n:e.draggable,droppable:(r=t==null?void 0:t.droppable)!=null?r:e.droppable}}re.Down,re.Right,re.Up,re.Left;function H({value:t,placeholder:e,multiline:n=!1,style:r,className:i,onCommit:o}){const s=S.useRef(null),l=S.useRef(t??""),[a,c]=S.useState(t??"");S.useEffect(()=>{l.current=t??"",c(t??""),s.current&&s.current.innerText!==(t??"")&&(s.current.innerText=t??"")},[t]);const u=()=>{const p=s.current?s.current.innerText:a;l.current=p,o(p)},f=()=>{const p=l.current??"";c(p),s.current&&(s.current.innerText=p)};return d.jsx("div",{ref:s,className:i,style:{outline:"none",cursor:"text",whiteSpace:n?"pre-wrap":"normal",wordBreak:"break-word",overflowWrap:"break-word",minWidth:0,...r||{}},contentEditable:!0,suppressContentEditableWarning:!0,"data-inline-editor":"true",onInput:p=>c(p.currentTarget.innerText),onBlur:u,onKeyDown:p=>{p.key==="Escape"&&(p.preventDefault(),f(),p.currentTarget.blur()),!n&&p.key==="Enter"&&(p.preventDefault(),u(),p.currentTarget.blur())},"data-placeholder":e||"",children:a})}function nT({html:t,placeholder:e,className:n,style:r,onCommit:i}){const o=S.useRef(null),s=S.useRef(t??""),[l,a]=S.useState(t??"");S.useEffect(()=>{s.current=t??"",a(t??""),o.current&&o.current.innerHTML!==(t??"")&&(o.current.innerHTML=t??"")},[t]);const c=()=>{const f=o.current?o.current.innerHTML:l;s.current=f,i(f)},u=()=>{const f=s.current??"";a(f),o.current&&(o.current.innerHTML=f)};return d.jsx("div",{ref:o,className:n,style:{outline:"none",cursor:"text",...r||{}},contentEditable:!0,suppressContentEditableWarning:!0,"data-inline-editor":"true","data-placeholder":e||"",onInput:f=>a(f.currentTarget.innerHTML),onBlur:c,onKeyDown:f=>{f.key==="Escape"&&(f.preventDefault(),u(),f.currentTarget.blur())},dangerouslySetInnerHTML:{__html:l||""}})}function qe(t){this.content=t}qe.prototype={constructor:qe,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new qe(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new qe(n)},addToStart:function(t,e){return new qe([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new qe(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new qe(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=qe.from(t),t.size?new qe(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=qe.from(t),t.size?new qe(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=qe.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};qe.from=function(t){if(t instanceof qe)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new qe(e)};function ov(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=ov(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function sv(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){n-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:n,b:r};if(s.isText&&s.text!=l.text){let c=0,u=Math.min(s.text.length,l.text.length);for(;c<u&&s.text[s.text.length-c-1]==l.text[l.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(s.content.size||l.content.size){let c=sv(s.content,l.content,n-1,r-1);if(c)return c}n-=a,r-=a}}class I{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,l=0;l<n;s++){let a=this.content[s],c=l+a.nodeSize;if(c>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let u=l+1;a.nodesBetween(Math.max(0,e-u),Math.min(a.content.size,n-u),r,i+u)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(l,a)=>{let c=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new I(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,n-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,n-s-1))),r.push(l),i+=l.nodeSize),s=a}return new I(r,i)}cutByIndex(e,n){return e==n?I.empty:e==0&&n==this.content.length?this:new I(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new I(i,o)}addToStart(e){return new I([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new I(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return ov(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return sv(this,e,n,r)}findIndex(e){if(e==0)return Nl(0,e);if(e==this.size)return Nl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),o=r+i.nodeSize;if(o>=e)return o==e?Nl(n+1,o):Nl(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return I.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new I(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return I.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new I(n||e,r)}static from(e){if(!e)return I.empty;if(e instanceof I)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new I([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}I.empty=new I([],0);const Xd={index:0,offset:0};function Nl(t,e){return Xd.index=t,Xd.offset=e,Xd}function Ua(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Ua(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Ua(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let ce=class Rf{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ua(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Rf.none;if(e instanceof Rf)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};ce.none=[];class Va extends Error{}class L{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=av(this.content,e+this.openStart,n);return r&&new L(r,this.openStart,this.openEnd)}removeBetween(e,n){return new L(lv(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return L.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new L(I.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new L(e,r,i)}}L.empty=new L(I.empty,0,0);function lv(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:l}=t.findIndex(n);if(i==e||o.isText){if(l!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(lv(o.content,e-i-1,n-i-1)))}function av(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=av(s.content,e-o-1,n,s);return l&&t.replaceChild(i,s.copy(l))}function rT(t,e,n){if(n.openStart>t.depth)throw new Va("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Va("Inconsistent open depths");return cv(t,e,n,0)}function cv(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=cv(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,l=s.content;return oi(s,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=iT(n,t);return oi(o,uv(t,s,l,e,r))}else return oi(o,Wa(t,e,r))}function dv(t,e){if(!e.type.compatibleContent(t.type))throw new Va("Cannot join "+e.type.name+" onto "+t.type.name)}function zf(t,e,n){let r=t.node(n);return dv(r,e.node(n)),r}function ii(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function cs(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(ii(t.nodeAfter,r),o++));for(let l=o;l<s;l++)ii(i.child(l),r);e&&e.depth==n&&e.textOffset&&ii(e.nodeBefore,r)}function oi(t,e){return t.type.checkContent(e),t.copy(e)}function uv(t,e,n,r,i){let o=t.depth>i&&zf(t,e,i+1),s=r.depth>i&&zf(n,r,i+1),l=[];return cs(null,t,i,l),o&&s&&e.index(i)==n.index(i)?(dv(o,s),ii(oi(o,uv(t,e,n,r,i+1)),l)):(o&&ii(oi(o,Wa(t,e,i+1)),l),cs(e,n,i,l),s&&ii(oi(s,Wa(n,r,i+1)),l)),cs(r,null,i,l),new I(l)}function Wa(t,e,n){let r=[];if(cs(null,t,n,r),t.depth>n){let i=zf(t,e,n+1);ii(oi(i,Wa(t,e,n+1)),r)}return cs(e,null,n,r),new I(r)}function iT(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(I.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Us{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return ce.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Ka(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),c=o-a;if(r.push(s,l,i+a),!c||(s=s.child(l),s.isText))break;o=c-1,i+=a+1}return new Us(n,r,o)}static resolveCached(e,n){let r=Pg.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else Pg.set(e,r=new oT);let i=r.elts[r.i]=Us.resolve(e,n);return r.i=(r.i+1)%sT,i}}class oT{constructor(){this.elts=[],this.i=0}}const sT=12,Pg=new WeakMap;class Ka{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const lT=Object.create(null);let jr=class $f{constructor(e,n,r,i=ce.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||I.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Ua(this.attrs,n||e.defaultAttrs||lT)&&ce.sameSet(this.marks,r||ce.none)}copy(e=null){return e==this.content?this:new $f(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new $f(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return L.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),l=i.start(s),c=i.node(s).content.cut(i.pos-l,o.pos-l);return new L(c,i.depth-s,o.depth-s)}replace(e,n,r){return rT(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Us.resolveCached(this,e)}resolveNoCache(e){return Us.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),fv(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=I.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ce.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ce.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=I.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};jr.prototype.text=void 0;class qa extends jr{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):fv(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new qa(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new qa(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function fv(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class gi{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new aT(e,n);if(r.next==null)return gi.empty;let i=pv(r);r.next&&r.err("Unexpected trailing text");let o=mT(hT(i));return gT(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!n||a.validEnd))return I.from(l.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:f}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let p=o(f,l.concat(u));if(p)return p}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}gi.empty=new gi(!0);class aT{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function pv(t){let e=[];do e.push(cT(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function cT(t){let e=[];do e.push(dT(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function dT(t){let e=pT(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=uT(t,e);else break;return e}function Fg(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function uT(t,e){let n=Fg(t),r=n;return t.eat(",")&&(t.next!="}"?r=Fg(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function fT(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function pT(t){if(t.eat("(")){let e=pv(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=fT(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function hT(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,l,a){let c={term:a,to:l};return e[s].push(c),c}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,c)=>a.concat(o(c,l)),[]);if(s.type=="seq")for(let a=0;;a++){let c=o(s.exprs[a],l);if(a==s.exprs.length-1)return c;i(c,l=n())}else if(s.type=="star"){let a=n();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=n();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let c=0;c<s.min;c++){let u=n();i(o(s.expr,a),u),a=u}if(s.max==-1)i(o(s.expr,a),a);else for(let c=s.min;c<s.max;c++){let u=n();r(a,u),i(o(s.expr,a),u),a=u}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function hv(t,e){return e-t}function Bg(t,e){let n=[];return r(e),n.sort(hv);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&n.indexOf(a)==-1&&r(a)}}}function mT(t){let e=Object.create(null);return n(Bg(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:l,to:a})=>{if(!l)return;let c;for(let u=0;u<i.length;u++)i[u][0]==l&&(c=i[u][1]);Bg(t,a).forEach(u=>{c||i.push([l,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new gi(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(hv);o.next.push({type:i[s][0],next:e[l.join(",")]||n(l)})}return o}}function gT(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:c}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function mv(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function gv(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function yv(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function xv(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new xT(t,r,e[r]);return n}let _g=class vv{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=xv(e,r.attrs),this.defaultAttrs=mv(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==gi.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:gv(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new jr(this,this.computeAttrs(e),I.from(n),ce.setFrom(r))}createChecked(e=null,n,r){return n=I.from(n),this.checkContent(n),new jr(this,this.computeAttrs(e),n,ce.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=I.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(I.empty,!0);return o?new jr(this,e,n.append(o),ce.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){yv(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:ce.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new vv(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function yT(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class xT{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?yT(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Zc{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=xv(e,i.attrs),this.excluded=null;let o=mv(this.attrs);this.instance=o?new ce(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ce(this,gv(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Zc(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){yv(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class bv{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=qe.from(e.nodes),n.marks=qe.from(e.marks||{}),this.nodes=_g.compile(this.spec.nodes,this),this.marks=Zc.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=gi.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?Hg(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Hg(this,s.split(" "))}this.nodeFromJSON=i=>jr.fromJSON(this,i),this.markFromJSON=i=>ce.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof _g){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new qa(r,r.defaultAttrs,e,ce.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Hg(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function vT(t){return t.tag!=null}function bT(t){return t.style!=null}let ds=class Of{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(vT(i))this.tags.push(i);else if(bT(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new Vg(this,n,!1);return r.addAll(e,ce.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Vg(this,n,!0);return r.addAll(e,ce.none,n.from,n.to),L.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(kT(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(s.getAttrs){let a=s.getAttrs(n);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let l=n[s];if((l.priority==null?50:l.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Wg(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Wg(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Of(e,Of.schemaRules(e)))}};const Sv={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ST={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},wv={ol:!0,ul:!0},Vs=1,Nf=2,us=4;function Ug(t,e,n){return e!=null?(e?Vs:0)|(e==="full"?Nf:0):t&&t.whitespace=="pre"?Vs|Nf:n&~us}class Ll{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=ce.none,this.match=o||(s&us?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(I.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Vs)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=I.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(I.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Sv.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Vg{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=Ug(null,n.preserveWhitespace,0)|(r?us:0);i?o=new Ll(i.type,i.attrs,ce.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new Ll(null,null,ce.none,!0,null,s):o=new Ll(e.schema.topNodeType,null,ce.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&Nf?"full":this.localPreserveWS||(i.options&Vs)>0,{schema:s}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(s.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let a=0;a<l.length;a++)a&&this.insertNode(s.linebreakReplacement.create(),n,!0),l[a]&&this.insertNode(s.text(l[a]),n,!/\S/.test(l[a]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],a=e.previousSibling;(!l||a&&a.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(s.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),l;wv.hasOwnProperty(s)&&this.parser.normalizeLists&&wT(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:ST.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let c,u=this.needsBlock;if(Sv.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let f=a&&a.skip?n:this.readStyles(e,n);f&&this.addAll(e,f),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,a,c,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(o,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?n=n.filter(c=>!a.clearMark(c)):n=n.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(s,n.attrs||null,r,n.preserveWhitespace);a&&(o=!0,r=a)}else{let a=this.parser.schema.marks[n.mark];r=r.concat(a.create(n.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}o&&this.sync(l)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];s!=l;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n,r){let i,o;for(let s=this.open,l=0;s>=0;s--){let a=this.nodes[s],c=a.findWrapping(e);if(c&&(!i||i.length>c.length+l)&&(i=c,o=a,!c.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)n=this.enterInner(i[s],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=ce.none;for(let l of i.concat(e.marks))(o.type?o.type.allowsMarkType(l.type):Kg(l.type,e.type))&&(s=l.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r,!1);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let l=Ug(e,o,s.options);s.options&us&&s.content.length==0&&(l|=us);let a=ce.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Kg(c.type,e))?(a=c.addToSet(a),!1):!0),this.nodes.push(new Ll(e,n,a,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Vs)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let c=n[l];if(c==""){if(l==n.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let u=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;a--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function wT(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&wv.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function kT(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Wg(t){let e={};for(let n in t)e[n]=t[n];return e}function Kg(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:u}=l.edge(a);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class ki{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Zd(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let c=s.marks[a];if(!this.marks[c.type.name]){a++;continue}if(!c.eq(o[l][0])||c.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let c=s.marks[a++],u=this.serializeMark(c,s.isInline,n);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=sa(Zd(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&sa(Zd(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return sa(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ki(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=qg(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return qg(e.marks)}}function qg(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Zd(t){return t.document||window.document}const Jg=new WeakMap;function CT(t){let e=Jg.get(t);return e===void 0&&Jg.set(t,e=ET(t)),e}function ET(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function sa(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=CT(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let l,a=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let p=f.indexOf(" ");p>0?a.setAttributeNS(f.slice(0,p),f.slice(p+1),c[f]):f=="style"&&a.style?a.style.cssText=c[f]:a.setAttribute(f,c[f])}}for(let f=u;f<e.length;f++){let p=e[f];if(p===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:h,contentDOM:m}=sa(t,p,n,r);if(a.appendChild(h),m){if(l)throw new RangeError("Multiple content holes");l=m}}}return{dom:a,contentDOM:l}}const kv=65535,Cv=Math.pow(2,16);function MT(t,e){return t+e*Cv}function Gg(t){return t&kv}function TT(t){return(t-(t&kv))/Cv}const Ev=1,Mv=2,la=4,Tv=8;class Lf{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&Tv)>0}get deletedBefore(){return(this.delInfo&(Ev|la))>0}get deletedAfter(){return(this.delInfo&(Mv|la))>0}get deletedAcross(){return(this.delInfo&la)>0}}class At{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&At.empty)return At.empty}recover(e){let n=0,r=Gg(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+TT(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let c=this.ranges[l+o],u=this.ranges[l+s],f=a+c;if(e<=f){let p=c?e==a?-1:e==f?1:n:n,h=a+i+(p<0?0:u);if(r)return h;let m=e==(n<0?a:f)?null:MT(l/3,e-a),g=e==a?Mv:e==f?Ev:la;return(n<0?e!=a:e!=f)&&(g|=Tv),new Lf(h,g,m)}i+=u-c}return r?e+i:new Lf(e+i,0,null)}touches(e,n){let r=0,i=Gg(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let c=this.ranges[l+o],u=a+c;if(e<=u&&l==i*3)return!0;r+=this.ranges[l+s]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),c=this.ranges[i+n],u=this.ranges[i+r];e(l,l+c,a,a+u),o+=u-c}}invert(){return new At(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?At.empty:new At(e<0?[0,-e,0]:[0,0,e])}}At.empty=new At([]);class Ws{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ws(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Ws;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],l=s.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Lf(e,i,null)}}const eu=Object.create(null);class ct{getMap(){return At.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=eu[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in eu)throw new RangeError("Duplicate use of step JSON ID "+e);return eu[e]=n,n.prototype.jsonID=e,n}}class De{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new De(e,null)}static fail(e){return new De(null,e)}static fromReplace(e,n,r,i){try{return De.ok(e.replace(n,r,i))}catch(o){if(o instanceof Va)return De.fail(o.message);throw o}}}function ph(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(ph(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return I.fromArray(r)}class yr extends ct{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new L(ph(n.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return De.fromReplace(e,this.from,this.to,o)}invert(){return new Cn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new yr(n.pos,r.pos,this.mark)}merge(e){return e instanceof yr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new yr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new yr(n.from,n.to,e.markFromJSON(n.mark))}}ct.jsonID("addMark",yr);class Cn extends ct{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new L(ph(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return De.fromReplace(e,this.from,this.to,r)}invert(){return new yr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Cn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Cn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Cn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Cn(n.from,n.to,e.markFromJSON(n.mark))}}ct.jsonID("removeMark",Cn);class xr extends ct{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return De.fromReplace(e,this.pos,this.pos+1,new L(I.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new xr(this.pos,n.marks[i]);return new xr(this.pos,this.mark)}}return new yi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new xr(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new xr(n.pos,e.markFromJSON(n.mark))}}ct.jsonID("addNodeMark",xr);class yi extends ct{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return De.fromReplace(e,this.pos,this.pos+1,new L(I.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new xr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new yi(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new yi(n.pos,e.markFromJSON(n.mark))}}ct.jsonID("removeNodeMark",yi);class Pe extends ct{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Pf(e,this.from,this.to)?De.fail("Structure replace would overwrite content"):De.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new At([this.from,this.to-this.from,this.slice.size])}invert(e){return new Pe(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Pe(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Pe)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?L.empty:new L(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Pe(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?L.empty:new L(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Pe(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Pe(n.from,n.to,L.fromJSON(e,n.slice),!!n.structure)}}ct.jsonID("replace",Pe);class Be extends ct{constructor(e,n,r,i,o,s,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Pf(e,this.from,this.gapFrom)||Pf(e,this.gapTo,this.to)))return De.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return De.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?De.fromReplace(e,this.from,this.to,r):De.fail("Content does not fit in gap")}getMap(){return new At([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Be(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new Be(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Be(n.from,n.to,n.gapFrom,n.gapTo,L.fromJSON(e,n.slice),n.insert,!!n.structure)}}ct.jsonID("replaceAround",Be);function Pf(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function jT(t,e,n,r){let i=[],o=[],s,l;t.doc.nodesBetween(e,n,(a,c,u)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let p=Math.max(c,e),h=Math.min(c+a.nodeSize,n),m=r.addToSet(f);for(let g=0;g<f.length;g++)f[g].isInSet(m)||(s&&s.to==p&&s.mark.eq(f[g])?s.to=h:i.push(s=new Cn(p,h,f[g])));l&&l.to==p?l.to=h:o.push(l=new yr(p,h,r))}}),i.forEach(a=>t.step(a)),o.forEach(a=>t.step(a))}function DT(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Zc){let c=s.marks,u;for(;u=r.isInSet(c);)(a||(a=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let c=Math.min(l+s.nodeSize,n);for(let u=0;u<a.length;u++){let f=a[u],p;for(let h=0;h<i.length;h++){let m=i[h];m.step==o-1&&f.eq(i[h].style)&&(p=m)}p?(p.to=c,p.step=o):i.push({style:f,from:Math.max(l,e),to:c,step:o})}}}),i.forEach(s=>t.step(new Cn(s.from,s.to,s.style)))}function hh(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],l=e+1;for(let a=0;a<o.childCount;a++){let c=o.child(a),u=l+c.nodeSize,f=r.matchType(c.type);if(!f)s.push(new Pe(l,u,L.empty));else{r=f;for(let p=0;p<c.marks.length;p++)n.allowsMarkType(c.marks[p].type)||t.step(new Cn(l,u,c.marks[p]));if(i&&c.isText&&n.whitespace!="pre"){let p,h=/\r?\n|\r/g,m;for(;p=h.exec(c.text);)m||(m=new L(I.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),s.push(new Pe(l+p.index,l+p.index+p[0].length,m))}}l=u}if(!r.validEnd){let a=r.fillBefore(I.empty,!0);t.replace(l,l,new L(a,0,0))}for(let a=s.length-1;a>=0;a--)t.step(s[a])}function AT(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Mo(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,o=0;;--r){let s=t.$from.node(r),l=t.$from.index(r)+i,a=t.$to.indexAfter(r)-o;if(r<t.depth&&s.canReplace(l,a,n))return r;if(r==0||s.type.spec.isolating||!AT(s,l,a))break;l&&(i=1),a<s.childCount&&(o=1)}return null}function IT(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,c=l,u=I.empty,f=0;for(let m=o,g=!1;m>n;m--)g||r.index(m)>0?(g=!0,u=I.from(r.node(m).copy(u)),f++):a--;let p=I.empty,h=0;for(let m=o,g=!1;m>n;m--)g||i.after(m+1)<i.end(m)?(g=!0,p=I.from(i.node(m).copy(p)),h++):c++;t.step(new Be(a,c,s,l,new L(u.append(p),f,h),u.size-f,!0))}function mh(t,e,n=null,r=t){let i=RT(t,e),o=i&&zT(r,e);return o?i.map(Yg).concat({type:e,attrs:n}).concat(o.map(Yg)):null}function Yg(t){return{type:t,attrs:null}}function RT(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function zT(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;a&&c<i;c++)a=a.matchType(n.child(c).type);return!a||!a.validEnd?null:s}function $T(t,e,n){let r=I.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let l=n[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=I.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new Be(i,o,i,o,new L(r,0,0),n.length,!0))}function OT(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,l)=>{let a=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,a)&&NT(t.doc,t.mapping.slice(o).map(l),r)){let c=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!m?c=!1:!h&&m&&(c=!0)}c===!1&&Dv(t,s,l,o),hh(t,t.mapping.slice(o).map(l,1),r,void 0,c===null);let u=t.mapping.slice(o),f=u.map(l,1),p=u.map(l+s.nodeSize,1);return t.step(new Be(f,p,f+1,p-1,new L(I.from(r.create(a,null,s.marks)),0,0),1,!0)),c===!0&&jv(t,s,l,o),!1}})}function jv(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(i.text);){let a=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function Dv(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function NT(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function LT(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Be(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new L(I.from(s),0,0),1,!0))}function Un(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>o;c--,u--){let f=i.node(c),p=i.index(c);if(f.type.spec.isolating)return!1;let h=f.content.cutByIndex(p,f.childCount),m=r&&r[u+1];m&&(h=h.replaceChild(0,m.type.create(m.attrs)));let g=r&&r[u]||f;if(!f.canReplace(p+1,f.childCount)||!g.type.validContent(h))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function PT(t,e,n=1,r){let i=t.doc.resolve(e),o=I.empty,s=I.empty;for(let l=i.depth,a=i.depth-n,c=n-1;l>a;l--,c--){o=I.from(i.node(l).copy(o));let u=r&&r[c];s=I.from(u?u.type.create(u.attrs,s):i.node(l).copy(s))}t.step(new Pe(e,e,new L(o.append(s),n,n),!0))}function Fr(t,e){let n=t.resolve(e),r=n.index();return Av(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function FT(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function Av(t,e){return!!(t&&e&&!t.isLeaf&&FT(t,e))}function ed(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,l=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),l++,s=r.node(i).maybeChild(l)):(o=r.node(i).maybeChild(l-1),s=r.node(i+1)),o&&!o.isTextblock&&Av(o,s)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function BT(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);u&&!f?r=!1:!u&&f&&(r=!0)}let l=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);Dv(t,u.node(),u.before(),l)}s.inlineContent&&hh(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let a=t.mapping.slice(l),c=a.map(e-n);if(t.step(new Pe(c,a.map(e+n,-1),L.empty,!0)),r===!0){let u=t.doc.resolve(c);jv(t,u.node(),u.before(),t.steps.length)}return t}function _T(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function Iv(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(a,a,i);else{let f=c.contentMatchAt(a).findWrapping(i.firstChild.type);u=f&&c.canReplaceWith(a,a,f[0])}if(u)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}function td(t,e,n=e,r=L.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return Rv(i,o,r)?new Pe(e,n,r):new HT(i,o,r).fit()}function Rv(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class HT{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=I.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=I.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new L(o,s,l);return e>-1?new Be(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new Pe(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=tu(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:c}=this.frontier[l],u,f=null;if(n==1&&(s?c.matchType(s.type)||(f=c.fillBefore(I.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(n==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=tu(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new L(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=tu(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new L(Ko(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new L(Ko(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,c=0,u=[],{match:f,type:p}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)u.push(i.child(g));f=f.matchFragment(i)}let h=l.size+e-(s.content.size-s.openEnd);for(;c<l.childCount;){let g=l.child(c),v=f.matchType(g.type);if(!v)break;c++,(c>1||a==0||g.content.size)&&(f=v,u.push(zv(g.mark(p.allowedMarks(g.marks)),c==1?a:0,c==l.childCount?h:-1)))}let m=c==l.childCount;m||(h=-1),this.placed=qo(this.placed,n,I.from(u)),this.frontier[n].match=f,m&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,v=l;g<h;g++){let y=v.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),v=y.content}this.unplaced=m?e==0?L.empty:new L(Ko(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new L(Ko(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!nu(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=nu(e,n,i,r,o);if(s){for(let l=n-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],u=nu(e,l,c,a,!0);if(!u||u.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=qo(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=qo(this.placed,this.depth,I.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(I.empty,!0);n.childCount&&(this.placed=qo(this.placed,this.frontier.length,n))}}function Ko(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ko(t.firstChild.content,e-1,n)))}function qo(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(qo(t.lastChild.content,e-1,n)))}function tu(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function zv(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,zv(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(I.empty,!0)))),t.copy(r)}function nu(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!UT(n,o.content,s)?l:null}function UT(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function VT(t){return t.spec.defining||t.spec.definingForContent}function WT(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(Rv(i,o,r))return t.step(new Pe(e,n,r));let s=Ov(i,o);s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let p=i.depth,h=i.pos-1;p>0;p--,h--){let m=i.node(p).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;s.indexOf(p)>-1?l=p:i.before(p)==h&&s.splice(1,0,-p)}let a=s.indexOf(l),c=[],u=r.openStart;for(let p=r.content,h=0;;h++){let m=p.firstChild;if(c.push(m),h==r.openStart)break;p=m.content}for(let p=u-1;p>=0;p--){let h=c[p],m=VT(h.type);if(m&&!h.sameMarkup(i.node(Math.abs(l)-1)))u=p;else if(m||!h.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let h=(p+u+1)%(r.openStart+1),m=c[h];if(m)for(let g=0;g<s.length;g++){let v=s[(g+a)%s.length],y=!0;v<0&&(y=!1,v=-v);let x=i.node(v-1),b=i.index(v-1);if(x.canReplaceWith(b,b,m.type,m.marks))return t.replace(i.before(v),y?o.after(v):n,new L($v(r.content,0,r.openStart,h),h,r.openEnd))}}let f=t.steps.length;for(let p=s.length-1;p>=0&&(t.replace(e,n,r),!(t.steps.length>f));p--){let h=s[p];h<0||(e=i.before(h),n=o.after(h))}}function $v(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy($v(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(I.empty,!0))}return t}function KT(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=_T(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new L(I.from(r),0,0))}function qT(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=Ov(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function Ov(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class ro extends ct{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return De.fromReplace(e,this.pos,this.pos+1,new L(I.from(i),0,n.isLeaf?0:1))}getMap(){return At.empty}invert(e){return new ro(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ro(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ro(n.pos,n.attr,n.value)}}ct.jsonID("attr",ro);class Ks extends ct{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return De.ok(r)}getMap(){return At.empty}invert(e){return new Ks(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ks(n.attr,n.value)}}ct.jsonID("docAttr",Ks);let ho=class extends Error{};ho=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};ho.prototype=Object.create(Error.prototype);ho.prototype.constructor=ho;ho.prototype.name="TransformError";class Nv{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ws}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new ho(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),n=i.map(n,-1)),i.forEach((o,s,l,a)=>{e=Math.min(e,l),n=Math.max(n,a)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=L.empty){let i=td(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new L(I.from(r),0,0))}delete(e,n){return this.replace(e,n,L.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return WT(this,e,n,r),this}replaceRangeWith(e,n,r){return KT(this,e,n,r),this}deleteRange(e,n){return qT(this,e,n),this}lift(e,n){return IT(this,e,n),this}join(e,n=1){return BT(this,e,n),this}wrap(e,n){return $T(this,e,n),this}setBlockType(e,n=e,r,i=null){return OT(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return LT(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new ro(e,n,r)),this}setDocAttribute(e,n){return this.step(new Ks(e,n)),this}addNodeMark(e,n){return this.step(new xr(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof ce)n.isInSet(r.marks)&&this.step(new yi(e,n));else{let i=r.marks,o,s=[];for(;o=n.isInSet(i);)s.push(new yi(e,o)),i=o.removeFromSet(i);for(let l=s.length-1;l>=0;l--)this.step(s[l])}return this}split(e,n=1,r){return PT(this,e,n,r),this}addMark(e,n,r){return jT(this,e,n,r),this}removeMark(e,n,r){return DT(this,e,n,r),this}clearIncompatible(e,n,r){return hh(this,e,n,r),this}}const ru=Object.create(null);class G{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new JT(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=L.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:c}=s[l],u=e.mapping.slice(o);e.replaceRange(u.map(a.pos),u.map(c.pos),l?L.empty:n),l==0&&Zg(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),c=a.map(s.pos),u=a.map(l.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),Zg(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new K(e):zi(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?zi(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):zi(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new zt(e.node(0))}static atStart(e){return zi(e,e,0,0,1)||new zt(e)}static atEnd(e){return zi(e,e,e.content.size,e.childCount,-1)||new zt(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=ru[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in ru)throw new RangeError("Duplicate use of selection JSON ID "+e);return ru[e]=n,n.prototype.jsonID=e,n}getBookmark(){return K.between(this.$anchor,this.$head).getBookmark()}}G.prototype.visible=!0;class JT{constructor(e,n){this.$from=e,this.$to=n}}let Qg=!1;function Xg(t){!Qg&&!t.parent.inlineContent&&(Qg=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class K extends G{constructor(e,n=e){Xg(e),Xg(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return G.near(r);let i=e.resolve(n.map(this.anchor));return new K(i.parent.inlineContent?i:r,r)}replace(e,n=L.empty){if(super.replace(e,n),n==L.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof K&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new nd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new K(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=G.findFrom(n,r,!0)||G.findFrom(n,-r,!0);if(o)n=o.$head;else return G.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(G.findFrom(e,-r,!0)||G.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new K(e,n)}}G.jsonID("text",K);class nd{constructor(e,n){this.anchor=e,this.head=n}map(e){return new nd(e.map(this.anchor),e.map(this.head))}resolve(e){return K.between(e.resolve(this.anchor),e.resolve(this.head))}}class V extends G{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?G.near(o):new V(o)}content(){return new L(I.from(this.node),0,0)}eq(e){return e instanceof V&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new gh(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new V(e.resolve(n.anchor))}static create(e,n){return new V(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}V.prototype.visible=!1;G.jsonID("node",V);class gh{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new nd(r,r):new gh(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&V.isSelectable(r)?new V(n):G.near(n)}}class zt extends G{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=L.empty){if(n==L.empty){e.delete(0,e.doc.content.size);let r=G.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new zt(e)}map(e){return new zt(e)}eq(e){return e instanceof zt}getBookmark(){return GT}}G.jsonID("all",zt);const GT={map(){return this},resolve(t){return new zt(t)}};function zi(t,e,n,r,i,o=!1){if(e.inlineContent)return K.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&V.isSelectable(l))return V.create(t,n-(i<0?l.nodeSize:0))}else{let a=zi(t,l,n+i,i<0?l.childCount:0,i,o);if(a)return a}n+=l.nodeSize*i}return null}function Zg(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Pe||i instanceof Be))return;let o=t.mapping.maps[r],s;o.forEach((l,a,c,u)=>{s==null&&(s=u)}),t.setSelection(G.near(t.doc.resolve(s),n))}const ey=1,Pl=2,ty=4;class YT extends Nv{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|ey)&~Pl,this.storedMarks=null,this}get selectionSet(){return(this.updated&ey)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Pl,this}ensureMarks(e){return ce.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Pl)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Pl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ce.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(G.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ty,this}get scrolledIntoView(){return(this.updated&ty)>0}}function ny(t,e){return!e||!t?t:t.bind(e)}class Jo{constructor(e,n,r){this.name=e,this.init=ny(n.init,r),this.apply=ny(n.apply,r)}}const QT=[new Jo("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Jo("selection",{init(t,e){return t.selection||G.atStart(e.doc)},apply(t){return t.selection}}),new Jo("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Jo("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class iu{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=QT.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Jo(r.key,r.spec.state,r))})}}class Ji{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,c=i?i[s].state:this,u=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Ji(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new YT(this)}static create(e){let n=new iu(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ji(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new iu(this.schema,e.plugins),r=n.fields,i=new Ji(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new iu(e.schema,e.plugins),o=new Ji(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=jr.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=G.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],c=a.spec.state;if(a.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){o[s.name]=c.fromJSON.call(a,e,n[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function Lv(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Lv(i,e,{})),n[r]=i}return n}class et{constructor(e){this.spec=e,this.props={},e.props&&Lv(e.props,this,this.props),this.key=e.key?e.key.key:Pv("plugin")}getState(e){return e[this.key]}}const ou=Object.create(null);function Pv(t){return t in ou?t+"$"+ ++ou[t]:(ou[t]=0,t+"$")}class Pt{constructor(e="key"){this.key=Pv(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Je=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},mo=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Ff=null;const Ln=function(t,e,n){let r=Ff||(Ff=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},XT=function(){Ff=null},xi=function(t,e,n,r){return n&&(ry(t,e,n,r,-1)||ry(t,e,n,r,1))},ZT=/^(img|br|input|textarea|hr)$/i;function ry(t,e,n,r,i){for(var o;;){if(t==n&&e==r)return!0;if(e==(i<0?0:qt(t))){let s=t.parentNode;if(!s||s.nodeType!=1||dl(t)||ZT.test(t.nodeName)||t.contentEditable=="false")return!1;e=Je(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?qt(t):0}else return!1}}function qt(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ej(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=qt(t)}else if(t.parentNode&&!dl(t))e=Je(t),t=t.parentNode;else return null}}function tj(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!dl(t))e=Je(t)+1,t=t.parentNode;else return null}}function nj(t,e,n){for(let r=e==0,i=e==qt(t);r||i;){if(t==n)return!0;let o=Je(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==qt(t)}}function dl(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const rd=function(t){return t.focusNode&&xi(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Kr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function rj(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function ij(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(qt(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(qt(r.startContainer),r.startOffset)}}}const jn=typeof navigator<"u"?navigator:null,iy=typeof document<"u"?document:null,Br=jn&&jn.userAgent||"",Bf=/Edge\/(\d+)/.exec(Br),Fv=/MSIE \d/.exec(Br),_f=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Br),kt=!!(Fv||_f||Bf),Dr=Fv?document.documentMode:_f?+_f[1]:Bf?+Bf[1]:0,Qt=!kt&&/gecko\/(\d+)/i.test(Br);Qt&&+(/Firefox\/(\d+)/.exec(Br)||[0,0])[1];const Hf=!kt&&/Chrome\/(\d+)/.exec(Br),Ye=!!Hf,Bv=Hf?+Hf[1]:0,at=!kt&&!!jn&&/Apple Computer/.test(jn.vendor),go=at&&(/Mobile\/\w+/.test(Br)||!!jn&&jn.maxTouchPoints>2),Vt=go||(jn?/Mac/.test(jn.platform):!1),_v=jn?/Win/.test(jn.platform):!1,_n=/Android \d/.test(Br),ul=!!iy&&"webkitFontSmoothing"in iy.documentElement.style,oj=ul?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function sj(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Rn(t,e){return typeof t=="number"?t:t[e]}function lj(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function oy(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=mo(s);continue}let l=s,a=l==o.body,c=a?sj(o):lj(l),u=0,f=0;if(e.top<c.top+Rn(r,"top")?f=-(c.top-e.top+Rn(i,"top")):e.bottom>c.bottom-Rn(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+Rn(i,"top")-c.top:e.bottom-c.bottom+Rn(i,"bottom")),e.left<c.left+Rn(r,"left")?u=-(c.left-e.left+Rn(i,"left")):e.right>c.right-Rn(r,"right")&&(u=e.right-c.right+Rn(i,"right")),u||f)if(a)o.defaultView.scrollBy(u,f);else{let h=l.scrollLeft,m=l.scrollTop;f&&(l.scrollTop+=f),u&&(l.scrollLeft+=u);let g=l.scrollLeft-h,v=l.scrollTop-m;e={left:e.left-g,top:e.top-v,right:e.right-g,bottom:e.bottom-v}}let p=a?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(p))break;s=p=="absolute"?s.offsetParent:mo(s)}}function aj(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=t.root.elementFromPoint(o,s);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Hv(t.dom)}}function Hv(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=mo(r));return e}function cj({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;Uv(n,r==0?0:r-e)}function Uv(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Ii=null;function dj(t){if(t.setActive)return t.setActive();if(Ii)return t.focus(Ii);let e=Hv(t);t.focus(Ii==null?{get preventScroll(){return Ii={preventScroll:!0},!0}}:void 0),Ii||(Ii=!1,Uv(e,0))}function Vv(t,e){let n,r=2e8,i,o=0,s=e.top,l=e.top,a,c;for(let u=t.firstChild,f=0;u;u=u.nextSibling,f++){let p;if(u.nodeType==1)p=u.getClientRects();else if(u.nodeType==3)p=Ln(u).getClientRects();else continue;for(let h=0;h<p.length;h++){let m=p[h];if(m.top<=s&&m.bottom>=l){s=Math.max(m.bottom,s),l=Math.min(m.top,l);let g=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(g<r){n=u,r=g,i=g&&n.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&g&&(o=f+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!a&&m.left<=e.left&&m.right>=e.left&&(a=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!n&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(o=f+1)}}return!n&&a&&(n=a,i=c,r=0),n&&n.nodeType==3?uj(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:Vv(n,i)}function uj(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=ir(r,1);if(s.top!=s.bottom&&yh(e,s)){i={node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function yh(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function fj(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function pj(t,e,n){let{node:r,offset:i}=Vv(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function hj(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let l=t.docView.nearestDesc(o,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!s&&a.left>r.left||a.top>r.top?i=l.posBefore:(!s&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),s=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;o=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function Wv(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let c=l[a];if(yh(e,c))return Wv(s,e,c)}}if((o=(o+1)%r)==i)break}return t}function mj(t,e){let n=t.dom.ownerDocument,r,i=0,o=ij(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!yh(e,c)||(s=Wv(t.dom,e,c),!s))return null}if(at)for(let c=s;r&&c;c=mo(c))c.draggable&&(r=void 0);if(s=fj(s,e),r){if(Qt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let c;ul&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=hj(t,r,i,e))}l==null&&(l=pj(t,s,e));let a=t.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function sy(t){return t.top<t.bottom||t.left<t.right}function ir(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(sy(r))return r}return Array.prototype.find.call(n,sy)||t.getBoundingClientRect()}const gj=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Kv(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=ul||Qt;if(r.nodeType==3)if(s&&(gj.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=ir(Ln(r,i,i),n);if(Qt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=ir(Ln(r,i-1,i-1),-1);if(c.top==a.top){let u=ir(Ln(r,i,i+1),-1);if(u.top!=a.top)return Fo(u,u.left<c.left)}}return a}else{let a=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(a--,u=1):n<0?a--:c++,Fo(ir(Ln(r,a,c),u),u<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==qt(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return su(a.getBoundingClientRect(),!1)}if(o==null&&i<qt(r)){let a=r.childNodes[i];if(a.nodeType==1)return su(a.getBoundingClientRect(),!0)}return su(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==qt(r))){let a=r.childNodes[i-1],c=a.nodeType==3?Ln(a,qt(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(c)return Fo(ir(c,1),!1)}if(o==null&&i<qt(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let c=a?a.nodeType==3?Ln(a,0,s?0:1):a.nodeType==1?a:null:null;if(c)return Fo(ir(c,-1),!0)}return Fo(ir(r.nodeType==3?Ln(r):r,-n),n>=0)}function Fo(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function su(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function qv(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function yj(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return qv(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=Kv(t,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Ln(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<a.length;c++){let u=a[c];if(u.bottom>u.top+1&&(n=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const xj=/[\u0590-\u08ac]/;function vj(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=t.domSelection();return l?!xj.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?o:s:qv(t,e,()=>{let{focusNode:a,focusOffset:c,anchorNode:u,anchorOffset:f}=t.domSelectionRange(),p=l.caretBidiLevel;l.modify("move",n,"character");let h=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:m,focusOffset:g}=t.domSelectionRange(),v=m&&!h.contains(m.nodeType==1?m:m.parentNode)||a==m&&c==g;try{l.collapse(u,f),a&&(a!=u||c!=f)&&l.extend&&l.extend(a,c)}catch{}return p!=null&&(l.caretBidiLevel=p),v}):r.pos==r.start()||r.pos==r.end()}let ly=null,ay=null,cy=!1;function bj(t,e,n){return ly==e&&ay==n?cy:(ly=e,ay=n,cy=n=="up"||n=="down"?yj(t,e,n):vj(t,e,n))}const Xt=0,dy=1,Xr=2,Dn=3;class fl{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Xt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>Je(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let l=i.children[s];if(l.size){i=l;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof Gv){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Jv&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?Je(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?Je(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],c=s+a.size;if(i==-1&&e<=c){let u=s+a.border;if(e>=u&&n<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,u);e=s;for(let f=l;f>0;f--){let p=this.children[f-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=Je(p.dom)+1;break}e-=p.size}i==-1&&(i=0)}if(i>-1&&(c>n||l==this.children.length-1)){n=c;for(let u=l+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=Je(f.dom);break}n+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let h=0,m=0;h<this.children.length;h++){let g=this.children[h],v=m+g.size;if(o>m&&s<v)return g.setSelection(e-m-g.border,n-m-g.border,r,i);m=v}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),f=!1;if((Qt||at)&&e==n){let{node:h,offset:m}=l;if(h.nodeType==3){if(f=!!(m&&h.nodeValue[m-1]==`
`),f&&m==h.nodeValue.length)for(let g=h,v;g;g=g.parentNode){if(v=g.nextSibling){v.nodeName=="BR"&&(l=a={node:v.parentNode,offset:Je(v)+1});break}let y=g.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let g=h.childNodes[m-1];f=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(Qt&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let h=u.focusNode.childNodes[u.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||f&&at)&&xi(l.node,l.offset,u.anchorNode,u.anchorOffset)&&xi(a.node,a.offset,u.focusNode,u.focusOffset))return;let p=!1;if((c.extend||e==n)&&!(f&&Qt)){c.collapse(l.node,l.offset);try{e!=n&&c.extend(a.node,a.offset),p=!0}catch{}}if(!p){if(e>n){let m=l;l=a,a=m}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let l=r+o.border,a=s-o.border;if(e>=l&&n<=a){this.dirty=e==r||n==s?Xr:dy,e==l&&n==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Dn:o.markDirty(e-l,n-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Xr:Dn}r=s}this.dirty=Xr}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Xr:dy;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Jv extends fl{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==Xt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Sj extends fl{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class vi extends fl{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=ki.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new vi(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Dn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Dn&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Xt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Xt}}slice(e,n,r){let i=vi.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=Vf(o,n,s,r)),e>0&&(o=Vf(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ar extends fl{constructor(e,n,r,i,o,s,l,a,c){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,o,s){let l=o.nodeViews[n.type.name],a,c=l&&l(n,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),u=c&&c.dom,f=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=ki.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!f&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let p=u;return u=Xv(u,r,n),c?a=new wj(e,n,r,i,u,f||null,p,c,o,s+1):n.isText?new id(e,n,r,i,u,p,o):new Ar(e,n,r,i,u,f||null,p,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>I.empty)}return e}matchesNode(e,n,r){return this.dirty==Xt&&e.eq(this.node)&&Ja(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new Cj(this,s&&s.node,e);Tj(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?a.syncToMarks(c.spec.marks,r,e,u):c.type.side>=0&&!f&&a.syncToMarks(u==this.node.childCount?ce.none:this.node.child(u).marks,r,e,u),a.placeWidget(c,e,i)},(c,u,f,p)=>{a.syncToMarks(c.marks,r,e,p);let h;a.findNodeMatch(c,u,f,p)||l&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(h=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(c,u,f,h,e)||a.updateNextNode(c,u,f,e,p,i)||a.addNode(c,u,f,e,i),i+=c.nodeSize}),a.syncToMarks([],r,e,0),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==Xr)&&(s&&this.protectLocalComposition(e,s),Yv(this.contentDOM,this.children,e),go&&jj(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof K)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,l=Dj(this.node.content,s,r-n,i-n);return l<0?null:{node:o,pos:l,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new Sj(this,o,n,i);e.input.compositionNodes.push(s),this.children=Vf(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Dn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Xt}updateOuterDeco(e){if(Ja(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Qv(this.dom,this.nodeDOM,Uf(this.outerDeco,this.node,n),Uf(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function uy(t,e,n,r,i){Xv(r,e,t);let o=new Ar(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class id extends Ar{constructor(e,n,r,i,o,s,l){super(e,n,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Dn||this.dirty!=Xt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Xt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Xt,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new id(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Dn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Gv extends fl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Xt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class wj extends Ar{constructor(e,n,r,i,o,s,l,a,c,u){super(e,n,r,i,o,s,l,c,u),this.spec=a}update(e,n,r,i){if(this.dirty==Dn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Yv(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==t){for(;l!=r;)r=fy(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(s instanceof vi){let a=r?r.previousSibling:t.lastChild;Yv(s.contentDOM,s.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=fy(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const fs=function(t){t&&(this.nodeName=t)};fs.prototype=Object.create(null);const Zr=[new fs];function Uf(t,e,n){if(t.length==0)return Zr;let r=n?Zr[0]:new fs,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new fs(s.nodeName));for(let l in s){let a=s[l];a!=null&&(n&&i.length==1&&i.push(r=new fs(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Qv(t,e,n,r){if(n==Zr&&r==Zr)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=n[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=Zr[0]),i=a}kj(i,l||Zr[0],s)}return i}function kj(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function Xv(t,e,n){return Qv(t,t,Zr,Uf(e,n,t.nodeType!=1))}function Ja(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function fy(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Cj{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Ej(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,i){let o=0,s=this.stack.length>>1,l=Math.min(s,e.length);for(;o<l&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=Xt,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1,c=this.top.children.length;i<this.preMatch.index&&(c=Math.min(this.index+3,c));for(let u=this.index;u<c;u++){let f=this.top.children[u];if(f.matchesMark(e[s])&&!this.isLocked(f.dom)){a=u;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let u=vi.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let c=this.top.children[l];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Dn&&s.dom==s.contentDOM&&(s.dirty=Xr),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Ar){let c=this.preMatch.matched.get(a);if(c!=null&&c!=o)return!1;let u=a.dom,f,p=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Dn&&Ja(n,a.outerDeco));if(!p&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!p&&(f=this.recreateWrapper(a,e,n,r,i,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Xr,f.updateChildren(i,s+1),f.dirty=Xt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Ja(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=Ar.create(this.top,n,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,o){let s=Ar.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new Jv(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof vi;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof id)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((at||Ye)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Gv(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Ej(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let c=n.children[r-1];if(c instanceof vi)n=c,r=c.children.length;else{l=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function Mj(t,e){return t.type.side-e.type.side}function Tj(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,l=[],a=null;for(let c=0;;){let u,f;for(;s<i.length&&i[s].to==o;){let v=i[s++];v.widget&&(u?(f||(f=[u])).push(v):u=v)}if(u)if(f){f.sort(Mj);for(let v=0;v<f.length;v++)n(f[v],c,!!a)}else n(u,c,!!a);let p,h;if(a)h=-1,p=a,a=null;else if(c<t.childCount)h=c,p=t.child(c++);else break;for(let v=0;v<l.length;v++)l[v].to<=o&&l.splice(v--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let m=o+p.nodeSize;if(p.isText){let v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(let y=0;y<l.length;y++)l[y].to<v&&(v=l[y].to);v<m&&(a=p.cut(v-o),p=p.cut(0,v-o),m=v,h=-1)}else for(;s<i.length&&i[s].to<m;)s++;let g=p.isInline&&!p.isLeaf?l.filter(v=>!v.inline):l.slice();r(p,g,e.forChild(o,p),h),o=m}}function jj(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function Dj(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<t.childCount;){let c=t.child(i++);if(o+=c.nodeSize,!c.isText)break;a+=c.text}if(o>=n){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let c=l<r?a.lastIndexOf(e,r-l-1):-1;if(c>=0&&c+e.length+l>=n)return l+c;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Vf(t,e,n,r,i){let o=[];for(let s=0,l=0;s<t.length;s++){let a=t[s],c=l,u=l+=a.size;c>=n||u<=e?o.push(a):(c<e&&o.push(a.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>n&&o.push(a.slice(n-c,a.size,r)))}return o}function xh(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,c;if(rd(n)){for(a=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&V.isSelectable(f)&&i.parent&&!(f.isInline&&nj(n.focusNode,n.focusOffset,i.dom))){let p=i.posBefore;c=new V(s==p?l:r.resolve(p))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=s,p=s;for(let h=0;h<n.rangeCount;h++){let m=n.getRangeAt(h);f=Math.min(f,t.docView.posFromDOM(m.startContainer,m.startOffset,1)),p=Math.max(p,t.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(f<0)return null;[a,s]=p==t.state.selection.anchor?[p,f]:[f,p],l=r.resolve(s)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!c){let f=e=="pointer"||t.state.selection.head<l.pos&&!o?1:-1;c=vh(t,u,l,f)}return c}function Zv(t){return t.editable?t.hasFocus():tb(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Vn(t,e=!1){let n=t.state.selection;if(eb(t,n),!!Zv(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ye){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&xi(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Ij(t);else{let{anchor:r,head:i}=n,o,s;py&&!(n instanceof K)&&(n.$from.parent.inlineContent||(o=hy(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=hy(t,n.to))),t.docView.setSelection(r,i,t,e),py&&(o&&my(o),s&&my(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Aj(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const py=at||Ye&&Bv<63;function hy(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(at&&i&&i.contentEditable=="false")return lu(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return lu(i);if(o)return lu(o)}}function lu(t){return t.contentEditable="true",at&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function my(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Aj(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Zv(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Ij(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Je(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&kt&&Dr<=11&&(n.disabled=!0,n.disabled=!1)}function eb(t,e){if(e instanceof V){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(gy(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else gy(t)}function gy(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function vh(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||K.between(e,n,r)}function yy(t){return t.editable&&!t.hasFocus()?!1:tb(t)}function tb(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Rj(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return xi(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Wf(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&G.findFrom(o,e)}function ar(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function xy(t,e,n){let r=t.state.selection;if(r instanceof K)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return ar(t,new K(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Wf(t.state,e);return i&&i instanceof V?ar(t,i):!1}else if(!(Vt&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM?V.isSelectable(o)?ar(t,new V(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):ul?ar(t,new K(t.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof V&&r.node.isInline)return ar(t,new K(e>0?r.$to:r.$from));{let i=Wf(t.state,e);return i?ar(t,i):!1}}}function Ga(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ps(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ri(t,e){return e<0?zj(t):$j(t)}function zj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(Qt&&n.nodeType==1&&r<Ga(n)&&ps(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(ps(l,-1))i=n,o=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(nb(n))break;{let l=n.previousSibling;for(;l&&ps(l,-1);)i=n.parentNode,o=Je(l),l=l.previousSibling;if(l)n=l,r=Ga(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Kf(t,n,r):i&&Kf(t,i,o)}function $j(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Ga(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(ps(l,1))o=n,s=++r;else break}else{if(nb(n))break;{let l=n.nextSibling;for(;l&&ps(l,1);)o=l.parentNode,s=Je(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=Ga(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&Kf(t,o,s)}function nb(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Oj(t,e){for(;t&&e==t.childNodes.length&&!dl(t);)e=Je(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function Nj(t,e){for(;t&&!e&&!dl(t);)e=Je(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Kf(t,e,n){if(e.nodeType!=3){let o,s;(s=Oj(e,n))?(e=s,n=0):(o=Nj(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(rd(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Vn(t)},50)}function vy(t,e){let n=t.state.doc.resolve(e);if(!(Ye||_v)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function by(t,e,n){let r=t.state.selection;if(r instanceof K&&!r.empty||n.indexOf("s")>-1||Vt&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Wf(t.state,e);if(s&&s instanceof V)return ar(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof zt?G.near(s,e):G.findFrom(s,e);return l?ar(t,l):!1}return!1}function Sy(t,e){if(!(t.state.selection instanceof K))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function wy(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Lj(t){if(!at||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;wy(t,r,"true"),setTimeout(()=>wy(t,r,"false"),20)}return!1}function Pj(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Fj(t,e){let n=e.keyCode,r=Pj(e);if(n==8||Vt&&n==72&&r=="c")return Sy(t,-1)||Ri(t,-1);if(n==46&&!e.shiftKey||Vt&&n==68&&r=="c")return Sy(t,1)||Ri(t,1);if(n==13||n==27)return!0;if(n==37||Vt&&n==66&&r=="c"){let i=n==37?vy(t,t.state.selection.from)=="ltr"?-1:1:-1;return xy(t,i,r)||Ri(t,i)}else if(n==39||Vt&&n==70&&r=="c"){let i=n==39?vy(t,t.state.selection.from)=="ltr"?1:-1:1;return xy(t,i,r)||Ri(t,i)}else{if(n==38||Vt&&n==80&&r=="c")return by(t,-1,r)||Ri(t,-1);if(n==40||Vt&&n==78&&r=="c")return Lj(t)||by(t,1,r)||Ri(t,1);if(r==(Vt?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function bh(t,e){t.someProp("transformCopied",h=>{e=h(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;n.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=t.someProp("clipboardSerializer")||ki.fromSchema(t.state.schema),l=ab(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let c=a.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=lb[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let m=l.createElement(u[h]);for(;a.firstChild;)m.appendChild(a.firstChild);a.appendChild(m),f++}c=a.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(n)}`);let p=t.someProp("clipboardTextSerializer",h=>h(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:p,slice:e}}function rb(t,e,n,r,i){let o=i.parent.type.spec.code,s,l;if(!n&&!e)return null;let a=!!e&&(r||o||!n);if(a){if(t.someProp("transformPastedText",p=>{e=p(e,o||r,t)}),o)return l=new L(I.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",p=>{l=p(l,t,!0)}),l;let f=t.someProp("clipboardTextParser",p=>p(e,i,r,t));if(f)l=f;else{let p=i.marks(),{schema:h}=t.state,m=ki.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let v=s.appendChild(document.createElement("p"));g&&v.appendChild(m.serializeNode(h.text(g,p)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),s=Uj(n),ul&&Vj(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let p=s.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;s=p}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||ds.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||u),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!Bj.test(p.parentNode.nodeName)?{ignore:!0}:null}})),u)l=Wj(ky(l,+u[1],+u[2]),u[4]);else if(l=L.maxOpen(_j(l.content,i),!0),l.openStart||l.openEnd){let f=0,p=0;for(let h=l.content.firstChild;f<l.openStart&&!h.type.spec.isolating;f++,h=h.firstChild);for(let h=l.content.lastChild;p<l.openEnd&&!h.type.spec.isolating;p++,h=h.lastChild);l=ky(l,f,p)}return t.someProp("transformPasted",f=>{l=f(l,t,a)}),l}const Bj=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function _j(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),c;if(!a)return s=null;if(c=s.length&&o.length&&ob(a,o,l,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=sb(s[s.length-1],o.length));let u=ib(l,a);s.push(u),i=i.matchType(u.type),o=a}}),s)return I.from(s)}return t}function ib(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,I.from(t));return t}function ob(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=ob(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(I.from(ib(n,t,i+1))))}}function sb(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,sb(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(I.empty,!0);return t.copy(n.append(r))}function qf(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,l=s.content;return t.childCount>1&&(o=0),i<r-1&&(l=qf(l,e,n,r,i+1,o)),i>=n&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(I.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(l))}function ky(t,e,n){return e<t.openStart&&(t=new L(qf(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new L(qf(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const lb={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Cy=null;function ab(){return Cy||(Cy=document.implementation.createHTMLDocument("title"))}let au=null;function Hj(t){let e=window.trustedTypes;return e?(au||(au=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),au.createHTML(t)):t}function Uj(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=ab().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&lb[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=Hj(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function Vj(t){let e=t.querySelectorAll(Ye?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Wj(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=I.from(a.create(r[l+1],i)),o++,s++}return new L(i,o,s)}const ft={},pt={},Kj={touchstart:!0,touchmove:!0};class qj{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Jj(t){for(let e in ft){let n=ft[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Yj(t,r)&&!Sh(t,r)&&(t.editable||!(r.type in pt))&&n(t,r)},Kj[e]?{passive:!0}:void 0)}at&&t.dom.addEventListener("input",()=>null),Jf(t)}function vr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Gj(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Jf(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Sh(t,r))})}function Sh(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Yj(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Qj(t,e){!Sh(t,e)&&ft[e.type]&&(t.editable||!(e.type in pt))&&ft[e.type](t,e)}pt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!db(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(_n&&Ye&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),go&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Kr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Fj(t,n)?n.preventDefault():vr(t,"key")};pt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};pt.keypress=(t,e)=>{let n=e;if(db(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Vt&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof K)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i,o))&&t.dispatch(o()),n.preventDefault()}};function od(t){return{left:t.clientX,top:t.clientY}}function Xj(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function wh(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,l=>s>o.depth?l(t,n,o.nodeAfter,o.before(s),i,!0):l(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function io(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Zj(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&V.isSelectable(r)?(io(t,new V(n)),!0):!1}function eD(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof V&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(V.isSelectable(l)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(io(t,V.create(t.state.doc,i)),!0):!1}function tD(t,e,n,r,i){return wh(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?eD(t,n):Zj(t,n))}function nD(t,e,n,r){return wh(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function rD(t,e,n,r){return wh(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||iD(t,n,r)}function iD(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(io(t,K.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)io(t,K.create(r,l+1,l+1+s.content.size));else if(V.isSelectable(s))io(t,V.create(r,l));else continue;return!0}}function kh(t){return Ya(t)}const cb=Vt?"metaKey":"ctrlKey";ft.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=kh(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&Xj(n,t.input.lastClick)&&!n[cb]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o,button:n.button};let s=t.posAtCoords(od(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new oD(t,s,n,!!r)):(o=="doubleClick"?nD:rD)(t,s.pos,s.inside,n)?n.preventDefault():vr(t,"pointer"))};class oD{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[cb],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let u=e.state.doc.resolve(n.pos);o=u.parent,s=u.depth?u.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.nodeDOM.nodeType==1?a.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof V&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Qt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),vr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Vn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(od(e))),this.updateAllowDefault(e),this.allowDefault||!n?vr(this.view,"pointer"):tD(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||at&&this.mightDrag&&!this.mightDrag.node.isAtom||Ye&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(io(this.view,G.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):vr(this.view,"pointer")}move(e){this.updateAllowDefault(e),vr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ft.touchstart=t=>{t.input.lastTouch=Date.now(),kh(t),vr(t,"pointer")};ft.touchmove=t=>{t.input.lastTouch=Date.now(),vr(t,"pointer")};ft.contextmenu=t=>kh(t);function db(t,e){return t.composing?!0:at&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const sD=_n?5e3:-1;pt.compositionstart=pt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof K&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Ye&&_v&&lD(t)))t.markCursor=t.state.storedMarks||n.marks(),Ya(t,!0),t.markCursor=null;else if(Ya(t,!e.selection.empty),Qt&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=t.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}ub(t,sD)};function lD(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}pt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,ub(t,20))};function ub(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Ya(t),e))}function fb(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=cD());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function aD(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=ej(e.focusNode,e.focusOffset),r=tj(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function cD(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Ya(t,e=!1){if(!(_n&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),fb(t),e||t.docView&&t.docView.dirty){let n=xh(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function dD(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const qs=kt&&Dr<15||go&&oj<604;ft.copy=pt.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=qs?null:n.clipboardData,s=r.content(),{dom:l,text:a}=bh(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):dD(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function uD(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function fD(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Js(t,r.value,null,i,e):Js(t,r.textContent,r.innerHTML,i,e)},50)}function Js(t,e,n,r,i){let o=rb(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,o||L.empty)))return!0;if(!o)return!1;let s=uD(o),l=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function pb(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}pt.paste=(t,e)=>{let n=e;if(t.composing&&!_n)return;let r=qs?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Js(t,pb(r),r.getData("text/html"),i,n)?n.preventDefault():fD(t,n)};class hb{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const pD=Vt?"altKey":"ctrlKey";function mb(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[pD]}ft.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(od(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof V?i.to-1:i.to))){if(r&&r.mightDrag)s=V.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=V.create(t.state.doc,f.posBefore))}}let l=(s||t.state.selection).content(),{dom:a,text:c,slice:u}=bh(t,l);(!n.dataTransfer.files.length||!Ye||Bv>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(qs?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",qs||n.dataTransfer.setData("text/plain",c),t.dragging=new hb(u,mb(t,n),s)};ft.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};pt.dragover=pt.dragenter=(t,e)=>e.preventDefault();pt.drop=(t,e)=>{try{hD(t,e,t.dragging)}finally{t.dragging=null}};function hD(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(od(e));if(!r)return;let i=t.state.doc.resolve(r.pos),o=n&&n.slice;o?t.someProp("transformPasted",h=>{o=h(o,t,!1)}):o=rb(t,pb(e.dataTransfer),qs?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(n&&mb(t,e));if(t.someProp("handleDrop",h=>h(t,e,o||L.empty,s))){e.preventDefault();return}if(!o)return;e.preventDefault();let l=o?Iv(t.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(s){let{node:h}=n;h?h.replace(a):a.deleteSelection()}let c=a.mapping.map(l),u=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=a.doc;if(u?a.replaceRangeWith(c,c,o.content.firstChild):a.replaceRange(c,c,o),a.doc.eq(f))return;let p=a.doc.resolve(c);if(u&&V.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))a.setSelection(new V(p));else{let h=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((m,g,v,y)=>h=y),a.setSelection(vh(t,p,a.doc.resolve(h)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))}ft.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Vn(t)},20))};ft.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};ft.beforeinput=(t,e)=>{if(Ye&&_n&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Kr(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in pt)ft[t]=pt[t];function Gs(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Qa{constructor(e,n){this.toDOM=e,this.spec=n||si,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new Gt(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Qa&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Gs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ir{constructor(e,n){this.attrs=e,this.spec=n||si}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Gt(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ir&&Gs(this.attrs,e.attrs)&&Gs(this.spec,e.spec)}static is(e){return e.type instanceof Ir}destroy(){}}class Ch{constructor(e,n){this.attrs=e,this.spec=n||si}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Gt(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof Ch&&Gs(this.attrs,e.attrs)&&Gs(this.spec,e.spec)}destroy(){}}class Gt{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Gt(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Gt(e,e,new Qa(n,r))}static inline(e,n,r,i){return new Gt(e,n,new Ir(r,i))}static node(e,n,r,i){return new Gt(e,n,new Ch(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ir}get widget(){return this.type instanceof Qa}}const $i=[],si={};class Re{constructor(e,n){this.local=e.length?e:$i,this.children=n.length?n:$i}static create(e,n){return n.length?Xa(n,e,0,si):ot}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=n&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,n-l,r,i+l,o)}}map(e,n,r){return this==ot||e.maps.length==0?this:this.mapInner(e,n,0,0,r||si)}mapInner(e,n,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?mD(this.children,s||[],e,n,r,i,o):s?new Re(s.sort(li),$i):ot}add(e,n){return n.length?this==ot?Re.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((l,a)=>{let c=a+r,u;if(u=yb(n,l,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,u,c+1):i.splice(o,0,a,a+l.nodeSize,Xa(u,l,c+1,si)),o+=3}});let s=gb(o?xb(n):n,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new Re(s.length?this.local.concat(s).sort(li):this.local,i||this.children)}remove(e){return e.length==0||this==ot?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+n,a=r[o+1]+n;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>l&&f.to<a&&(e[u]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,l+1);c!=ot?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Re(i,r):ot}forChild(e,n){if(this==ot)return this;if(n.isLeaf)return Re.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof Ir){let c=Math.max(o,a.from)-o,u=Math.min(s,a.to)-o;c<u&&(i||(i=[])).push(a.copy(c,u))}}if(i){let l=new Re(i.sort(li),$i);return r?new pr([l,r]):l}return r||ot}eq(e){if(this==e)return!0;if(!(e instanceof Re)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Eh(this.localsInner(e))}localsInner(e){if(this==ot)return $i;if(e.inlineContent||!this.local.some(Ir.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ir||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Re.empty=new Re([],[]);Re.removeOverlap=Eh;const ot=Re.empty;class pr{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,si));return pr.from(r)}forChild(e,n){if(n.isLeaf)return Re.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=ot&&(o instanceof pr?r=r.concat(o.members):r.push(o))}return pr.from(r)}eq(e){if(!(e instanceof pr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?Eh(r?n:n.sort(li)):$i}static from(e){switch(e.length){case 0:return ot;case 1:return e[0];default:return new pr(e.every(n=>n instanceof Re)?e:e.reduce((n,r)=>n.concat(r instanceof Re?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function mD(t,e,n,r,i,o,s){let l=t.slice();for(let c=0,u=o;c<n.maps.length;c++){let f=0;n.maps[c].forEach((p,h,m,g)=>{let v=g-m-(h-p);for(let y=0;y<l.length;y+=3){let x=l[y+1];if(x<0||p>x+u-f)continue;let b=l[y]+u-f;h>=b?l[y+1]=p<=b?-2:-1:p>=u&&v&&(l[y]+=v,l[y+1]+=v)}f+=v}),u=n.maps[c].map(u,-1)}let a=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){a=!0,l[c+1]=-1;continue}let u=n.map(t[c]+o),f=u-i;if(f<0||f>=r.content.size){a=!0;continue}let p=n.map(t[c+1]+o,-1),h=p-i,{index:m,offset:g}=r.content.findIndex(f),v=r.maybeChild(m);if(v&&g==f&&g+v.nodeSize==h){let y=l[c+2].mapInner(n,v,u+1,t[c]+o+1,s);y!=ot?(l[c]=f,l[c+1]=h,l[c+2]=y):(l[c+1]=-2,a=!0)}else a=!0}if(a){let c=gD(l,t,e,n,i,o,s),u=Xa(c,r,0,s);e=u.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,p=0;f<u.children.length;f+=3){let h=u.children[f];for(;p<l.length&&l[p]<h;)p+=3;l.splice(p,0,u.children[f],u.children[f+1],u.children[f+2])}}return new Re(e.sort(li),l)}function gb(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new Gt(i.from+e,i.to+e,i.type))}return n}function gD(t,e,n,r,i,o,s){function l(a,c){for(let u=0;u<a.local.length;u++){let f=a.local[u].map(r,i,c);f?n.push(f):s.onRemove&&s.onRemove(a.local[u].spec)}for(let u=0;u<a.children.length;u+=3)l(a.children[u+2],a.children[u]+c+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+o+1);return n}function yb(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function xb(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Xa(t,e,n,r){let i=[],o=!1;e.forEach((l,a)=>{let c=yb(t,l,a+n);if(c){o=!0;let u=Xa(c,l,n+a+1,r);u!=ot&&i.push(a,a+l.nodeSize,u)}});let s=gb(o?xb(t):t,-n).sort(li);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new Re(s,i):ot}function li(t,e){return t.from-e.from||t.to-e.to}function Eh(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),Ey(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),Ey(e,i,r.copy(o.from,r.to)));break}}}return e}function Ey(t,e,n){for(;e<t.length&&li(n,t[e])>0;)e++;t.splice(e,0,n)}function cu(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=ot&&e.push(r)}),t.cursorWrapper&&e.push(Re.create(t.state.doc,[t.cursorWrapper.deco])),pr.from(e)}const yD={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},xD=kt&&Dr<=11;class vD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class bD{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new vD,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);kt&&Dr<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():at&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),xD&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yD)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(yy(this.view)){if(this.suppressingSelectionUpdates)return Vn(this.view);if(kt&&Dr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&xi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=mo(o))n.add(o);for(let o=e.anchorNode;o;o=mo(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&yy(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let u=0;u<n.length;u++){let f=this.registerMutation(n[u],a);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(a.some(u=>u.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let u of a)if(u.nodeName=="BR"&&u.parentNode){let f=u.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&u.parentNode.removeChild(u)}}else if(Qt&&a.length){let u=a.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,p]=u;f.parentNode&&f.parentNode.parentNode==p.parentNode?p.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let p of u){let h=p.parentNode;h&&h.nodeName=="LI"&&(!f||kD(e,f)!=h)&&p.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&rd(r)&&(c=xh(e))&&c.eq(G.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Vn(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),SD(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,CD(e,a)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Vn(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(kt&&Dr<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:p}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(o=p)}let s=i&&i.parentNode==e.target?Je(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?Je(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,a,1);return{from:l,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let My=new WeakMap,Ty=!1;function SD(t){if(!My.has(t)&&(My.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Qt,Ty)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Ty=!0}}function jy(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return xi(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function wD(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return jy(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?jy(t,n):null}function kD(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function CD(t,e){var n;let{focusNode:r,focusOffset:i}=t.domSelectionRange();for(let o of e)if(((n=o.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let s=o.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let l=s;for(;;){let a=l.firstChild;if(!a||a.nodeType!=1||a.contentEditable=="false"||/^(BR|IMG)$/.test(a.nodeName))break;l=a}l.insertBefore(o,l.firstChild),r==o&&t.domSelection().collapse(o,i)}else o.parentNode.removeChild(o)}}function ED(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),c,u=a.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:a.anchorOffset}],rd(a)||c.push({node:a.focusNode,offset:a.focusOffset})),Ye&&t.input.lastKeyCode===8)for(let v=o;v>i;v--){let y=r.childNodes[v-1],x=y.pmViewDesc;if(y.nodeName=="BR"&&!x){o=v;break}if(!x||x.size)break}let f=t.state.doc,p=t.someProp("domParser")||ds.fromSchema(t.state.schema),h=f.resolve(s),m=null,g=p.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:o,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:MD,context:h});if(c&&c[0].pos!=null){let v=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=v),m={anchor:v+s,head:y+s}}return{doc:g,sel:m,from:s,to:l}}function MD(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(at&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||at&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const TD=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function jD(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let k=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,M=xh(t,k);if(M&&!t.state.selection.eq(M)){if(Ye&&_n&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",O=>O(t,Kr(13,"Enter"))))return;let $=t.state.tr.setSelection(M);k=="pointer"?$.setMeta("pointer",!0):k=="key"&&$.scrollIntoView(),o&&$.setMeta("composition",o),t.dispatch($)}return}let s=t.state.doc.resolve(e),l=s.sharedDepth(n);e=s.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,c=ED(t,e,n),u=t.state.doc,f=u.slice(c.from,c.to),p,h;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(p=t.state.selection.to,h="end"):(p=t.state.selection.from,h="start"),t.input.lastKeyCode=null;let m=ID(f.content,c.doc.content,c.from,p,h);if(m&&t.input.domChangeCount++,(go&&t.input.lastIOSEnter>Date.now()-225||_n)&&i.some(k=>k.nodeType==1&&!TD.test(k.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",k=>k(t,Kr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!m)if(r&&a instanceof K&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:a.from,endA:a.to,endB:a.to};else{if(c.sel){let k=Dy(t,t.state.doc,c.sel);if(k&&!k.eq(t.state.selection)){let M=t.state.tr.setSelection(k);o&&M.setMeta("composition",o),t.dispatch(M)}}return}t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof K&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),kt&&Dr<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" "&&(m.start--,m.endA--,m.endB--);let g=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),y=u.resolve(m.start),x=g.sameParent(v)&&g.parent.inlineContent&&y.end()>=m.endA;if((go&&t.input.lastIOSEnter>Date.now()-225&&(!x||i.some(k=>k.nodeName=="DIV"||k.nodeName=="P"))||!x&&g.pos<c.doc.content.size&&(!g.sameParent(v)||!g.parent.inlineContent)&&g.pos<v.pos&&!/\S/.test(c.doc.textBetween(g.pos,v.pos,"","")))&&t.someProp("handleKeyDown",k=>k(t,Kr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>m.start&&AD(u,m.start,m.endA,g,v)&&t.someProp("handleKeyDown",k=>k(t,Kr(8,"Backspace")))){_n&&Ye&&t.domObserver.suppressSelectionUpdates();return}Ye&&m.endB==m.start&&(t.input.lastChromeDelete=Date.now()),_n&&!x&&g.start()!=v.start()&&v.parentOffset==0&&g.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(k){return k(t,Kr(13,"Enter"))})},20));let b=m.start,w=m.endA,C=k=>{let M=k||t.state.tr.replace(b,w,c.doc.slice(m.start-c.from,m.endB-c.from));if(c.sel){let $=Dy(t,M.doc,c.sel);$&&!(Ye&&t.composing&&$.empty&&(m.start!=m.endB||t.input.lastChromeDelete<Date.now()-100)&&($.head==b||$.head==M.mapping.map(w)-1)||kt&&$.empty&&$.head==b)&&M.setSelection($)}return o&&M.setMeta("composition",o),M.scrollIntoView()},E;if(x)if(g.pos==v.pos){kt&&Dr<=11&&g.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Vn(t),20));let k=C(t.state.tr.delete(b,w)),M=u.resolve(m.start).marksAcross(u.resolve(m.endA));M&&k.ensureMarks(M),t.dispatch(k)}else if(m.endA==m.endB&&(E=DD(g.parent.content.cut(g.parentOffset,v.parentOffset),y.parent.content.cut(y.parentOffset,m.endA-y.start())))){let k=C(t.state.tr);E.type=="add"?k.addMark(b,w,E.mark):k.removeMark(b,w,E.mark),t.dispatch(k)}else if(g.parent.child(g.index()).isText&&g.index()==v.index()-(v.textOffset?0:1)){let k=g.parent.textBetween(g.parentOffset,v.parentOffset),M=()=>C(t.state.tr.insertText(k,b,w));t.someProp("handleTextInput",$=>$(t,b,w,k,M))||t.dispatch(M())}else t.dispatch(C());else t.dispatch(C())}function Dy(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:vh(t,e.resolve(n.anchor),e.resolve(n.head))}function DD(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,l,a;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)o=n[u].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=u=>u.mark(l.addToSet(u.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=u=>u.mark(l.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(a(e.child(u)));if(I.from(c).eq(t))return{mark:l,type:s}}function AD(t,e,n,r,i){if(n-e<=i.pos-r.pos||du(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let l=o.nodeAfter;return l!=null&&n==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(du(o,!0,!0));return!s.parent.isTextblock||s.pos>n||du(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function du(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function ID(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&t.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&Ay(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<t.size&&Ay(t.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function Ay(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class vb{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new qj,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Oy),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=zy(this),Ry(this),this.nodeViews=$y(this),this.docView=uy(this.state.doc,Iy(this),cu(this),this.dom,this),this.domObserver=new bD(this,(r,i,o,s)=>jD(this,r,i,o,s)),this.domObserver.start(),Jj(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Jf(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Oy),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(fb(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let h=$y(this);zD(h,this.nodeViews)&&(this.nodeViews=h,o=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Jf(this),this.editable=zy(this),Ry(this);let a=cu(this),c=Iy(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,c,a);(f||!e.selection.eq(i.selection))&&(s=!0);let p=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&aj(this);if(s){this.domObserver.stop();let h=f&&(kt||Ye)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&RD(i.selection,e.selection);if(f){let m=Ye?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=aD(this)),(o||!this.docView.update(e.doc,c,a,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=uy(e.doc,c,a,this.dom,this)),m&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Rj(this))?Vn(this,h):(eb(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():p&&cj(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof V){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&oy(this,n.getBoundingClientRect(),e)}else oy(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new hb(e.slice,e.move,i<0?void 0:V.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=n?n(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(kt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&dj(this.dom),Vn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return mj(this,e)}coordsAtPos(e,n=1){return Kv(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return bj(this,n||this.state,e)}pasteHTML(e,n){return Js(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Js(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return bh(this,e)}destroy(){this.docView&&(Gj(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],cu(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,XT())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Qj(this,e)}domSelectionRange(){let e=this.domSelection();return e?at&&this.root.nodeType===11&&rj(this.dom.ownerDocument)==this.dom&&wD(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}vb.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function Iy(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Gt.node(0,t.state.doc.content.size,e)]}function Ry(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Gt.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function zy(t){return!t.someProp("editable",e=>e(t.state)===!1)}function RD(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function $y(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function zD(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Oy(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var $r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Za={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},$D=typeof navigator<"u"&&/Mac/.test(navigator.platform),OD=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ge=0;Ge<10;Ge++)$r[48+Ge]=$r[96+Ge]=String(Ge);for(var Ge=1;Ge<=24;Ge++)$r[Ge+111]="F"+Ge;for(var Ge=65;Ge<=90;Ge++)$r[Ge]=String.fromCharCode(Ge+32),Za[Ge]=String.fromCharCode(Ge);for(var uu in $r)Za.hasOwnProperty(uu)||(Za[uu]=$r[uu]);function ND(t){var e=$D&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||OD&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Za:$r)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const LD=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),PD=typeof navigator<"u"&&/Win/.test(navigator.platform);function FD(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))LD?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function BD(t){let e=Object.create(null);for(let n in t)e[FD(n)]=t[n];return e}function fu(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function _D(t){return new et({props:{handleKeyDown:bb(t)}})}function bb(t){let e=BD(t);return function(n,r){let i=ND(r),o,s=e[fu(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[fu(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(PD&&r.ctrlKey&&r.altKey)&&(o=$r[r.keyCode])&&o!=i){let l=e[fu(o,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}const Mh=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Sb(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const wb=(t,e,n)=>{let r=Sb(t,n);if(!r)return!1;let i=Th(r);if(!i){let s=r.blockRange(),l=s&&Mo(s);return l==null?!1:(e&&e(t.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(Ib(t,i,e,-1))return!0;if(r.parent.content.size==0&&(yo(o,"end")||V.isSelectable(o)))for(let s=r.depth;;s--){let l=td(t.doc,r.before(s),r.after(s),L.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=t.tr.step(l);a.setSelection(yo(o,"end")?G.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):V.create(a.doc,i.pos-o.nodeSize)),e(a.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},HD=(t,e,n)=>{let r=Sb(t,n);if(!r)return!1;let i=Th(r);return i?kb(t,i,e):!1},UD=(t,e,n)=>{let r=Eb(t,n);if(!r)return!1;let i=jh(r);return i?kb(t,i,e):!1};function kb(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,l=s,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let u=l.firstChild;if(!u)return!1;l=u}let c=td(t.doc,o,a,L.empty);if(!c||c.from!=o||c instanceof Pe&&c.slice.size>=a-o)return!1;if(n){let u=t.tr.step(c);u.setSelection(K.create(u.doc,o)),n(u.scrollIntoView())}return!0}function yo(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Cb=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=Th(r)}let s=o&&o.nodeBefore;return!s||!V.isSelectable(s)?!1:(e&&e(t.tr.setSelection(V.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Th(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Eb(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Mb=(t,e,n)=>{let r=Eb(t,n);if(!r)return!1;let i=jh(r);if(!i)return!1;let o=i.nodeAfter;if(Ib(t,i,e,1))return!0;if(r.parent.content.size==0&&(yo(o,"start")||V.isSelectable(o))){let s=td(t.doc,r.before(),r.after(),L.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=t.tr.step(s);l.setSelection(yo(o,"start")?G.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):V.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Tb=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=jh(r)}let s=o&&o.nodeAfter;return!s||!V.isSelectable(s)?!1:(e&&e(t.tr.setSelection(V.create(t.doc,o.pos)).scrollIntoView()),!0)};function jh(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const VD=(t,e)=>{let n=t.selection,r=n instanceof V,i;if(r){if(n.node.isTextblock||!Fr(t.doc,n.from))return!1;i=n.from}else if(i=ed(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(V.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},WD=(t,e)=>{let n=t.selection,r;if(n instanceof V){if(n.node.isTextblock||!Fr(t.doc,n.to))return!1;r=n.to}else if(r=ed(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},KD=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&Mo(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},jb=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Dh(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const qD=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=Dh(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,s.createAndFill());a.setSelection(G.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Db=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof zt||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Dh(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(s,o.createAndFill());l.setSelection(K.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},Ab=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(Un(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Mo(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function JD(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof V&&e.selection.node.isBlock)return!r.parentOffset||!Un(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,l,a=!1,c=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){a=r.end(h)==r.pos+(r.depth-h),c=r.start(h)==r.pos-(r.depth-h),l=Dh(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),o.unshift(a&&l?{type:l}:null),s=h;break}else{if(h==1)return!1;o.unshift(null)}let u=e.tr;(e.selection instanceof K||e.selection instanceof zt)&&u.deleteSelection();let f=u.mapping.map(r.pos),p=Un(u.doc,f,o.length,o);if(p||(o[0]=l?{type:l}:null,p=Un(u.doc,f,o.length,o)),!p)return!1;if(u.split(f,o.length,o),!a&&c&&r.node(s).type!=l){let h=u.mapping.map(r.before(s)),m=u.doc.resolve(h);l&&r.node(s-1).canReplaceWith(m.index(),m.index()+1,l)&&u.setNodeMarkup(u.mapping.map(r.before(s)),l)}return n&&n(u.scrollIntoView()),!0}}const GD=JD(),YD=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(V.create(t.doc,i))),!0)};function QD(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Fr(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Ib(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,l,a=i.type.spec.isolating||o.type.spec.isolating;if(!a&&QD(t,e,n))return!0;let c=!a&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(l=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&l.matchType(s[0]||o.type).validEnd){if(n){let h=e.pos+o.nodeSize,m=I.empty;for(let y=s.length-1;y>=0;y--)m=I.from(s[y].create(null,m));m=I.from(i.copy(m));let g=t.tr.step(new Be(e.pos-1,h,e.pos,h,new L(m,1,0),s.length,!0)),v=g.doc.resolve(h+2*s.length);v.nodeAfter&&v.nodeAfter.type==i.type&&Fr(g.doc,v.pos)&&g.join(v.pos),n(g.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&a?null:G.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),p=f&&Mo(f);if(p!=null&&p>=e.depth)return n&&n(t.tr.lift(f,p).scrollIntoView()),!0;if(c&&yo(o,"start",!0)&&yo(i,"end")){let h=i,m=[];for(;m.push(h),!h.isTextblock;)h=h.lastChild;let g=o,v=1;for(;!g.isTextblock;g=g.firstChild)v++;if(h.canReplace(h.childCount,h.childCount,g.content)){if(n){let y=I.empty;for(let b=m.length-1;b>=0;b--)y=I.from(m[b].copy(y));let x=t.tr.step(new Be(e.pos-m.length,e.pos+o.nodeSize,e.pos+v,e.pos+o.nodeSize-v,new L(y,m.length,0),0,!0));n(x.scrollIntoView())}return!0}}return!1}function Rb(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(K.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const XD=Rb(-1),ZD=Rb(1);function eA(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),l=s&&mh(s,t,e);return l?(r&&r(n.tr.wrap(s,l).scrollIntoView()),!0):!1}}function Ny(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:l}}=n.selection.ranges[o];n.doc.nodesBetween(s,l,(a,c)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let u=n.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[s];o.setBlockType(l,a,t,e)}r(o.scrollIntoView())}return!0}}function Ah(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Ah(Mh,wb,Cb);Ah(Mh,Mb,Tb);Ah(jb,Db,Ab,GD);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function tA(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let l=r?n.tr:null;return nA(l,s,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function nA(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=s.resolve(e.start-2);o=new Ka(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new Ka(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=mh(o,n,r,e);return l?(t&&rA(t,e,l,i,n),!0):!1}function rA(t,e,n,r,i){let o=I.empty;for(let u=n.length-1;u>=0;u--)o=I.from(n[u].type.create(n[u].attrs,o));t.step(new Be(e.start-(r?2:0),e.end,e.start,e.end,new L(o,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==i&&(s=u+1);let l=n.length-s,a=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,p=!0;u<f;u++,p=!1)!p&&Un(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=c.child(u).nodeSize;return t}function iA(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?oA(e,n,t,o):sA(e,n,o):!0:!1}}function oA(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new Be(o-1,s,o,s,new L(I.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ka(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const l=Mo(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(o,-1)-1);return Fr(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function sA(t,e,n){let r=t.tr,i=n.parent;for(let h=n.end,m=n.endIndex-1,g=n.startIndex;m>g;m--)h-=i.child(m).nodeSize,r.delete(h-1,h+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(l?0:1),u+1,s.content.append(a?I.empty:I.from(i))))return!1;let f=o.pos,p=f+s.nodeSize;return r.step(new Be(f-(l?1:0),p+(a?1:0),f+1,p-1,new L((l?I.empty:I.from(i.copy(I.empty))).append(a?I.empty:I.from(i.copy(I.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function lA(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let l=o.parent,a=l.child(s-1);if(a.type!=t)return!1;if(n){let c=a.lastChild&&a.lastChild.type==l.type,u=I.from(c?t.create():null),f=new L(I.from(t.create(null,I.from(l.type.create(null,u)))),c?3:1,0),p=o.start,h=o.end;n(e.tr.step(new Be(p-(c?3:1),h,p,h,f,1,!0)).scrollIntoView())}return!0}}function sd(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class ld{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...u)=>{const f=a(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,l=[],a=!!e,c=e||o.tr,u=()=>(!a&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),l.every(p=>p===!0)),f={...Object.fromEntries(Object.entries(r).map(([p,h])=>[p,(...g)=>{const v=this.buildProps(c,n),y=h(...g)(v);return l.push(y),f}])),run:u};return f}createCan(e){const{rawCommands:n,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(n).map(([a,c])=>[a,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,l={tr:e,editor:i,view:s,state:sd({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,c])=>[a,(...u)=>c(...u)(l)]))}};return l}}class aA{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function F(t,e,n){return t.config[e]===void 0&&t.parent?F(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?F(t.parent,e,n):null}):t.config[e]}function ad(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function zb(t){const e=[],{nodeExtensions:n,markExtensions:r}=ad(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage,extensions:i},a=F(s,"addGlobalAttributes",l);if(!a)return;a().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([p,h])=>{e.push({type:f,name:p,attribute:{...o,...h}})})})})}),i.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage},a=F(s,"addAttributes",l);if(!a)return;const c=a();Object.entries(c).forEach(([u,f])=>{const p={...o,...f};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:s.name,name:u,attribute:p})})}),e}function He(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function $e(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const l=o?String(o).split(" "):[],a=r[i]?r[i].split(" "):[],c=l.filter(u=>!a.includes(u));r[i]=[...a,...c].join(" ")}else if(i==="style"){const l=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],a=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;a.forEach(u=>{const[f,p]=u.split(":").map(h=>h.trim());c.set(f,p)}),l.forEach(u=>{const[f,p]=u.split(":").map(h=>h.trim());c.set(f,p)}),r[i]=Array.from(c.entries()).map(([u,f])=>`${u}: ${f}`).join("; ")}else r[i]=o}),r},{})}function Gf(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>$e(n,r),{})}function $b(t){return typeof t=="function"}function Y(t,e=void 0,...n){return $b(t)?e?t.bind(e)(...n):t(...n):t}function cA(t={}){return Object.keys(t).length===0&&t.constructor===Object}function dA(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Ly(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const l=s.attribute.parseHTML?s.attribute.parseHTML(n):dA(n.getAttribute(s.name));return l==null?o:{...o,[s.name]:l}},{});return{...r,...i}}}}function Py(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&cA(n)?!1:n!=null))}function uA(t,e){var n;const r=zb(t),{nodeExtensions:i,markExtensions:o}=ad(t),s=(n=i.find(c=>F(c,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(i.map(c=>{const u=r.filter(y=>y.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((y,x)=>{const b=F(x,"extendNodeSchema",f);return{...y,...b?b(c):{}}},{}),h=Py({...p,content:Y(F(c,"content",f)),marks:Y(F(c,"marks",f)),group:Y(F(c,"group",f)),inline:Y(F(c,"inline",f)),atom:Y(F(c,"atom",f)),selectable:Y(F(c,"selectable",f)),draggable:Y(F(c,"draggable",f)),code:Y(F(c,"code",f)),whitespace:Y(F(c,"whitespace",f)),linebreakReplacement:Y(F(c,"linebreakReplacement",f)),defining:Y(F(c,"defining",f)),isolating:Y(F(c,"isolating",f)),attrs:Object.fromEntries(u.map(y=>{var x;return[y.name,{default:(x=y==null?void 0:y.attribute)===null||x===void 0?void 0:x.default}]}))}),m=Y(F(c,"parseHTML",f));m&&(h.parseDOM=m.map(y=>Ly(y,u)));const g=F(c,"renderHTML",f);g&&(h.toDOM=y=>g({node:y,HTMLAttributes:Gf(y,u)}));const v=F(c,"renderText",f);return v&&(h.toText=v),[c.name,h]})),a=Object.fromEntries(o.map(c=>{const u=r.filter(v=>v.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((v,y)=>{const x=F(y,"extendMarkSchema",f);return{...v,...x?x(c):{}}},{}),h=Py({...p,inclusive:Y(F(c,"inclusive",f)),excludes:Y(F(c,"excludes",f)),group:Y(F(c,"group",f)),spanning:Y(F(c,"spanning",f)),code:Y(F(c,"code",f)),attrs:Object.fromEntries(u.map(v=>{var y;return[v.name,{default:(y=v==null?void 0:v.attribute)===null||y===void 0?void 0:y.default}]}))}),m=Y(F(c,"parseHTML",f));m&&(h.parseDOM=m.map(v=>Ly(v,u)));const g=F(c,"renderHTML",f);return g&&(h.toDOM=v=>g({mark:v,HTMLAttributes:Gf(v,u)})),[c.name,h]}));return new bv({topNode:s,nodes:l,marks:a})}function pu(t,e){return e.nodes[t]||e.marks[t]||null}function Fy(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Ih(t,e){const n=ki.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const fA=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,l)=>{var a,c;const u=((c=(a=i.type.spec).toText)===null||c===void 0?void 0:c.call(a,{node:i,pos:o,parent:s,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),n};function Rh(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class cd{constructor(e){this.find=e.find,this.handler=e.handler}}const pA=(t,e)=>{if(Rh(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Fl(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:l}=t,{view:a}=n;if(a.composing)return!1;const c=a.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const f=fA(c)+o;return s.forEach(p=>{if(u)return;const h=pA(f,p.find);if(!h)return;const m=a.state.tr,g=sd({state:a.state,transaction:m}),v={from:r-(h[0].length-o.length),to:i},{commands:y,chain:x,can:b}=new ld({editor:n,state:g});p.handler({state:g,range:v,match:h,commands:y,chain:x,can:b})===null||!m.steps.length||(m.setMeta(l,{transform:m,from:r,to:i,text:o}),a.dispatch(m),u=!0)}),u}function hA(t){const{editor:e,rules:n}=t,r=new et({state:{init(){return null},apply(i,o,s){const l=i.getMeta(r);if(l)return l;const a=i.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:u}=a;typeof u=="string"?u=u:u=Ih(I.from(u),s.schema);const{from:f}=a,p=f+u.length;Fl({editor:e,from:f,to:p,text:u,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,l){return Fl({editor:e,from:o,to:s,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Fl({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Fl({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function mA(t){return Object.prototype.toString.call(t).slice(8,-1)}function Bl(t){return mA(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function dd(t,e){const n={...t};return Bl(t)&&Bl(e)&&Object.keys(e).forEach(r=>{Bl(e[r])&&Bl(t[r])?n[r]=dd(t[r],e[r]):n[r]=e[r]}),n}class hn{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Y(F(this,"addOptions",{name:this.name}))),this.storage=Y(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new hn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new hn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Y(F(n,"addOptions",{name:n.name})),n.storage=Y(F(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const a=s.find(c=>(c==null?void 0:c.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function gA(t){return typeof t=="number"}class yA{constructor(e){this.find=e.find,this.handler=e.handler}}const xA=(t,e,n)=>{if(Rh(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function vA(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:l}=t,{commands:a,chain:c,can:u}=new ld({editor:e,state:n}),f=[];return n.doc.nodesBetween(r,i,(h,m)=>{if(!h.isTextblock||h.type.spec.code)return;const g=Math.max(r,m),v=Math.min(i,m+h.content.size),y=h.textBetween(g-m,v-m,void 0,"");xA(y,o.find,s).forEach(b=>{if(b.index===void 0)return;const w=g+b.index+1,C=w+b[0].length,E={from:n.tr.mapping.map(w),to:n.tr.mapping.map(C)},k=o.handler({state:n,range:E,match:b,commands:a,chain:c,can:u,pasteEvent:s,dropEvent:l});f.push(k)})}),f.every(h=>h!==null)}let _l=null;const bA=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function SA(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:u,from:f,to:p,rule:h,pasteEvt:m})=>{const g=u.tr,v=sd({state:u,transaction:g});if(!(!vA({editor:e,state:v,from:Math.max(f-1,0),to:p.b-1,rule:h,pasteEvent:m,dropEvent:l})||!g.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return n.map(u=>new et({view(f){const p=m=>{var g;r=!((g=f.dom.parentElement)===null||g===void 0)&&g.contains(m.target)?f.dom.parentElement:null,r&&(_l=e)},h=()=>{_l&&(_l=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(f,p)=>{if(o=r===f.dom.parentElement,l=p,!o){const h=_l;h!=null&&h.isEditable&&setTimeout(()=>{const m=h.state.selection;m&&h.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(f,p)=>{var h;const m=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return s=p,i=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(f,p,h)=>{const m=f[0],g=m.getMeta("uiEvent")==="paste"&&!i,v=m.getMeta("uiEvent")==="drop"&&!o,y=m.getMeta("applyPasteRules"),x=!!y;if(!g&&!v&&!x)return;if(x){let{text:C}=y;typeof C=="string"?C=C:C=Ih(I.from(C),h.schema);const{from:E}=y,k=E+C.length,M=bA(C);return a({rule:u,state:h,from:E,to:{b:k},pasteEvt:M})}const b=p.doc.content.findDiffStart(h.doc.content),w=p.doc.content.findDiffEnd(h.doc.content);if(!(!gA(b)||!w||b===w.b))return a({rule:u,state:h,from:b,to:w,pasteEvt:s})}}))}function wA(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class Gi{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Gi.resolve(e),this.schema=uA(this.extensions,n),this.setupExtensions()}static resolve(e){const n=Gi.sort(Gi.flatten(e)),r=wA(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=F(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=F(r,"priority")||100,s=F(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:pu(n.name,this.schema)},i=F(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=Gi.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const l={name:s.name,options:s.options,storage:s.storage,editor:e,type:pu(s.name,this.schema)},a=[],c=F(s,"addKeyboardShortcuts",l);let u={};if(s.type==="mark"&&F(s,"exitable",l)&&(u.ArrowRight=()=>hn.handleExit({editor:e,mark:s})),c){const g=Object.fromEntries(Object.entries(c()).map(([v,y])=>[v,()=>y({editor:e})]));u={...u,...g}}const f=_D(u);a.push(f);const p=F(s,"addInputRules",l);Fy(s,e.options.enableInputRules)&&p&&r.push(...p());const h=F(s,"addPasteRules",l);Fy(s,e.options.enablePasteRules)&&h&&i.push(...h());const m=F(s,"addProseMirrorPlugins",l);if(m){const g=m();a.push(...g)}return a}).flat();return[hA({editor:e,rules:r}),...SA({editor:e,rules:i}),...o]}get attributes(){return zb(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=ad(this.extensions);return Object.fromEntries(n.filter(r=>!!F(r,"addNodeView")).map(r=>{const i=this.attributes.filter(a=>a.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:He(r.name,this.schema)},s=F(r,"addNodeView",o);if(!s)return[];const l=(a,c,u,f,p)=>{const h=Gf(a,i);return s()({node:a,view:c,getPos:u,decorations:f,innerDecorations:p,editor:e,extension:r,HTMLAttributes:h})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:pu(e.name,this.schema)};e.type==="mark"&&(!((n=Y(F(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=F(e,"onBeforeCreate",r),o=F(e,"onCreate",r),s=F(e,"onUpdate",r),l=F(e,"onSelectionUpdate",r),a=F(e,"onTransaction",r),c=F(e,"onFocus",r),u=F(e,"onBlur",r),f=F(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}}class Ze{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Y(F(this,"addOptions",{name:this.name}))),this.storage=Y(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ze(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Ze({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Y(F(n,"addOptions",{name:n.name})),n.storage=Y(F(n,"addStorage",{name:n.name,options:n.options})),n}}function Ob(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let l="";return t.nodesBetween(r,i,(a,c,u,f)=>{var p;a.isBlock&&c>r&&(l+=o);const h=s==null?void 0:s[a.type.name];if(h)return u&&(l+=h({node:a,pos:c,parent:u,index:f,range:e})),!1;a.isText&&(l+=(p=a==null?void 0:a.text)===null||p===void 0?void 0:p.slice(Math.max(r,c)-c,i-c))}),l}function Nb(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const kA=Ze.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new et({key:new Pt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),l=Math.max(...o.map(u=>u.$to.pos)),a=Nb(n);return Ob(r,{from:s,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),CA=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),EA=(t=!1)=>({commands:e})=>e.setContent("",t),MA=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(l,a)=>{if(l.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(a)),p=c.resolve(u.map(a+l.nodeSize)),h=f.blockRange(p);if(!h)return;const m=Mo(h);if(l.type.isTextblock){const{defaultType:g}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(h.start,g)}(m||m===0)&&e.lift(h,m)})}),!0},TA=t=>e=>t(e),jA=()=>({state:t,dispatch:e})=>Db(t,e),DA=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new K(r.doc.resolve(Math.max(s-1,0)))),!0},AA=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const l=i.before(o),a=i.after(o);t.delete(l,a).scrollIntoView()}return!0}return!1},IA=t=>({tr:e,state:n,dispatch:r})=>{const i=He(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const a=o.before(s),c=o.after(s);e.delete(a,c).scrollIntoView()}return!0}return!1},RA=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},zA=()=>({state:t,dispatch:e})=>Mh(t,e),$A=()=>({commands:t})=>t.keyboardShortcut("Enter"),OA=()=>({state:t,dispatch:e})=>qD(t,e);function ec(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:Rh(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function Lb(t,e,n={}){return t.find(r=>r.type===e&&ec(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function By(t,e,n={}){return!!Lb(t,e,n)}function zh(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!Lb([...i.node.marks],e,n)))return;let s=i.index,l=t.start()+i.offset,a=s+1,c=l+i.node.nodeSize;for(;s>0&&By([...t.parent.child(s-1).marks],e,n);)s-=1,l-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&By([...t.parent.child(a).marks],e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:l,to:c}}function _r(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const NA=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=_r(t,r.schema),{doc:s,selection:l}=n,{$from:a,from:c,to:u}=l;if(i){const f=zh(a,o,e);if(f&&f.from<=c&&f.to>=u){const p=K.create(s,f.from,f.to);n.setSelection(p)}}return!0},LA=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Pb(t){return t instanceof K}function ei(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Fb(t,e=null){if(!e)return null;const n=G.atStart(t),r=G.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?K.create(t,ei(0,i,o),ei(t.content.size,i,o)):K.create(t,ei(e,i,o),ei(e,i,o))}function _y(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function tc(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function PA(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}const FA=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(tc()||_y())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),PA()&&!tc()&&!_y()&&r.dom.focus({preventScroll:!0}))})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!Pb(n.state.selection))return s(),!0;const l=Fb(i.doc,t)||n.state.selection,a=n.state.selection.eq(l);return o&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},BA=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),_A=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Bb=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Bb(r)}return t};function Hl(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Bb(n)}function Ys(t,e,n){if(t instanceof jr||t instanceof I)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return I.fromArray(t.map(l=>e.nodeFromJSON(l)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Ys("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,l="";const a=new bv({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,l=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?ds.fromSchema(a).parseSlice(Hl(t),n.parseOptions):ds.fromSchema(a).parse(Hl(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const o=ds.fromSchema(e);return n.slice?o.parseSlice(Hl(t),n.parseOptions).content:o.parse(Hl(t),n.parseOptions)}return Ys("",e,n)}function HA(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Pe||i instanceof Be))return;const o=t.mapping.maps[r];let s=0;o.forEach((l,a,c,u)=>{s===0&&(s=u)}),t.setSelection(G.near(t.doc.resolve(s),n))}const UA=t=>!("type"in t),VA=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const a=v=>{o.emit("contentError",{editor:o,error:v,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Ys(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(v){a(v)}try{l=Ys(e,o.schema,{parseOptions:c,errorOnInvalidContent:(s=n.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(v){return a(v),!1}let{from:u,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},p=!0,h=!0;if((UA(l)?l:[l]).forEach(v=>{v.check(),p=p?v.isText&&v.marks.length===0:!1,h=h?v.isBlock:!1}),u===f&&h){const{parent:v}=r.doc.resolve(u);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(u-=1,f+=1)}let g;if(p){if(Array.isArray(e))g=e.map(v=>v.text||"").join("");else if(e instanceof I){let v="";e.forEach(y=>{y.text&&(v+=y.text)}),g=v}else typeof e=="object"&&e&&e.text?g=e.text:g=e;r.insertText(g,u,f)}else g=l,r.replaceWith(u,f,g);n.updateSelection&&HA(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:g}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:g})}return!0},WA=()=>({state:t,dispatch:e})=>VD(t,e),KA=()=>({state:t,dispatch:e})=>WD(t,e),qA=()=>({state:t,dispatch:e})=>wb(t,e),JA=()=>({state:t,dispatch:e})=>Mb(t,e),GA=()=>({state:t,dispatch:e,tr:n})=>{try{const r=ed(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},YA=()=>({state:t,dispatch:e,tr:n})=>{try{const r=ed(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},QA=()=>({state:t,dispatch:e})=>HD(t,e),XA=()=>({state:t,dispatch:e})=>UD(t,e);function _b(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function ZA(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))tc()||_b()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const e5=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=ZA(t).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,l))});return a==null||a.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Qs(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?He(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(f,p)=>{if(f.isText)return;const h=Math.max(r,p),m=Math.min(i,p+f.nodeSize);l.push({node:f,from:h,to:m})});const a=i-r,c=l.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>ec(f.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((f,p)=>f+p.to-p.from,0)>=a}const t5=(t,e={})=>({state:n,dispatch:r})=>{const i=He(t,n.schema);return Qs(n,i,e)?KD(n,r):!1},n5=()=>({state:t,dispatch:e})=>Ab(t,e),r5=t=>({state:e,dispatch:n})=>{const r=He(t,e.schema);return iA(r)(e,n)},i5=()=>({state:t,dispatch:e})=>jb(t,e);function ud(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Hy(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const o5=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=ud(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(o=He(t,r.schema)),l==="mark"&&(s=_r(t,r.schema)),i&&n.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,Hy(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(f=>{s===f.type&&n.addMark(u,u+c.nodeSize,s.create(Hy(f.attrs,e)))})})}),!0):!1},s5=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),l5=()=>({tr:t,dispatch:e})=>{if(e){const n=new zt(t.doc);t.setSelection(n)}return!0},a5=()=>({state:t,dispatch:e})=>Cb(t,e),c5=()=>({state:t,dispatch:e})=>Tb(t,e),d5=()=>({state:t,dispatch:e})=>YD(t,e),u5=()=>({state:t,dispatch:e})=>ZD(t,e),f5=()=>({state:t,dispatch:e})=>XD(t,e);function Yf(t,e,n={},r={}){return Ys(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const p5=(t,e=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:l})=>{var a,c;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const f=Yf(t,i.schema,n,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,f).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function Hb(t,e){const n=_r(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,a=>{s.push(...a.marks)});const l=s.find(a=>a.type.name===n.name);return l?{...l.attrs}:{}}function h5(t,e){const n=new Nv(t);return e.forEach(r=>{r.steps.forEach(i=>{n.step(i)})}),n}function m5(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function g5(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(i,o)=>{n(i)&&r.push({node:i,pos:o})}),r}function y5(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function $h(t){return e=>y5(e.$from,t)}function x5(t,e){const n={from:0,to:t.content.size};return Ob(t,n,e)}function v5(t,e){const n=He(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,l=>{o.push(l)});const s=o.reverse().find(l=>l.type.name===n.name);return s?{...s.attrs}:{}}function Ub(t,e){const n=ud(typeof e=="string"?e:e.name,t.schema);return n==="node"?v5(t,e):n==="mark"?Hb(t,e):{}}function b5(t,e=JSON.stringify){const n={};return t.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function S5(t){const e=b5(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,s)=>s!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function w5(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((i,o)=>{const s=[];if(i.ranges.length)i.forEach((l,a)=>{s.push({from:l,to:a})});else{const{from:l,to:a}=n[o];if(l===void 0||a===void 0)return;s.push({from:l,to:a})}s.forEach(({from:l,to:a})=>{const c=e.slice(o).map(l,-1),u=e.slice(o).map(a),f=e.invert().map(c,-1),p=e.invert().map(u);r.push({oldRange:{from:f,to:p},newRange:{from:c,to:u}})})}),S5(r)}function Oh(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=zh(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function aa(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function Qf(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?_r(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>ec(f.attrs,n,{strict:!1}));let s=0;const l=[];if(i.forEach(({$from:f,$to:p})=>{const h=f.pos,m=p.pos;t.doc.nodesBetween(h,m,(g,v)=>{if(!g.isText&&!g.marks.length)return;const y=Math.max(h,v),x=Math.min(m,v+g.nodeSize),b=x-y;s+=b,l.push(...g.marks.map(w=>({mark:w,from:y,to:x})))})}),s===0)return!1;const a=l.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>ec(f.mark.attrs,n,{strict:!1})).reduce((f,p)=>f+p.to-p.from,0),c=l.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,p)=>f+p.to-p.from,0);return(a>0?a+c:a)>=s}function k5(t,e,n={}){if(!e)return Qs(t,null,n)||Qf(t,null,n);const r=ud(e,t.schema);return r==="node"?Qs(t,e,n):r==="mark"?Qf(t,e,n):!1}function Uy(t,e){const{nodeExtensions:n}=ad(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=Y(F(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Nh(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(Nh(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function C5(t){return t instanceof V}function E5(t,e,n){var r;const{selection:i}=e;let o=null;if(Pb(i)&&(o=i.$cursor),o){const l=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(l)||!l.some(a=>a.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:l,$to:a})=>{let c=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,a.pos,(u,f,p)=>{if(c)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));c=h&&m}return!c}),c})}const M5=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:l}=o,a=_r(t,r.schema);if(i)if(s){const c=Hb(r,a);n.addStoredMark(a.create({...c,...e}))}else l.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(p,h)=>{const m=Math.max(h,u),g=Math.min(h+p.nodeSize,f);p.marks.find(y=>y.type===a)?p.marks.forEach(y=>{a===y.type&&n.addMark(m,g,a.create({...y.attrs,...e}))}):n.addMark(m,g,a.create(e))})});return E5(r,n,a)},T5=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),j5=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=He(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:l})=>Ny(o,{...s,...e})(n)?!0:l.clearNodes()).command(({state:l})=>Ny(o,{...s,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},D5=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=ei(t,0,r.content.size),o=V.create(r,i);e.setSelection(o)}return!0},A5=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=K.atStart(r).from,l=K.atEnd(r).to,a=ei(i,s,l),c=ei(o,s,l),u=K.create(r,a,c);e.setSelection(u)}return!0},I5=t=>({state:e,dispatch:n})=>{const r=He(t,e.schema);return lA(r)(e,n)};function Vy(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const R5=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:l,$to:a}=o,c=i.extensionManager.attributes,u=aa(c,l.node().type.name,l.node().attrs);if(o instanceof V&&o.node.isBlock)return!l.parentOffset||!Un(s,l.pos)?!1:(r&&(t&&Vy(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=a.parentOffset===a.parent.content.size,p=l.depth===0?void 0:m5(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=f&&p?[{type:p,attrs:u}]:void 0,m=Un(e.doc,e.mapping.map(l.pos),1,h);if(!h&&!m&&Un(e.doc,e.mapping.map(l.pos),1,p?[{type:p}]:void 0)&&(m=!0,h=p?[{type:p,attrs:u}]:void 0),r){if(m&&(o instanceof K&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,h),p&&!f&&!l.parentOffset&&l.parent.type!==p)){const g=e.mapping.map(l.before()),v=e.doc.resolve(g);l.node(-1).canReplaceWith(v.index(),v.index()+1,p)&&e.setNodeMarkup(e.mapping.map(l.before()),p)}t&&Vy(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return m},z5=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const l=He(t,r.schema),{$from:a,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||a.depth<2||!a.sameParent(c))return!1;const f=a.node(-1);if(f.type!==l)return!1;const p=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let y=I.empty;const x=a.index(-1)?1:a.index(-2)?2:3;for(let M=a.depth-x;M>=a.depth-3;M-=1)y=I.from(a.node(M).copy(y));const b=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,w={...aa(p,a.node().type.name,a.node().attrs),...e},C=((s=l.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(w))||void 0;y=y.append(I.from(l.createAndFill(null,C)||void 0));const E=a.before(a.depth-(x-1));n.replace(E,a.after(-b),new L(y,4-x,0));let k=-1;n.doc.nodesBetween(E,n.doc.content.size,(M,$)=>{if(k>-1)return!1;M.isTextblock&&M.content.size===0&&(k=$+1)}),k>-1&&n.setSelection(K.near(n.doc.resolve(k))),n.scrollIntoView()}return!0}const h=c.pos===a.end()?f.contentMatchAt(0).defaultType:null,m={...aa(p,f.type.name,f.attrs),...e},g={...aa(p,a.node().type.name,a.node().attrs),...e};n.delete(a.pos,c.pos);const v=h?[{type:l,attrs:m},{type:h,attrs:g}]:[{type:l,attrs:m}];if(!Un(n.doc,a.pos,2))return!1;if(i){const{selection:y,storedMarks:x}=r,{splittableMarks:b}=o.extensionManager,w=x||y.$to.parentOffset&&y.$from.marks();if(n.split(a.pos,2,v).scrollIntoView(),!w||!i)return!0;const C=w.filter(E=>b.includes(E.type.name));n.ensureMarks(C)}return!0},hu=(t,e)=>{const n=$h(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Fr(t.doc,n.pos)&&t.join(n.pos),!0},mu=(t,e)=>{const n=$h(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Fr(t.doc,r)&&t.join(r),!0},$5=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:l,chain:a,commands:c,can:u})=>{const{extensions:f,splittableMarks:p}=i.extensionManager,h=He(t,s.schema),m=He(e,s.schema),{selection:g,storedMarks:v}=s,{$from:y,$to:x}=g,b=y.blockRange(x),w=v||g.$to.parentOffset&&g.$from.marks();if(!b)return!1;const C=$h(E=>Uy(E.type.name,f))(g);if(b.depth>=1&&C&&b.depth-C.depth<=1){if(C.node.type===h)return c.liftListItem(m);if(Uy(C.node.type.name,f)&&h.validContent(C.node.content)&&l)return a().command(()=>(o.setNodeMarkup(C.pos,h),!0)).command(()=>hu(o,h)).command(()=>mu(o,h)).run()}return!n||!w||!l?a().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>hu(o,h)).command(()=>mu(o,h)).run():a().command(()=>{const E=u().wrapInList(h,r),k=w.filter(M=>p.includes(M.type.name));return o.ensureMarks(k),E?!0:c.clearNodes()}).wrapInList(h,r).command(()=>hu(o,h)).command(()=>mu(o,h)).run()},O5=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=_r(t,r.schema);return Qf(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},N5=(t,e,n={})=>({state:r,commands:i})=>{const o=He(t,r.schema),s=He(e,r.schema),l=Qs(r,o,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?i.setNode(s,a):i.setNode(o,{...a,...n})},L5=(t,e={})=>({state:n,commands:r})=>{const i=He(t,n.schema);return Qs(n,i,e)?r.lift(i):r.wrapIn(i,e)},P5=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,l=o.transform;for(let a=l.steps.length-1;a>=0;a-=1)s.step(l.steps[a].invert(l.docs[a]));if(o.text){const a=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,a))}else s.delete(o.from,o.to)}return!0}}return!1},F5=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},B5=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:l}=n,a=_r(t,r.schema),{$from:c,empty:u,ranges:f}=l;if(!i)return!0;if(u&&s){let{from:p,to:h}=l;const m=(o=c.marks().find(v=>v.type===a))===null||o===void 0?void 0:o.attrs,g=zh(c,a,m);g&&(p=g.from,h=g.to),n.removeMark(p,h,a)}else f.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,a)});return n.removeStoredMark(a),!0},_5=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=ud(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(o=He(t,r.schema)),l==="mark"&&(s=_r(t,r.schema)),i&&n.selection.ranges.forEach(a=>{const c=a.$from.pos,u=a.$to.pos;let f,p,h,m;n.selection.empty?r.doc.nodesBetween(c,u,(g,v)=>{o&&o===g.type&&(h=Math.max(v,c),m=Math.min(v+g.nodeSize,u),f=v,p=g)}):r.doc.nodesBetween(c,u,(g,v)=>{v<c&&o&&o===g.type&&(h=Math.max(v,c),m=Math.min(v+g.nodeSize,u),f=v,p=g),v>=c&&v<=u&&(o&&o===g.type&&n.setNodeMarkup(v,void 0,{...g.attrs,...e}),s&&g.marks.length&&g.marks.forEach(y=>{if(s===y.type){const x=Math.max(v,c),b=Math.min(v+g.nodeSize,u);n.addMark(x,b,s.create({...y.attrs,...e}))}}))}),p&&(f!==void 0&&n.setNodeMarkup(f,void 0,{...p.attrs,...e}),s&&p.marks.length&&p.marks.forEach(g=>{s===g.type&&n.addMark(h,m,s.create({...g.attrs,...e}))}))}),!0):!1},H5=(t,e={})=>({state:n,dispatch:r})=>{const i=He(t,n.schema);return eA(i,e)(n,r)},U5=(t,e={})=>({state:n,dispatch:r})=>{const i=He(t,n.schema);return tA(i,e)(n,r)};var V5=Object.freeze({__proto__:null,blur:CA,clearContent:EA,clearNodes:MA,command:TA,createParagraphNear:jA,cut:DA,deleteCurrentNode:AA,deleteNode:IA,deleteRange:RA,deleteSelection:zA,enter:$A,exitCode:OA,extendMarkRange:NA,first:LA,focus:FA,forEach:BA,insertContent:_A,insertContentAt:VA,joinBackward:qA,joinDown:KA,joinForward:JA,joinItemBackward:GA,joinItemForward:YA,joinTextblockBackward:QA,joinTextblockForward:XA,joinUp:WA,keyboardShortcut:e5,lift:t5,liftEmptyBlock:n5,liftListItem:r5,newlineInCode:i5,resetAttributes:o5,scrollIntoView:s5,selectAll:l5,selectNodeBackward:a5,selectNodeForward:c5,selectParentNode:d5,selectTextblockEnd:u5,selectTextblockStart:f5,setContent:p5,setMark:M5,setMeta:T5,setNode:j5,setNodeSelection:D5,setTextSelection:A5,sinkListItem:I5,splitBlock:R5,splitListItem:z5,toggleList:$5,toggleMark:O5,toggleNode:N5,toggleWrap:L5,undoInputRule:P5,unsetAllMarks:F5,unsetMark:B5,updateAttributes:_5,wrapIn:H5,wrapInList:U5});const W5=Ze.create({name:"commands",addCommands(){return{...V5}}}),K5=Ze.create({name:"drop",addProseMirrorPlugins(){return[new et({key:new Pt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),q5=Ze.create({name:"editable",addProseMirrorPlugins(){return[new et({key:new Pt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),J5=new Pt("focusEvents"),G5=Ze.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new et({key:J5,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Y5=Ze.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:l})=>{const{selection:a,doc:c}=l,{empty:u,$anchor:f}=a,{pos:p,parent:h}=f,m=f.parent.isTextblock&&p>0?l.doc.resolve(p-1):f,g=m.parent.type.spec.isolating,v=f.pos-f.parentOffset,y=g&&m.parent.childCount===1?v===f.pos:G.atStart(c).from===p;return!u||!h.type.isTextblock||h.textContent.length||!y||y&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return tc()||_b()?o:i},addProseMirrorPlugins(){return[new et({key:new Pt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(g=>g.getMeta("composition")))return;const r=t.some(g=>g.docChanged)&&!e.doc.eq(n.doc),i=t.some(g=>g.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:l}=e.selection,a=G.atStart(e.doc).from,c=G.atEnd(e.doc).to;if(o||!(s===a&&l===c)||!Nh(n.doc))return;const p=n.tr,h=sd({state:n,transaction:p}),{commands:m}=new ld({editor:this.editor,state:h});if(m.clearNodes(),!!p.steps.length)return p}})]}}),Q5=Ze.create({name:"paste",addProseMirrorPlugins(){return[new et({key:new Pt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),X5=Ze.create({name:"tabindex",addProseMirrorPlugins(){return[new et({key:new Pt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class qr{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new qr(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new qr(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new qr(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(s);if(!i&&l.depth<=this.depth)return;const a=new qr(l,this.editor,i,i?n:null);i&&(a.actualDepth=this.depth+1),e.push(new qr(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let l=0;l<s.length;l+=1){const a=s[l];if(o[a]!==n[a])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(a=>n[a]===s.node.attrs[a])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const Z5=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function eI(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class tI extends aA{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=eI(Z5,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=$b(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=r.filter(l=>!l.key.startsWith(s))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[q5,kA.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),W5,G5,Y5,X5,K5,Q5].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new Gi(i,this)}createCommandManager(){this.commandManager=new ld({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Yf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),n=Yf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Fb(n,this.options.autofocus);this.view=new vb(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ji.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(s)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Ub(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return k5(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ih(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return x5(this.state.doc,{blockSeparator:n,textSerializers:{...Nb(this.schema),...r}})}get isEmpty(){return Nh(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new qr(n,this)}get $doc(){return this.$pos(0)}}function xo(t){return new cd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Y(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],l=r[0];if(s){const a=l.search(/\S/),c=n.from+l.indexOf(s),u=c+s.length;if(Oh(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(g=>g===t.type&&g!==h.mark.type)).filter(h=>h.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+a,c);const p=n.from+a+s.length;o.addMark(n.from+a,p,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function nI(t){return new cd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Y(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let l=n.to;const a=t.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>l?u=l:l=u+r[1].length;const f=r[0][r[0].length-1];o.insertText(f,s+r[0].length-1),o.replaceWith(u,l,a)}else if(r[0]){const c=t.type.isInline?s:s-1;o.insert(c,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(l))}o.scrollIntoView()}})}function Xf(t){return new cd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=Y(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function Xs(t){return new cd({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=Y(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),c=a&&mh(a,t.type,o);if(!c)return null;if(s.wrap(a,c),t.keepMarks&&t.editor){const{selection:f,storedMarks:p}=e,{splittableMarks:h}=t.editor.extensionManager,m=p||f.$to.parentOffset&&f.$from.marks();if(m){const g=m.filter(v=>h.includes(v.type.name));s.ensureMarks(g)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,o).run()}const u=s.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&Fr(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&s.join(n.from-1)}})}class Ct{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Y(F(this,"addOptions",{name:this.name}))),this.storage=Y(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ct(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Ct(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Y(F(n,"addOptions",{name:n.name})),n.storage=Y(F(n,"addStorage",{name:n.name,options:n.options})),n}}function bi(t){return new yA({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=Y(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,l=r[r.length-1],a=r[0];let c=n.to;if(l){const u=a.search(/\S/),f=n.from+a.indexOf(l),p=f+l.length;if(Oh(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===t.type&&v!==m.mark.type)).filter(m=>m.to>f).length)return null;p<n.to&&s.delete(p,n.to),f>n.from&&s.delete(n.from+u,f),c=n.from+u+l.length,s.addMark(n.from+u,c,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}function rI(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof V){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}function iI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vb={exports:{}},gu={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function oI(){if(Wy)return gu;Wy=1;var t=ee;function e(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function l(f,p){var h=p(),m=r({inst:{value:h,getSnapshot:p}}),g=m[0].inst,v=m[1];return o(function(){g.value=h,g.getSnapshot=p,a(g)&&v({inst:g})},[f,h,p]),i(function(){return a(g)&&v({inst:g}),f(function(){a(g)&&v({inst:g})})},[f]),s(h),h}function a(f){var p=f.getSnapshot;f=f.value;try{var h=p();return!n(f,h)}catch{return!0}}function c(f,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return gu.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,gu}Vb.exports=oI();var Lh=Vb.exports;const sI=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},lI=({contentComponent:t})=>{const e=Lh.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return ee.createElement(ee.Fragment,null,Object.values(e))};function aI(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:Fk.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class cI extends ee.Component{constructor(e){var n;super(e),this.editorContentRef=ee.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=aI(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return ee.createElement(ee.Fragment,null,ee.createElement("div",{ref:sI(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&ee.createElement(lI,{contentComponent:e.contentComponent}))}}const dI=S.forwardRef((t,e)=>{const n=ee.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return ee.createElement(cI,{key:n,innerRef:e,...t})}),uI=ee.memo(dI);var fI=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n},pI=iI(fI),Wb={exports:{}},yu={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ky;function hI(){if(Ky)return yu;Ky=1;var t=ee,e=Lh;function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,l=t.useMemo,a=t.useDebugValue;return yu.useSyncExternalStoreWithSelector=function(c,u,f,p,h){var m=o(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=l(function(){function y(E){if(!x){if(x=!0,b=E,E=p(E),h!==void 0&&g.hasValue){var k=g.value;if(h(k,E))return w=k}return w=E}if(k=w,r(b,E))return k;var M=p(E);return h!==void 0&&h(k,M)?k:(b=E,w=M)}var x=!1,b,w,C=f===void 0?null:f;return[function(){return y(u())},C===null?void 0:function(){return y(C())}]},[u,f,p,h]);var v=i(c,m[0],m[1]);return s(function(){g.hasValue=!0,g.value=v},[v]),a(v),v},yu}Wb.exports=hI();var mI=Wb.exports;const gI=typeof window<"u"?S.useLayoutEffect:S.useEffect;class yI{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function xI(t){var e;const[n]=S.useState(()=>new yI(t.editor)),r=mI.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:pI);return gI(()=>n.watch(t.editor),[t.editor,n]),S.useDebugValue(r),r}const vI=!1,Zf=typeof window>"u",bI=Zf||!!(typeof window<"u"&&window.next);class Ph{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Zf||bI?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new tI(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)===null||s===void 0?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Ph.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function SI(t={},e=[]){const n=S.useRef(t);n.current=t;const[r]=S.useState(()=>new Ph(n)),i=Lh.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return S.useDebugValue(i),S.useEffect(r.onRender(e)),xI({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),i}const wI=S.createContext({editor:null});wI.Consumer;const kI=S.createContext({onDragStart:void 0}),CI=()=>S.useContext(kI);ee.forwardRef((t,e)=>{const{onDragStart:n}=CI(),r=t.as||"div";return ee.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const EI=/^\s*>\s$/,MI=Ct.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Xs({find:EI,type:this.type})]}}),TI=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,jI=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,DI=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,AI=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,II=hn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[xo({find:TI,type:this.type}),xo({find:DI,type:this.type})]},addPasteRules(){return[bi({find:jI,type:this.type}),bi({find:AI,type:this.type})]}}),RI="listItem",qy="textStyle",Jy=/^\s*([-+*])\s$/,zI=Ct.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(RI,this.editor.getAttributes(qy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Xs({find:Jy,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xs({find:Jy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(qy),editor:this.editor})),[t]}}),$I=/(^|[^`])`([^`]+)`(?!`)/,OI=/(^|[^`])`([^`]+)`(?!`)/g,NI=hn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[xo({find:$I,type:this.type})]},addPasteRules(){return[bi({find:OI,type:this.type})]}}),LI=/^```([a-z]+)?[\s\n]$/,PI=/^~~~([a-z]+)?[\s\n]$/,FI=Ct.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",$e(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:c})=>(c.setSelection(G.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[Xf({find:LI,type:this.type,getAttributes:t=>({language:t[1]})}),Xf({find:PI,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new et({key:new Pt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:l}=t.state,a=l.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},a)),s.selection.$from.parent.type!==this.type&&s.setSelection(K.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),BI=Ct.create({name:"doc",topNode:!0,content:"block+"});function _I(t={}){return new et({view(e){return new HI(e,t)}})}class HI{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,l=o.height/i.offsetHeight;if(n){let f=e.nodeBefore,p=e.nodeAfter;if(f||p){let h=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(h){let m=h.getBoundingClientRect(),g=f?m.bottom:m.top;f&&p&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*l;r={left:m.left,right:m.right,top:g-v,bottom:g+v}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*s;r={left:f.left-p,right:f.left+p,top:f.top,bottom:f.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let c,u;if(!a||a==document.body&&getComputedStyle(a).position=="static")c=-pageXOffset,u=-pageYOffset;else{let f=a.getBoundingClientRect(),p=f.width/a.offsetWidth,h=f.height/a.offsetHeight;c=f.left-a.scrollLeft*p,u=f.top-a.scrollTop*h}this.element.style.left=(r.left-c)/s+"px",this.element.style.top=(r.top-u)/l+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=Iv(this.editorView.state.doc,s,this.editorView.dragging.slice);l!=null&&(s=l)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const UI=Ze.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[_I(this.options)]}});class Ce extends G{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Ce.valid(r)?new Ce(r):G.near(r)}content(){return L.empty}eq(e){return e instanceof Ce&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ce(e.resolve(n.pos))}getBookmark(){return new Fh(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!VI(e)||!WI(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Ce.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(n>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let a=e.doc.resolve(i);if(Ce.valid(a))return a}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!V.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let l=e.doc.resolve(i);if(Ce.valid(l))return l}return null}}}Ce.prototype.visible=!1;Ce.findFrom=Ce.findGapCursorFrom;G.jsonID("gapcursor",Ce);class Fh{constructor(e){this.pos=e}map(e){return new Fh(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Ce.valid(n)?new Ce(n):G.near(n)}}function Kb(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function VI(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||Kb(i.type))return!0;if(i.inlineContent)return!1}}return!0}function WI(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||Kb(i.type))return!0;if(i.inlineContent)return!1}}return!0}function KI(){return new et({props:{decorations:YI,createSelectionBetween(t,e,n){return e.pos==n.pos&&Ce.valid(n)?new Ce(n):null},handleClick:JI,handleKeyDown:qI,handleDOMEvents:{beforeinput:GI}}})}const qI=bb({ArrowLeft:Ul("horiz",-1),ArrowRight:Ul("horiz",1),ArrowUp:Ul("vert",-1),ArrowDown:Ul("vert",1)});function Ul(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof K){if(!o.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let c=Ce.findGapCursorFrom(l,e,a);return c?(i&&i(r.tr.setSelection(new Ce(c))),!0):!1}}function JI(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Ce.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&V.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Ce(r))),!0)}function GI(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Ce))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=I.empty;for(let s=r.length-1;s>=0;s--)i=I.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new L(i,0,0));return o.setSelection(K.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function YI(t){if(!(t.selection instanceof Ce))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Re.create(t.doc,[Gt.widget(t.selection.head,e,{key:"gapcursor"})])}const QI=Ze.create({name:"gapCursor",addProseMirrorPlugins(){return[KI()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Y(F(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),XI=Ct.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",$e(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:l}=r.extensionManager,a=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&a&&s){const f=a.filter(p=>l.includes(p.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ZI=Ct.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,$e(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Xf({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var nc=200,_e=function(){};_e.prototype.append=function(e){return e.length?(e=_e.from(e),!this.length&&e||e.length<nc&&this.leafAppend(e)||this.length<nc&&e.leafPrepend(this)||this.appendInner(e)):this};_e.prototype.prepend=function(e){return e.length?_e.from(e).append(this):this};_e.prototype.appendInner=function(e){return new eR(this,e)};_e.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?_e.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};_e.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};_e.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};_e.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};_e.from=function(e){return e instanceof _e?e:e&&e.length?new qb(e):_e.empty};var qb=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,l){for(var a=o;a<s;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,l){for(var a=o-1;a>=s;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=nc)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=nc)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(_e);_e.empty=new qb([]);var eR=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(o,l),s)===!1||o>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,o)-l,s+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(o,l)-l,s+l)===!1||o<l&&this.left.forEachInvertedInner(r,Math.min(i,l),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(_e);const tR=500;class cn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,l,a,c=[],u=[];return this.items.forEach((f,p)=>{if(!f.step){i||(i=this.remapping(r,p+1),o=i.maps.length),o--,u.push(f);return}if(i){u.push(new bn(f.map));let h=f.step.map(i.slice(o)),m;h&&s.maybeStep(h).doc&&(m=s.mapping.maps[s.mapping.maps.length-1],c.push(new bn(m,void 0,void 0,c.length+u.length))),o--,m&&i.appendMap(m,o)}else s.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(o)):f.selection,a=new cn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:s,selection:l}}addTransform(e,n,r,i){let o=[],s=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),p=new bn(e.mapping.maps[u],f,n),h;(h=a&&a.merge(p))&&(p=h,u?o.pop():l=l.slice(0,l.length-1)),o.push(p),n&&(s++,n=void 0),i||(a=p)}let c=s-r.depth;return c>rR&&(l=nR(l,c),s-=c),new cn(l.append(o),s)}remapping(e,n){let r=new Ws;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new cn(this.items.append(e.map(n=>new bn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,l=this.eventCount;this.items.forEach(p=>{p.selection&&l--},i);let a=n;this.items.forEach(p=>{let h=o.getMirror(--a);if(h==null)return;s=Math.min(s,h);let m=o.maps[h];if(p.step){let g=e.steps[h].invert(e.docs[h]),v=p.selection&&p.selection.map(o.slice(a+1,h));v&&l++,r.push(new bn(m,g,v))}else r.push(new bn(m))},i);let c=[];for(let p=n;p<s;p++)c.push(new bn(o.maps[p]));let u=this.items.slice(0,i).append(c).append(r),f=new cn(u,l);return f.emptyItemCount()>tR&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,l)=>{if(l>=e)i.push(s),s.selection&&o++;else if(s.step){let a=s.step.map(n.slice(r)),c=a&&a.getMap();if(r--,c&&n.appendMap(c,r),a){let u=s.selection&&s.selection.map(n.slice(r));u&&o++;let f=new bn(c.invert(),a,u),p,h=i.length-1;(p=i.length&&i[h].merge(f))?i[h]=p:i.push(f)}}else s.map&&r--},this.items.length,0),new cn(_e.from(i.reverse()),o)}}cn.empty=new cn(_e.empty,0);function nR(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class bn{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new bn(n.getMap().invert(),n,this.selection)}}}class cr{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const rR=20;function iR(t,e,n,r){let i=n.getMeta(ai),o;if(i)return i.historyState;n.getMeta(lR)&&(t=new cr(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(ai))return s.getMeta(ai).redo?new cr(t.done.addTransform(n,void 0,r,ca(e)),t.undone,Gy(n.mapping.maps),t.prevTime,t.prevComposition):new cr(t.done,t.undone.addTransform(n,void 0,r,ca(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!s&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!oR(n,t.prevRanges)),c=s?xu(t.prevRanges,n.mapping):Gy(n.mapping.maps);return new cr(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,ca(e)),cn.empty,c,n.time,l??t.prevComposition)}else return(o=n.getMeta("rebased"))?new cr(t.done.rebased(n,o),t.undone.rebased(n,o),xu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new cr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),xu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function oR(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function Gy(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function xu(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function sR(t,e,n){let r=ca(e),i=ai.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),l=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),a=new cr(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(s).setMeta(ai,{redo:n,historyState:a})}let vu=!1,Yy=null;function ca(t){let e=t.plugins;if(Yy!=e){vu=!1,Yy=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){vu=!0;break}}return vu}const ai=new Pt("history"),lR=new Pt("closeHistory");function aR(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new et({key:ai,state:{init(){return new cr(cn.empty,cn.empty,null,0,-1)},apply(e,n,r){return iR(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?Gb:r=="historyRedo"?Yb:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function Jb(t,e){return(n,r)=>{let i=ai.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=sR(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const Gb=Jb(!1,!0),Yb=Jb(!0,!0),cR=Ze.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Gb(t,e),redo:()=>({state:t,dispatch:e})=>Yb(t,e)}},addProseMirrorPlugins(){return[aR(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),dR=Ct.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",$e(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!rI(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:i}=n,o=t();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):C5(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:l})=>{var a;if(l){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(K.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(V.create(s.doc,c.pos)):s.setSelection(K.create(s.doc,c.pos));else{const f=(a=c.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();f&&(s.insert(u,f),s.setSelection(K.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[nI({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),uR=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,fR=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,pR=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,hR=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,mR=hn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[xo({find:uR,type:this.type}),xo({find:pR,type:this.type})]},addPasteRules(){return[bi({find:fR,type:this.type}),bi({find:hR,type:this.type})]}}),gR=Ct.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",$e(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),yR="listItem",Qy="textStyle",Xy=/^(\d+)\.\s$/,xR=Ct.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",$e(this.options.HTMLAttributes,n),0]:["ol",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(yR,this.editor.getAttributes(Qy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Xs({find:Xy,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xs({find:Xy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Qy)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),vR=Ct.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),bR=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,SR=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,wR=hn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[xo({find:bR,type:this.type})]},addPasteRules(){return[bi({find:SR,type:this.type})]}}),kR=Ct.create({name:"text",group:"inline"}),CR=Ze.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(II.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(MI.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(zI.configure(this.options.bulletList)),this.options.code!==!1&&t.push(NI.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(FI.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(BI.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(UI.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(QI.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(XI.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(ZI.configure(this.options.heading)),this.options.history!==!1&&t.push(cR.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(dR.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(mR.configure(this.options.italic)),this.options.listItem!==!1&&t.push(gR.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(xR.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(vR.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(wR.configure(this.options.strike)),this.options.text!==!1&&t.push(kR.configure(this.options.text)),t}}),ER=hn.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),MR="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",TR="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",ep="numeric",tp="ascii",np="alpha",hs="asciinumeric",Go="alphanumeric",rp="domain",Qb="emoji",jR="scheme",DR="slashscheme",bu="whitespace";function AR(t,e){return t in e||(e[t]=[]),e[t]}function ti(t,e,n){e[ep]&&(e[hs]=!0,e[Go]=!0),e[tp]&&(e[hs]=!0,e[np]=!0),e[hs]&&(e[Go]=!0),e[np]&&(e[Go]=!0),e[Go]&&(e[rp]=!0),e[Qb]&&(e[rp]=!0);for(const r in e){const i=AR(r,n);i.indexOf(t)<0&&i.push(t)}}function IR(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function xt(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}xt.groups={};xt.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let i=0;i<t.length;i++)this.tt(t[i],e,n,r)},tr(t,e,n,r){r=r||xt.groups;let i;return e&&e.j?i=e:(i=new xt(e),n&&r&&ti(e,n,r)),this.jr.push([t,i]),i},ts(t,e,n,r){let i=this;const o=t.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(t[s]);return i.tt(t[o-1],e,n,r)},tt(t,e,n,r){r=r||xt.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const o=e;let s,l=i.go(t);if(l?(s=new xt,Object.assign(s.j,l.j),s.jr.push.apply(s.jr,l.jr),s.jd=l.jd,s.t=l.t):s=new xt,o){if(r)if(s.t&&typeof s.t=="string"){const a=Object.assign(IR(s.t,r),n);ti(o,a,r)}else n&&ti(o,n,r);s.t=o}return i.j[t]=s,s}};const J=(t,e,n,r,i)=>t.ta(e,n,r,i),we=(t,e,n,r,i)=>t.tr(e,n,r,i),Zy=(t,e,n,r,i)=>t.ts(e,n,r,i),R=(t,e,n,r,i)=>t.tt(e,n,r,i),On="WORD",ip="UWORD",Xb="ASCIINUMERICAL",Zb="ALPHANUMERICAL",Zs="LOCALHOST",op="TLD",sp="UTLD",da="SCHEME",Oi="SLASH_SCHEME",Bh="NUM",lp="WS",_h="NL",ms="OPENBRACE",gs="CLOSEBRACE",rc="OPENBRACKET",ic="CLOSEBRACKET",oc="OPENPAREN",sc="CLOSEPAREN",lc="OPENANGLEBRACKET",ac="CLOSEANGLEBRACKET",cc="FULLWIDTHLEFTPAREN",dc="FULLWIDTHRIGHTPAREN",uc="LEFTCORNERBRACKET",fc="RIGHTCORNERBRACKET",pc="LEFTWHITECORNERBRACKET",hc="RIGHTWHITECORNERBRACKET",mc="FULLWIDTHLESSTHAN",gc="FULLWIDTHGREATERTHAN",yc="AMPERSAND",xc="APOSTROPHE",vc="ASTERISK",dr="AT",bc="BACKSLASH",Sc="BACKTICK",wc="CARET",hr="COLON",Hh="COMMA",kc="DOLLAR",Sn="DOT",Cc="EQUALS",Uh="EXCLAMATION",Ht="HYPHEN",ys="PERCENT",Ec="PIPE",Mc="PLUS",Tc="POUND",xs="QUERY",Vh="QUOTE",eS="FULLWIDTHMIDDLEDOT",Wh="SEMI",wn="SLASH",vs="TILDE",jc="UNDERSCORE",tS="EMOJI",Dc="SYM";var nS=Object.freeze({__proto__:null,ALPHANUMERICAL:Zb,AMPERSAND:yc,APOSTROPHE:xc,ASCIINUMERICAL:Xb,ASTERISK:vc,AT:dr,BACKSLASH:bc,BACKTICK:Sc,CARET:wc,CLOSEANGLEBRACKET:ac,CLOSEBRACE:gs,CLOSEBRACKET:ic,CLOSEPAREN:sc,COLON:hr,COMMA:Hh,DOLLAR:kc,DOT:Sn,EMOJI:tS,EQUALS:Cc,EXCLAMATION:Uh,FULLWIDTHGREATERTHAN:gc,FULLWIDTHLEFTPAREN:cc,FULLWIDTHLESSTHAN:mc,FULLWIDTHMIDDLEDOT:eS,FULLWIDTHRIGHTPAREN:dc,HYPHEN:Ht,LEFTCORNERBRACKET:uc,LEFTWHITECORNERBRACKET:pc,LOCALHOST:Zs,NL:_h,NUM:Bh,OPENANGLEBRACKET:lc,OPENBRACE:ms,OPENBRACKET:rc,OPENPAREN:oc,PERCENT:ys,PIPE:Ec,PLUS:Mc,POUND:Tc,QUERY:xs,QUOTE:Vh,RIGHTCORNERBRACKET:fc,RIGHTWHITECORNERBRACKET:hc,SCHEME:da,SEMI:Wh,SLASH:wn,SLASH_SCHEME:Oi,SYM:Dc,TILDE:vs,TLD:op,UNDERSCORE:jc,UTLD:sp,UWORD:ip,WORD:On,WS:lp});const zn=/[a-z]/,Bo=new RegExp("\\p{L}","u"),Su=new RegExp("\\p{Emoji}","u"),$n=/\d/,wu=/\s/,ex="\r",ku=`
`,RR="",zR="",Cu="";let Vl=null,Wl=null;function $R(t=[]){const e={};xt.groups=e;const n=new xt;Vl==null&&(Vl=tx(MR)),Wl==null&&(Wl=tx(TR)),R(n,"'",xc),R(n,"{",ms),R(n,"}",gs),R(n,"[",rc),R(n,"]",ic),R(n,"(",oc),R(n,")",sc),R(n,"<",lc),R(n,">",ac),R(n,"",cc),R(n,"",dc),R(n,"",uc),R(n,"",fc),R(n,"",pc),R(n,"",hc),R(n,"",mc),R(n,"",gc),R(n,"&",yc),R(n,"*",vc),R(n,"@",dr),R(n,"`",Sc),R(n,"^",wc),R(n,":",hr),R(n,",",Hh),R(n,"$",kc),R(n,".",Sn),R(n,"=",Cc),R(n,"!",Uh),R(n,"-",Ht),R(n,"%",ys),R(n,"|",Ec),R(n,"+",Mc),R(n,"#",Tc),R(n,"?",xs),R(n,'"',Vh),R(n,"/",wn),R(n,";",Wh),R(n,"~",vs),R(n,"_",jc),R(n,"\\",bc),R(n,"",eS);const r=we(n,$n,Bh,{[ep]:!0});we(r,$n,r);const i=we(r,zn,Xb,{[hs]:!0}),o=we(r,Bo,Zb,{[Go]:!0}),s=we(n,zn,On,{[tp]:!0});we(s,$n,i),we(s,zn,s),we(i,$n,i),we(i,zn,i);const l=we(n,Bo,ip,{[np]:!0});we(l,zn),we(l,$n,o),we(l,Bo,l),we(o,$n,o),we(o,zn),we(o,Bo,o);const a=R(n,ku,_h,{[bu]:!0}),c=R(n,ex,lp,{[bu]:!0}),u=we(n,wu,lp,{[bu]:!0});R(n,Cu,u),R(c,ku,a),R(c,Cu,u),we(c,wu,u),R(u,ex),R(u,ku),we(u,wu,u),R(u,Cu,u);const f=we(n,Su,tS,{[Qb]:!0});R(f,"#"),we(f,Su,f),R(f,RR,f);const p=R(f,zR);R(p,"#"),we(p,Su,f);const h=[[zn,s],[$n,i]],m=[[zn,null],[Bo,l],[$n,o]];for(let g=0;g<Vl.length;g++)rr(n,Vl[g],op,On,h);for(let g=0;g<Wl.length;g++)rr(n,Wl[g],sp,ip,m);ti(op,{tld:!0,ascii:!0},e),ti(sp,{utld:!0,alpha:!0},e),rr(n,"file",da,On,h),rr(n,"mailto",da,On,h),rr(n,"http",Oi,On,h),rr(n,"https",Oi,On,h),rr(n,"ftp",Oi,On,h),rr(n,"ftps",Oi,On,h),ti(da,{scheme:!0,ascii:!0},e),ti(Oi,{slashscheme:!0,ascii:!0},e),t=t.sort((g,v)=>g[0]>v[0]?1:-1);for(let g=0;g<t.length;g++){const v=t[g][0],x=t[g][1]?{[jR]:!0}:{[DR]:!0};v.indexOf("-")>=0?x[rp]=!0:zn.test(v)?$n.test(v)?x[hs]=!0:x[tp]=!0:x[ep]=!0,Zy(n,v,v,x)}return Zy(n,"localhost",Zs,{ascii:!0}),n.jd=new xt(Dc),{start:n,tokens:Object.assign({groups:e},nS)}}function rS(t,e){const n=OR(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=n.length,i=[];let o=0,s=0;for(;s<r;){let l=t,a=null,c=0,u=null,f=-1,p=-1;for(;s<r&&(a=l.go(n[s]));)l=a,l.accepts()?(f=0,p=0,u=l):f>=0&&(f+=n[s].length,p++),c+=n[s].length,o+=n[s].length,s++;o-=f,s-=p,c-=f,i.push({t:u.t,v:e.slice(o-c,o),s:o-c,e:o})}return i}function OR(t){const e=[],n=t.length;let r=0;for(;r<n;){let i=t.charCodeAt(r),o,s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}function rr(t,e,n,r,i){let o;const s=e.length;for(let l=0;l<s-1;l++){const a=e[l];t.j[a]?o=t.j[a]:(o=new xt(r),o.jr=i.slice(),t.j[a]=o),t=o}return o=new xt(n),o.jr=i.slice(),t.j[e[s-1]]=o,o}function tx(t){const e=[],n=[];let r=0,i="0123456789";for(;r<t.length;){let o=0;for(;i.indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let s=parseInt(t.substring(r,r+o),10);s>0;s--)n.pop();r+=o}else n.push(t[r]),r++}return e}const el={defaultProtocol:"http",events:null,format:nx,formatHref:nx,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Kh(t,e=null){let n=Object.assign({},el);t&&(n=Object.assign(n,t instanceof Kh?t.o:t));const r=n.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=i}Kh.prototype={o:el,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:el[t],typeof i=="function"&&r&&(i=i(e,n))):typeof i=="function"&&r&&(i=i(e,n.t,n)),i)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function nx(t){return t}function iS(t,e){this.t="token",this.v=t,this.tk=e}iS.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=el.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),i=t.get("tagName",n,e),o=this.toFormattedString(t),s={},l=t.get("className",n,e),a=t.get("target",n,e),c=t.get("rel",n,e),u=t.getObj("attributes",n,e),f=t.getObj("events",n,e);return s.href=r,l&&(s.class=l),a&&(s.target=a),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:i,attributes:s,content:o,eventListeners:f}}};function fd(t,e){class n extends iS{constructor(i,o){super(i,o),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const rx=fd("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),ix=fd("text"),NR=fd("nl"),Kl=fd("url",{isLink:!0,toHref(t=el.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Zs&&t[1].t===hr}}),_t=t=>new xt(t);function LR({groups:t}){const e=t.domain.concat([yc,vc,dr,bc,Sc,wc,kc,Cc,Ht,Bh,ys,Ec,Mc,Tc,wn,Dc,vs,jc]),n=[xc,hr,Hh,Sn,Uh,ys,xs,Vh,Wh,lc,ac,ms,gs,ic,rc,oc,sc,cc,dc,uc,fc,pc,hc,mc,gc],r=[yc,xc,vc,bc,Sc,wc,kc,Cc,Ht,ms,gs,ys,Ec,Mc,Tc,xs,wn,Dc,vs,jc],i=_t(),o=R(i,vs);J(o,r,o),J(o,t.domain,o);const s=_t(),l=_t(),a=_t();J(i,t.domain,s),J(i,t.scheme,l),J(i,t.slashscheme,a),J(s,r,o),J(s,t.domain,s);const c=R(s,dr);R(o,dr,c),R(l,dr,c),R(a,dr,c);const u=R(o,Sn);J(u,r,o),J(u,t.domain,o);const f=_t();J(c,t.domain,f),J(f,t.domain,f);const p=R(f,Sn);J(p,t.domain,f);const h=_t(rx);J(p,t.tld,h),J(p,t.utld,h),R(c,Zs,h);const m=R(f,Ht);R(m,Ht,m),J(m,t.domain,f),J(h,t.domain,f),R(h,Sn,p),R(h,Ht,m);const g=R(h,hr);J(g,t.numeric,rx);const v=R(s,Ht),y=R(s,Sn);R(v,Ht,v),J(v,t.domain,s),J(y,r,o),J(y,t.domain,s);const x=_t(Kl);J(y,t.tld,x),J(y,t.utld,x),J(x,t.domain,s),J(x,r,o),R(x,Sn,y),R(x,Ht,v),R(x,dr,c);const b=R(x,hr),w=_t(Kl);J(b,t.numeric,w);const C=_t(Kl),E=_t();J(C,e,C),J(C,n,E),J(E,e,C),J(E,n,E),R(x,wn,C),R(w,wn,C);const k=R(l,hr),M=R(a,hr),$=R(M,wn),O=R($,wn);J(l,t.domain,s),R(l,Sn,y),R(l,Ht,v),J(a,t.domain,s),R(a,Sn,y),R(a,Ht,v),J(k,t.domain,C),R(k,wn,C),R(k,xs,C),J(O,t.domain,C),J(O,e,C),R(O,wn,C);const _=[[ms,gs],[rc,ic],[oc,sc],[lc,ac],[cc,dc],[uc,fc],[pc,hc],[mc,gc]];for(let oe=0;oe<_.length;oe++){const[ae,me]=_[oe],Oe=R(C,ae);R(E,ae,Oe),R(Oe,me,C);const Ee=_t(Kl);J(Oe,e,Ee);const ue=_t();J(Oe,n),J(Ee,e,Ee),J(Ee,n,ue),J(ue,e,Ee),J(ue,n,ue),R(Ee,me,C),R(ue,me,C)}return R(i,Zs,x),R(i,_h,NR),{start:i,tokens:nS}}function PR(t,e,n){let r=n.length,i=0,o=[],s=[];for(;i<r;){let l=t,a=null,c=null,u=0,f=null,p=-1;for(;i<r&&!(a=l.go(n[i].t));)s.push(n[i++]);for(;i<r&&(c=a||l.go(n[i].t));)a=null,l=c,l.accepts()?(p=0,f=l):p>=0&&p++,i++,u++;if(p<0)i-=u,i<r&&(s.push(n[i]),i++);else{s.length>0&&(o.push(Eu(ix,e,s)),s=[]),i-=p,u-=p;const h=f.t,m=n.slice(i-u,i);o.push(Eu(h,e,m))}}return s.length>0&&o.push(Eu(ix,e,s)),o}function Eu(t,e,n){const r=n[0].s,i=n[n.length-1].e,o=e.slice(r,i);return new t(o,n)}const FR=typeof console<"u"&&console&&console.warn||(()=>{}),BR="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",pe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function _R(){return xt.groups={},pe.scanner=null,pe.parser=null,pe.tokenQueue=[],pe.pluginQueue=[],pe.customSchemes=[],pe.initialized=!1,pe}function ox(t,e=!1){if(pe.initialized&&FR(`linkifyjs: already initialized - will not register custom scheme "${t}" ${BR}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);pe.customSchemes.push([t,e])}function HR(){pe.scanner=$R(pe.customSchemes);for(let t=0;t<pe.tokenQueue.length;t++)pe.tokenQueue[t][1]({scanner:pe.scanner});pe.parser=LR(pe.scanner.tokens);for(let t=0;t<pe.pluginQueue.length;t++)pe.pluginQueue[t][1]({scanner:pe.scanner,parser:pe.parser});return pe.initialized=!0,pe}function qh(t){return pe.initialized||HR(),PR(pe.parser.start,t,rS(pe.scanner.start,t))}qh.scan=rS;function oS(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Kh(n),i=qh(t),o=[];for(let s=0;s<i.length;s++){const l=i[s];l.isLink&&(!e||l.t===e)&&r.check(l)&&o.push(l.toFormattedObject(r))}return o}const Jh="[\0- -\u2029]",UR=new RegExp(Jh),VR=new RegExp(`${Jh}$`),WR=new RegExp(Jh,"g");function KR(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function qR(t){return new et({key:new Pt("autolink"),appendTransaction:(e,n,r)=>{const i=e.some(c=>c.docChanged)&&!n.doc.eq(r.doc),o=e.some(c=>c.getMeta("preventAutolink"));if(!i||o)return;const{tr:s}=r,l=h5(n.doc,[...e]);if(w5(l).forEach(({newRange:c})=>{const u=g5(r.doc,c,h=>h.isTextblock);let f,p;if(u.length>1)f=u[0],p=r.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(u.length){const h=r.doc.textBetween(c.from,c.to," "," ");if(!VR.test(h))return;f=u[0],p=r.doc.textBetween(f.pos,c.to,void 0," ")}if(f&&p){const h=p.split(UR).filter(Boolean);if(h.length<=0)return!1;const m=h[h.length-1],g=f.pos+p.lastIndexOf(m);if(!m)return!1;const v=qh(m).map(y=>y.toObject(t.defaultProtocol));if(!KR(v))return!1;v.filter(y=>y.isLink).map(y=>({...y,from:g+y.start+1,to:g+y.end+1})).filter(y=>r.schema.marks.code?!r.doc.rangeHasMark(y.from,y.to,r.schema.marks.code):!0).filter(y=>t.validate(y.value)).filter(y=>t.shouldAutoLink(y.value)).forEach(y=>{Oh(y.from,y.to,r.doc).some(x=>x.mark.type===t.type)||s.addMark(y.from,y.to,t.type.create({href:y.href}))})}}),!!s.steps.length)return s}})}function JR(t){return new et({key:new Pt("handleClickLink"),props:{handleClick:(e,n,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let s=r.target;const l=[];for(;s.nodeName!=="DIV";)l.push(s),s=s.parentNode;if(!l.find(p=>p.nodeName==="A"))return!1;const a=Ub(e.state,t.type.name),c=r.target,u=(i=c==null?void 0:c.href)!==null&&i!==void 0?i:a.href,f=(o=c==null?void 0:c.target)!==null&&o!==void 0?o:a.target;return c&&u?(window.open(u,f),!0):!1}}})}function GR(t){return new et({key:new Pt("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:i}=e,{selection:o}=i,{empty:s}=o;if(s)return!1;let l="";r.content.forEach(c=>{l+=c.textContent});const a=oS(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!a?!1:t.editor.commands.setMark(t.type,{href:a.href})}}})}function Hr(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&n.push(i)}),!t||t.replace(WR,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const YR=hn.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){ox(t);return}ox(t.scheme,t.optionalSlashes)})},onDestroy(){_R()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Hr(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Hr(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Hr(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",$e(this.options.HTMLAttributes,t),0]:["a",$e(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Hr(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Hr(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[bi({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,i=oS(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!Hr(s,n),protocols:n,defaultProtocol:r}));i.length&&i.forEach(o=>e.push({text:o.value,data:{href:o.href},index:o.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(qR({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!Hr(i,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(JR({type:this.type})),this.options.linkOnPaste&&t.push(GR({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),QR=t=>{if(!t.children.length)return;const e=t.querySelectorAll("span");e&&e.forEach(n=>{var r,i;const o=n.getAttribute("style"),s=(i=(r=n.parentElement)===null||r===void 0?void 0:r.closest("span"))===null||i===void 0?void 0:i.getAttribute("style");n.setAttribute("style",`${s};${o}`)})},XR=hn.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&QR(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",$e(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(o=>!!o))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),ZR=Ze.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return(e=t.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),ez=Ze.create({name:"fontSize",addGlobalAttributes(){return[{types:["textStyle"],attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize||null,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).run()}}});function tz({html:t,placeholder:e,onChangeHtml:n,contentStyle:r}){const i=S.useMemo(()=>[CR.configure({heading:{levels:[1,2,3]}}),ER,YR.configure({openOnClick:!1,autolink:!1,linkOnPaste:!0}),XR,ZR,ez],[]),o=SI({extensions:i,content:t||"",editorProps:{attributes:{"data-rich-editor":"1",style:"outline:none; min-height: 24px; "}},onUpdate:({editor:u})=>{n(u.getHTML())}});if(S.useEffect(()=>{if(!o)return;const u=o.getHTML(),f=t||"";u!==f&&o.commands.setContent(f,!1)},[o,t]),!o)return null;const s={border:"1px solid var(--color-border)",background:"var(--color-surface)",borderRadius:8,padding:"6px 10px",fontFamily:"var(--font-body)",fontSize:12,cursor:"pointer"},l={display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},a=u=>u?{background:"rgba(0,156,222,0.12)",borderColor:"rgba(0,156,222,0.35)"}:{},c=()=>{const u=o.getAttributes("link").href,f=window.prompt("Link URL",u||"")||"";if(!f){o.chain().focus().extendMarkRange("link").unsetLink().run();return}o.chain().focus().extendMarkRange("link").setLink({href:f}).run()};return d.jsxs("div",{style:{display:"grid",gap:10},children:[d.jsxs("div",{style:l,children:[d.jsx("button",{type:"button",style:{...s,...a(o.isActive("bold"))},onClick:()=>o.chain().focus().toggleBold().run(),children:d.jsx("b",{children:"B"})}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("italic"))},onClick:()=>o.chain().focus().toggleItalic().run(),children:d.jsx("i",{children:"I"})}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("underline"))},onClick:()=>o.chain().focus().toggleUnderline().run(),children:d.jsx("u",{children:"U"})}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("bulletList"))},onClick:()=>o.chain().focus().toggleBulletList().run(),children:" List"}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("orderedList"))},onClick:()=>o.chain().focus().toggleOrderedList().run(),children:"1. List"}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("blockquote"))},onClick:()=>o.chain().focus().toggleBlockquote().run(),children:"Quote"}),d.jsx("button",{type:"button",style:{...s,...a(o.isActive("link"))},onClick:c,children:"Link"}),d.jsx("span",{style:{width:1,height:22,background:"var(--color-border)",margin:"0 2px"}}),d.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-muted)"},children:["Color",d.jsx("input",{type:"color",value:o.getAttributes("textStyle").color||"#1A2B4A",onChange:u=>o.chain().focus().setColor(u.target.value).run(),style:{width:28,height:20,padding:0,border:"1px solid var(--color-border)",borderRadius:6,background:"transparent"}})]}),d.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-muted)"},children:["Size",d.jsxs("select",{value:o.getAttributes("textStyle").fontSize||"",onChange:u=>{const f=u.target.value;f?o.commands.setFontSize(f):o.commands.unsetFontSize()},style:{height:28,borderRadius:8,border:"1px solid var(--color-border)",background:"var(--color-surface)",padding:"0 8px",fontFamily:"var(--font-body)",fontSize:12},children:[d.jsx("option",{value:"",children:"Default"}),d.jsx("option",{value:"12px",children:"12"}),d.jsx("option",{value:"14px",children:"14"}),d.jsx("option",{value:"16px",children:"16"}),d.jsx("option",{value:"18px",children:"18"}),d.jsx("option",{value:"20px",children:"20"}),d.jsx("option",{value:"24px",children:"24"})]})]}),d.jsx("button",{type:"button",style:s,onClick:()=>o.chain().focus().undo().run(),children:"Undo"}),d.jsx("button",{type:"button",style:s,onClick:()=>o.chain().focus().redo().run(),children:"Redo"})]}),d.jsxs("div",{style:{border:"1px solid var(--color-border)",borderRadius:12,padding:12,background:"var(--color-surface)",minHeight:60,...r||{}},children:[e&&!o.getText().trim()?d.jsx("div",{style:{position:"absolute",opacity:0,pointerEvents:"none"},children:e}):null,d.jsx(uI,{editor:o})]})]})}const ht=(t=32,e=40)=>({padding:`${t}px ${e}px`});function nz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=t.backgroundStyle==="solid"?e.primary:`linear-gradient(135deg, ${e.primary} 0%, ${e.secondary} 60%, ${e.accent}44 100%)`;return d.jsxs("div",{className:"nap-white-section",style:{background:i,padding:"48px 40px",textAlign:"center",position:"relative",overflow:"hidden",color:"#fff"},children:[d.jsx("svg",{style:{position:"absolute",bottom:0,left:0,right:0,opacity:.08},viewBox:"0 0 800 60",fill:"none",preserveAspectRatio:"none",height:60,children:d.jsx("path",{d:"M0 40 Q200 0 400 30 Q600 60 800 20 L800 60 L0 60Z",fill:"white"})}),(t.logoDataUrl||t.logoUrl)&&d.jsx("div",{style:{marginBottom:20},children:d.jsx("img",{src:t.logoDataUrl||t.logoUrl,alt:"Logo",style:{maxHeight:60,maxWidth:240,borderRadius:8}})}),d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:11,letterSpacing:"0.22em",textTransform:"uppercase",color:"rgba(255,255,255,0.65)",marginBottom:12},children:[t.issueNumber,"  ",t.issueDate]}),d.jsx("h1",{style:{fontFamily:e.fontDisplay,fontSize:46,fontWeight:400,color:"#fff",margin:"0 0 10px",letterSpacing:"-0.02em",lineHeight:1.1},children:n?d.jsx(H,{value:t.title,placeholder:"Newsletter title",onCommit:o=>r({title:o}),style:{display:"block",width:"100%"}}):t.title}),d.jsx("p",{style:{fontFamily:e.fontDisplay,fontSize:20,fontStyle:"italic",color:"rgba(255,255,255,0.85)",margin:"0 0 18px",lineHeight:1.3},children:n?d.jsx(H,{value:t.subtitle,placeholder:"Subtitle",onCommit:o=>r({subtitle:o}),style:{display:"block",width:"100%"}}):t.subtitle}),d.jsx("div",{style:{height:1,background:"rgba(255,255,255,0.2)",maxWidth:280,margin:"0 auto 18px"}}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:"rgba(255,255,255,0.65)",margin:0,letterSpacing:"0.02em"},children:n?d.jsx(H,{value:t.tagline,placeholder:"Tagline",onCommit:o=>r({tagline:o}),style:{display:"block",width:"100%"}}):t.tagline})]})}function rz({block:t,theme:e}){const r={slow:60,medium:36,fast:20}[t.speed]||36,i="https://api.allorigins.win/get?url=",[o,s]=S.useState([]),l=S.useCallback(p=>{try{const m=new DOMParser().parseFromString(p,"text/xml");if(m.querySelector("parsererror"))return[];const g=Array.from(m.querySelectorAll("item"));return g.length?g.map(y=>{var x,b,w,C;return{text:((b=(x=y.querySelector("title"))==null?void 0:x.textContent)==null?void 0:b.trim())||"",url:((C=(w=y.querySelector("link"))==null?void 0:w.textContent)==null?void 0:C.trim())||""}}).filter(y=>!!y.text):Array.from(m.querySelectorAll("entry")).map(y=>{var x,b,w,C,E;return{text:((b=(x=y.querySelector("title"))==null?void 0:x.textContent)==null?void 0:b.trim())||"",url:((w=y.querySelector("link"))==null?void 0:w.getAttribute("href"))||((E=(C=y.querySelector("link"))==null?void 0:C.textContent)==null?void 0:E.trim())||""}}).filter(y=>!!y.text)}catch{return[]}},[]);S.useEffect(()=>{let p=!1;async function h(){if(t.sourceMode!=="rss"){s([]);return}const m=(t.rssUrls||[]).filter(Boolean);if(!m.length){s([]);return}const g=[];for(const b of m)try{const w=await fetch(i+encodeURIComponent(b),{cache:"no-store"});if(!w.ok)continue;const C=await w.json(),E=C&&typeof C.contents=="string"?C.contents:"";g.push(...l(E))}catch{}const v=new Set,x=g.filter(b=>{const w=b.url||b.text;return!w||v.has(w)?!1:(v.add(w),!0)}).slice(0,Math.max(1,t.rssMaxItems||20));p||s(x)}return h(),()=>{p=!0}},[t.sourceMode,(t.rssUrls||[]).join("|"),t.rssMaxItems,l]);const a=t.sourceMode==="rss"&&o.length>0,c=!a&&t.useLinks&&(t.links||[]).length>0,u=a?[...o,...o]:c?[...t.links||[],...t.links||[]]:[],f=a||c?[]:[...t.items||[],...t.items||[]];return d.jsxs("div",{className:"nap-ticker",style:{background:t.backgroundColor||e.primary,overflow:"hidden",height:40,display:"flex",alignItems:"center",color:t.textColor||"#fff"},children:[d.jsx("style",{children:"@keyframes ticker{from{transform:translateX(0)}to{transform:translateX(-50%)}}"}),d.jsx("div",{style:{display:"flex",gap:0,whiteSpace:"nowrap",animation:`ticker ${r}s linear infinite`,willChange:"transform"},children:u.length?u.map((p,h)=>d.jsxs("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",style:{fontFamily:e.fontMono,fontSize:12,color:t.textColor||"#fff",padding:"0 32px",letterSpacing:"0.04em",display:"inline-flex",alignItems:"center",gap:10,textDecoration:"none",cursor:"pointer"},children:[d.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:e.accent,display:"inline-block",flexShrink:0}}),p.text,d.jsx("span",{style:{fontSize:10,opacity:.6},children:""})]},h)):f.map((p,h)=>d.jsxs("span",{style:{fontFamily:e.fontMono,fontSize:12,color:t.textColor||"#fff",padding:"0 32px",letterSpacing:"0.04em",display:"inline-flex",alignItems:"center",gap:10},children:[d.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:e.accent,display:"inline-block",flexShrink:0}}),p]},h))})]})}function iz({block:t,theme:e,editable:n,onUpdateBlock:r}){return t.style==="bold"?d.jsxs("div",{className:"nap-white-section",style:{background:e.primary,padding:"18px 40px",display:"flex",alignItems:"center",gap:16,color:"#fff"},children:[t.number>0&&d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:32,fontWeight:300,color:"rgba(255,255,255,0.25)",lineHeight:1},children:String(t.number).padStart(2,"0")}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.22em",textTransform:"uppercase",color:"rgba(255,255,255,0.5)",marginBottom:2},children:"Section"}),d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:22,color:"#fff",lineHeight:1.15},children:n?d.jsx(H,{value:t.label,placeholder:"Section title",onCommit:i=>r({label:i}),style:{display:"block",width:"100%"}}):t.label})]})]}):d.jsxs("div",{style:{padding:"32px 40px 16px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:t.description?10:0},children:[d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.22em",textTransform:"uppercase",color:e.muted,whiteSpace:"nowrap"},children:[d.jsx("span",{children:t.number>0?`0${t.number}  `:" "}),n?d.jsx(H,{value:t.label,placeholder:"Section title",onCommit:i=>r({label:i}),style:{display:"block",width:"100%",color:e.muted}}):d.jsx("span",{children:t.label}),d.jsx("span",{children:" "})]}),d.jsx("div",{style:{flex:1,height:1,background:`linear-gradient(90deg, ${e.border}, transparent)`}})]}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:0,lineHeight:1.6},children:n?d.jsx(H,{value:t.description||"",placeholder:"Section description",multiline:!0,onCommit:i=>r({description:i}),style:{minHeight:18}}):t.description})]})}function oz({block:t,theme:e,editable:n,onUpdateBlock:r,onUpdateArticle:i}){return d.jsxs("div",{style:ht(24,40),children:[t.sectionTitle!==void 0&&d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 20px",fontWeight:400},children:n?d.jsx(H,{value:t.sectionTitle||"",placeholder:"Section title",onCommit:o=>r({sectionTitle:o}),style:{display:"block",width:"100%"}}):t.sectionTitle}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${t.columns}, 1fr)`,gap:20},children:(t.articles||[]).map(o=>d.jsx(sz,{article:o,theme:e,layout:t.layout,editable:n,onUpdate:s=>i(o.id,s)},o.id))})]})}function sz({article:t,theme:e,layout:n,editable:r,onUpdate:i}){const o={High:"#00A651",Moderate:"#F47920",Low:"#C0392B","Expert Opinion":"#7B2D8B"};return d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:12,overflow:"hidden",background:e.surface,display:"flex",flexDirection:"column"},children:[t.imageUrl&&d.jsx("div",{style:{height:160,overflow:"hidden",flexShrink:0},children:d.jsx("img",{src:t.imageUrl,alt:t.title,style:{width:"100%",height:"100%",objectFit:"cover"}})}),d.jsxs("div",{style:{padding:n==="compact"?"10px 14px":"16px",flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8,flexWrap:"wrap",gap:6},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:e.muted},children:r?d.jsx(H,{value:t.source||"",placeholder:"Source",onCommit:s=>i({source:s}),style:{display:"block",width:"100%",color:e.muted}}):t.source}),t.evidenceLevel&&d.jsx("span",{style:{background:o[t.evidenceLevel]+"22",color:o[t.evidenceLevel],border:`1px solid ${o[t.evidenceLevel]}44`,borderRadius:999,padding:"2px 8px",fontFamily:e.fontMono,fontSize:10,fontWeight:600},children:t.evidenceLevel})]}),d.jsx("h3",{style:{fontFamily:e.fontDisplay,fontSize:n==="compact"?16:20,color:e.text,margin:"0 0 10px",lineHeight:1.25,fontWeight:400},children:r?d.jsx(H,{value:t.title||"",placeholder:"Article title",multiline:!1,onCommit:s=>i({title:s}),style:{display:"block",width:"100%"}}):t.url?d.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},onMouseEnter:s=>s.currentTarget.style.color=e.accent,onMouseLeave:s=>s.currentTarget.style.color=e.text,children:t.title}):t.title}),!n.includes("compact")&&d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.muted,margin:"0 0 12px",lineHeight:1.6,flex:1},children:r?d.jsx(H,{value:t.summary||"",placeholder:"Summary",multiline:!0,onCommit:s=>i({summary:s}),style:{minHeight:18,color:e.muted}}):t.summary}),d.jsxs("div",{style:{background:e.background,borderRadius:8,padding:"10px 12px",marginBottom:10},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.12em",textTransform:"uppercase",color:e.muted,marginBottom:4},children:"Clinical Context"}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.text,margin:0,lineHeight:1.55},children:r?d.jsx(H,{value:t.clinicalContext||"",placeholder:"Clinical context",multiline:!0,onCommit:s=>i({clinicalContext:s}),style:{minHeight:18}}):t.clinicalContext})]}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.secondary,fontStyle:"italic",margin:"0 0 12px",borderLeft:`3px solid ${e.accent}`,paddingLeft:10,lineHeight:1.5},children:r?d.jsx(H,{value:t.myTake||"",placeholder:"My take",multiline:!0,onCommit:s=>i({myTake:s}),style:{minHeight:18,color:e.secondary}}):t.myTake}),t.url&&d.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",style:{marginTop:"auto",display:"inline-flex",alignItems:"center",gap:5,fontFamily:e.fontBody,fontSize:12,color:e.accent,fontWeight:600,textDecoration:"none"},children:["Read full paper ",d.jsx("span",{style:{fontSize:14},children:""})]})]})]})}function lz({block:t,theme:e,editable:n,onUpdateArticle:r}){const i=t.article,o=t.layout==="left-image",s=t.layout==="top-image",l=!!i.imageUrl;return s&&l?d.jsx("div",{style:ht(24,40),children:d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:14,overflow:"hidden",background:e.surface},children:[d.jsx("img",{src:i.imageUrl,alt:i.title,style:{width:"100%",height:280,objectFit:"cover"}}),d.jsx("div",{style:{padding:24},children:d.jsx(sx,{art:i,theme:e,accentColor:t.accentColor,editable:n,onUpdate:a=>r(i.id,a)})})]})}):d.jsx("div",{style:ht(24,40),children:d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:14,overflow:"hidden",background:e.surface,display:"flex",flexDirection:l?o?"row":"row-reverse":"column"},children:[l&&d.jsx("div",{style:{width:"40%",flexShrink:0},children:d.jsx("img",{src:i.imageUrl,alt:i.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})}),d.jsxs("div",{style:{flex:1,padding:28,borderLeft:l&&o?`4px solid ${t.accentColor||e.accent}`:void 0,minWidth:0},children:[d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.muted,marginBottom:12},children:[" Spotlight  ",i.source]}),d.jsx(sx,{art:i,theme:e,accentColor:t.accentColor,editable:n,onUpdate:a=>r(i.id,a)})]})]})})}function sx({art:t,theme:e,accentColor:n,editable:r,onUpdate:i}){return d.jsxs(d.Fragment,{children:[d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:28,color:e.text,margin:"0 0 12px",fontWeight:400,lineHeight:1.2},children:r?d.jsx(H,{value:t.title||"",placeholder:"Spotlight title",onCommit:o=>i({title:o}),style:{display:"block",width:"100%"}}):t.url?d.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},children:t.title}):t.title}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:15,color:e.muted,margin:"0 0 16px",lineHeight:1.65},children:r?d.jsx(H,{value:t.summary||"",placeholder:"Summary",multiline:!0,onCommit:o=>i({summary:o}),style:{minHeight:22,color:e.muted}}):t.summary}),d.jsxs("div",{style:{background:e.background,borderRadius:10,padding:"14px 16px",marginBottom:14},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.12em",textTransform:"uppercase",color:e.muted,marginBottom:6},children:"Clinical Context"}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.text,margin:0,lineHeight:1.6},children:r?d.jsx(H,{value:t.clinicalContext||"",placeholder:"Clinical context",multiline:!0,onCommit:o=>i({clinicalContext:o}),style:{minHeight:22}}):t.clinicalContext})]}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,fontStyle:"italic",color:e.secondary,margin:"0 0 16px",borderLeft:`3px solid ${n}`,paddingLeft:12,lineHeight:1.6},children:r?d.jsx(H,{value:t.myTake||"",placeholder:"My take",multiline:!0,onCommit:o=>i({myTake:o}),style:{minHeight:22,color:e.secondary}}):t.myTake}),t.url&&d.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex",alignItems:"center",gap:8,padding:"9px 18px",background:n||e.accent,color:"#fff",borderRadius:8,fontFamily:e.fontBody,fontSize:13,fontWeight:600,textDecoration:"none"},children:"Read the paper "})]})}function az({block:t,theme:e,editable:n,onUpdateBlock:r}){return d.jsxs("div",{style:ht(28,40),children:[d.jsxs("div",{style:{marginBottom:20},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent,marginBottom:6},children:" AI Ethics & Governance"}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 6px",fontWeight:400},children:n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:i=>r({heading:i}),style:{display:"block",width:"100%"}}):t.heading}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:0},children:n?d.jsx(H,{value:t.subheading||"",placeholder:"Subheading",multiline:!0,onCommit:i=>r({subheading:i}),style:{minHeight:18,color:e.muted}}):t.subheading}),t.source!==void 0&&d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:11,color:e.muted,marginTop:6},children:["Source:"," ",n?d.jsx(H,{value:t.source||"",placeholder:"Source",onCommit:i=>r({source:i}),style:{display:"block",width:"100%",color:e.muted}}):t.url?d.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.accent},children:t.source}):t.source]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:12,padding:20,background:e.background},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"#C0392B",fontWeight:700,marginBottom:10},children:n?d.jsx(H,{value:t.leftTitle||"",placeholder:"Left title",onCommit:i=>r({leftTitle:i}),style:{display:"block",width:"100%",color:"#C0392B"}}):t.leftTitle}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.text,margin:0,lineHeight:1.65},children:n?d.jsx(H,{value:t.leftContent||"",placeholder:"Left content",multiline:!0,onCommit:i=>r({leftContent:i}),style:{minHeight:18}}):t.leftContent})]}),d.jsxs("div",{style:{border:`1px solid ${e.accent}44`,borderRadius:12,padding:20,background:e.accent+"0A"},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:e.accent,fontWeight:700,marginBottom:10},children:n?d.jsx(H,{value:t.rightTitle||"",placeholder:"Right title",onCommit:i=>r({rightTitle:i}),style:{display:"block",width:"100%",color:e.accent}}):t.rightTitle}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.text,margin:0,lineHeight:1.65},children:n?d.jsx(H,{value:t.rightContent||"",placeholder:"Right content",multiline:!0,onCommit:i=>r({rightContent:i}),style:{minHeight:18}}):t.rightContent})]})]}),d.jsxs("div",{style:{marginTop:16,padding:"14px 18px",border:`1px solid ${e.border}`,borderRadius:12,borderLeft:`4px solid ${e.accent}`},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:e.muted,marginBottom:6},children:"Clinical Perspective"}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.text,margin:0,lineHeight:1.65},children:n?d.jsx(H,{value:t.clinicalPerspective||"",placeholder:"Clinical perspective",multiline:!0,onCommit:i=>r({clinicalPerspective:i}),style:{minHeight:18}}):t.clinicalPerspective})]})]})}function cz({block:t,theme:e}){const n=t.dataUrl||t.url,i={full:"100%",wide:"80%",medium:"60%",small:"40%"}[t.width]||"100%";return n?d.jsxs("div",{style:{padding:"16px 40px",textAlign:t.alignment},children:[t.linkUrl?d.jsx("a",{href:t.linkUrl,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",maxWidth:i},children:d.jsx("img",{src:n,alt:t.alt,style:{width:"100%",borderRadius:t.borderRadius,display:"block"}})}):d.jsx("img",{src:n,alt:t.alt,style:{maxWidth:i,width:"100%",borderRadius:t.borderRadius,display:"inline-block"}}),t.caption&&d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:12,color:e.muted,margin:"8px 0 0",textAlign:"center"},children:t.caption})]}):d.jsx("div",{style:{padding:"24px 40px",textAlign:t.alignment},children:d.jsx("div",{style:{display:"inline-block",border:`2px dashed ${e.border}`,borderRadius:12,padding:"40px 60px",color:e.muted,fontFamily:e.fontBody,fontSize:13},children:" No image  configure in Block Settings"})})}function dz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i={full:"100%",reading:"720px",narrow:"560px"};return d.jsx("div",{style:{padding:"16px 40px"},children:d.jsx("div",{style:{fontFamily:e.fontBody,color:e.text,lineHeight:1.7,maxWidth:i[t.maxWidth]||"100%",margin:"0 auto",textAlign:t.alignment,fontSize:15},children:n?d.jsx(tz,{html:t.html||"",placeholder:"Type here",onChangeHtml:o=>r({html:o})}):d.jsx("div",{dangerouslySetInnerHTML:{__html:t.html}})})})}function uz({block:t,theme:e,editable:n,onUpdateBlock:r}){return d.jsxs("div",{style:{padding:"16px 40px"},children:[d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.12em",textTransform:"uppercase",color:e.muted,marginBottom:8},children:[""," ",n?d.jsx(H,{value:t.label||"",placeholder:"Embed label",onCommit:i=>r({label:i}),style:{display:"block",width:"100%",color:e.muted}}):t.label]}),n?d.jsx(nT,{html:t.html||"",placeholder:"Paste HTML here",onCommit:i=>r({html:i}),style:{border:`1px dashed ${e.border}`,borderRadius:10,padding:12,minHeight:60,background:e.background}}):d.jsx("div",{dangerouslySetInnerHTML:{__html:t.html}})]})}function fz({block:t,theme:e,editable:n,onUpdateBlock:r}){return d.jsxs("div",{style:ht(28,40),children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent,marginBottom:8},children:" Prompt Like a Rockstar"}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 6px",fontWeight:400},children:n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:i=>r({heading:i}),style:{display:"block",width:"100%"}}):t.heading}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,marginBottom:20},children:n?d.jsxs(d.Fragment,{children:[d.jsx(H,{value:t.step||"",placeholder:"Step",onCommit:i=>r({step:i}),style:{display:"block",width:"100%",color:e.muted}}),"  Framework: ",d.jsx("strong",{children:d.jsx(H,{value:t.framework||"",placeholder:"Framework",onCommit:i=>r({framework:i}),style:{display:"block",width:"100%"}})})]}):d.jsxs(d.Fragment,{children:[t.step,"  Framework: ",d.jsx("strong",{children:t.framework})]})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[d.jsxs("div",{style:{border:"1px solid #f5c6c0",borderRadius:12,padding:16,background:"#FEF0EE"},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"#C0392B",marginBottom:8},children:" Bad Prompt"}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,fontStyle:"italic",color:"#7A1E12",margin:0,lineHeight:1.55},children:n?d.jsx(H,{value:t.badPrompt||"",placeholder:"Bad prompt",multiline:!0,onCommit:i=>r({badPrompt:i}),style:{minHeight:18,color:"#7A1E12"}}):t.badPrompt})]}),d.jsxs("div",{style:{border:`1px solid ${e.accent}44`,borderRadius:12,padding:16,background:e.accent+"0D"},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:e.accent,marginBottom:8},children:" Good Prompt"}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.text,margin:0,lineHeight:1.55},children:n?d.jsx(H,{value:t.goodPrompt||"",placeholder:"Good prompt",multiline:!0,onCommit:i=>r({goodPrompt:i}),style:{minHeight:18}}):t.goodPrompt})]})]}),d.jsx("div",{style:{marginTop:14,padding:"12px 16px",background:e.background,borderRadius:10,borderLeft:`3px solid ${e.accent}`},children:d.jsxs("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.muted,margin:0,lineHeight:1.6},children:[d.jsx("strong",{children:"Why this matters:"})," ",n?d.jsx(H,{value:t.explanation||"",placeholder:"Explanation",multiline:!0,onCommit:i=>r({explanation:i}),style:{minHeight:18,color:e.muted}}):t.explanation]})})]})}function pz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=[e.primary,e.secondary,e.accent,"#7B2D8B","#00A651"],o=(s,l)=>{const a=(t.steps||[]).map((c,u)=>u===s?{...c,...l}:c);r({steps:a})};return d.jsxs("div",{style:ht(28,40),children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent,marginBottom:8},children:" SBAR-P Framework"}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 20px",fontWeight:400},children:n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:s=>r({heading:s}),style:{display:"block",width:"100%"}}):t.heading}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:12,marginBottom:20},children:(t.steps||[]).map((s,l)=>d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:10,padding:14,background:e.surface},children:[d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:64,fontWeight:400,color:i[l]||e.primary,lineHeight:1,marginBottom:6,fontStyle:"italic"},children:s.letter}),d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:9,letterSpacing:"0.14em",textTransform:"uppercase",color:e.muted,marginBottom:8,paddingBottom:8,borderBottom:`2px solid ${i[l]||e.primary}`},children:n?d.jsx(H,{value:s.name||"",placeholder:"Step name",onCommit:a=>o(l,{name:a}),style:{display:"block",width:"100%",color:e.muted}}):s.name}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:12,color:e.text,margin:"0 0 10px",lineHeight:1.5},children:n?d.jsx(H,{value:s.description||"",placeholder:"Description",multiline:!0,onCommit:a=>o(l,{description:a}),style:{minHeight:18}}):s.description}),d.jsx("div",{style:{background:e.background,borderRadius:6,padding:"8px 10px",borderLeft:`3px solid ${i[l]||e.primary}`},children:d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:11,color:e.muted,margin:0,fontStyle:"italic",lineHeight:1.45},children:n?d.jsx(H,{value:s.example||"",placeholder:"Example",multiline:!0,onCommit:a=>o(l,{example:a}),style:{minHeight:18,color:e.muted}}):s.example})})]},s.letter))})]})}function hz({block:t,theme:e,editable:n,onUpdateBlock:r}){const[i,o]=S.useState(!1),s=()=>{navigator.clipboard.writeText(t.prompt||"").then(()=>{o(!0),setTimeout(()=>o(!1),1600)})};return d.jsx("div",{style:ht(28,40),children:d.jsxs("details",{style:{border:`1px solid ${e.border}`,borderRadius:12,overflow:"hidden",background:e.surface},children:[d.jsxs("summary",{style:{listStyle:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,padding:"12px 14px",userSelect:"none"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent},children:" Template Prompt"}),d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:18,color:e.text,fontWeight:500},children:n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:l=>r({heading:l})}):t.heading})]}),d.jsx("button",{type:"button",onClick:l=>{l.preventDefault(),l.stopPropagation(),s()},style:{padding:"7px 12px",background:i?e.accent:e.primary,border:"none",borderRadius:8,fontFamily:e.fontBody,fontSize:12,color:"#fff",cursor:"pointer",whiteSpace:"nowrap"},children:i?" Copied":" Copy"})]}),d.jsx("div",{style:{padding:"12px 14px",background:e.background,borderTop:`1px solid ${e.border}`},children:d.jsx("pre",{style:{fontFamily:e.fontMono,fontSize:12,color:e.text,margin:0,whiteSpace:"pre-wrap",lineHeight:1.6},children:n?d.jsx(H,{value:t.prompt||"",placeholder:"Template prompt",multiline:!0,onCommit:l=>r({prompt:l}),style:{minHeight:140,fontFamily:e.fontMono,fontSize:12}}):t.prompt})})]})})}function mz({block:t,theme:e}){const n=(t.items||[]).filter(Boolean);return d.jsx("div",{style:ht(18,40),children:d.jsxs("div",{style:{border:"1px solid #F4D38B",background:"#FFF7E6",borderRadius:12,padding:14},children:[d.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"#8A5A00"},children:[" ",t.heading||"Safety Reminders"]})}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:n.length<=2?"1fr":"1fr 1fr",gap:10},children:n.map((r,i)=>d.jsxs("div",{style:{background:"rgba(255,255,255,0.65)",border:`1px solid ${e.border}`,borderRadius:10,padding:12,display:"flex",gap:10},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:11,color:"#8A5A00",marginTop:1},children:""}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:13,color:e.text,lineHeight:1.6},children:r})]},i))})]})})}function gz({block:t,theme:e}){const[n,r]=S.useState(null),[i,o]=S.useState(null),s=a=>{navigator.clipboard.writeText(a.prompt).then(()=>{r(a.id),setTimeout(()=>r(null),2e3)})},l={"Differential Diagnosis":e.primary,"Discharge Summary":e.secondary,"Literature Review":e.accent,"Patient Education":"#00A651","EEG / EMG Report":"#7B2D8B",Research:"#F47920"};return d.jsxs("div",{style:ht(28,40),children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent,marginBottom:8},children:" Ready-to-Use Prompts"}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 6px",fontWeight:400},children:t.heading}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:"0 0 20px"},children:t.description}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:(t.templates||[]).map(a=>{const c=i===a.id,u=n===a.id,f=l[a.category]||e.primary;return d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:10,overflow:"hidden",background:e.surface,transition:"box-shadow 0.15s"},children:[d.jsx("div",{style:{padding:"12px 14px",borderBottom:c?`1px solid ${e.border}`:"none"},children:d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8},children:[d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:9,letterSpacing:"0.12em",textTransform:"uppercase",color:"#fff",padding:"2px 7px",background:f,borderRadius:999},children:a.category})}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:13,fontWeight:600,color:e.text,marginBottom:3},children:a.title}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:11,color:e.muted},children:a.useCase})]}),d.jsxs("div",{style:{display:"flex",gap:4,flexShrink:0},children:[d.jsx("button",{onClick:()=>o(c?null:a.id),style:{padding:"5px 8px",background:"none",border:`1px solid ${e.border}`,borderRadius:6,fontFamily:e.fontBody,fontSize:11,color:e.muted,cursor:"pointer"},children:c?"Collapse":"Preview"}),d.jsx("button",{onClick:()=>s(a),style:{padding:"5px 10px",background:u?e.accent:e.primary,border:"none",borderRadius:6,fontFamily:e.fontBody,fontSize:11,color:"#fff",cursor:"pointer",transition:"background 0.2s",whiteSpace:"nowrap"},children:u?" Copied!":" Copy"})]})]})}),c&&d.jsx("div",{style:{padding:"10px 14px",background:e.background},children:d.jsx("pre",{style:{fontFamily:e.fontMono,fontSize:11,color:e.text,margin:0,whiteSpace:"pre-wrap",lineHeight:1.6},children:a.prompt})})]},a.id)})})]})}function yz({block:t,theme:e,editable:n,onUpdateBlock:r}){return d.jsxs("div",{style:ht(28,40),children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.accent,marginBottom:8},children:" AI Term of the Month"}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:34,color:e.text,margin:"0 0 20px",fontWeight:400},children:n?d.jsx(H,{value:t.term||"",placeholder:"Term",onCommit:i=>r({term:i}),style:{display:"block",width:"100%"}}):t.term}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[{title:"Definition",key:"definition",content:t.definition},{title:"Relevance to Practice",key:"relevance",content:t.relevance},{title:"Clinical Application",key:"clinicalApplication",content:t.clinicalApplication}].map(({title:i,key:o,content:s})=>d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:10,padding:16,background:e.surface},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.12em",textTransform:"uppercase",color:e.muted,marginBottom:8},children:i}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.text,margin:0,lineHeight:1.6},children:n?d.jsx(H,{value:s||"",placeholder:i,multiline:!0,onCommit:l=>r({[o]:l}),style:{minHeight:18}}):s})]},i))}),(t.relatedTerms||[]).length>0&&d.jsxs("div",{style:{marginTop:14,display:"flex",flexWrap:"wrap",gap:6},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:10,color:e.muted,textTransform:"uppercase",letterSpacing:"0.1em",alignSelf:"center"},children:"Related:"}),t.relatedTerms.map(i=>d.jsx("span",{style:{fontFamily:e.fontBody,fontSize:12,padding:"3px 10px",background:e.background,border:`1px solid ${e.border}`,borderRadius:999,color:e.muted},children:i},i))]})]})}function xz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=t.imageDataUrl||t.imageUrl;return d.jsx("div",{style:ht(28,40),children:d.jsxs("div",{style:{display:"flex",gap:24,alignItems:"flex-start"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,flexShrink:0},children:[d.jsxs("div",{style:{background:e.primary,borderRadius:10,padding:"14px 18px",textAlign:"center"},children:[d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:28,color:"#fff",lineHeight:1,textShadow:"0 1px 0 rgba(0,0,0,0.18)"},children:n?d.jsx(H,{value:t.year||"",placeholder:"Year",onCommit:o=>r({year:o}),style:{display:"block",width:"100%",color:"#fff"}}):t.year}),d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,color:"rgba(255,255,255,0.85)",letterSpacing:"0.12em",textTransform:"uppercase",marginTop:4},children:"AI Case File"})]}),i&&d.jsx("div",{style:{width:100,height:80,borderRadius:8,overflow:"hidden",border:`1px solid ${e.border}`},children:d.jsx("img",{src:i,alt:t.title,style:{width:"100%",height:"100%",objectFit:"cover"}})})]}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("h3",{style:{fontFamily:e.fontDisplay,fontSize:22,color:e.text,margin:"0 0 10px",fontWeight:400},children:n?d.jsx(H,{value:t.title||"",placeholder:"Title",onCommit:o=>r({title:o}),style:{display:"block",width:"100%"}}):t.title}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:"0 0 12px",lineHeight:1.65},children:n?d.jsx(H,{value:t.content||"",placeholder:"Content",multiline:!0,onCommit:o=>r({content:o}),style:{minHeight:18,color:e.muted}}):t.content}),t.significance&&d.jsx("div",{style:{background:e.background,borderRadius:8,padding:"10px 14px",borderLeft:`3px solid ${e.accent}`,marginBottom:12},children:d.jsxs("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.muted,margin:0,lineHeight:1.55},children:[d.jsx("strong",{children:"Significance:"})," ",t.significance]})}),(t.sourceUrl||t.sourceLabel)&&d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:11,color:e.muted},children:["Source: ",t.sourceUrl?d.jsx("a",{href:t.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{color:e.accent},children:t.sourceLabel||t.sourceUrl}):t.sourceLabel]})]})]})})}function vz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=(o,s)=>{const l=(t.hits||[]).map(a=>a.id===o?{...a,...s}:a);r({hits:l})};return d.jsxs("div",{style:ht(24,40),children:[d.jsxs("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 16px",fontWeight:400},children:[""," ",n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:o=>r({heading:o}),style:{display:"block",width:"100%"}}):t.heading]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:(t.hits||[]).map((o,s)=>d.jsxs("div",{style:{display:"flex",gap:14,alignItems:"flex-start",padding:"12px 14px",border:`1px solid ${e.border}`,borderRadius:10,background:e.surface},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:18,color:e.accent,lineHeight:1,flexShrink:0,minWidth:28},children:String(s+1).padStart(2,"0")}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:14,fontWeight:600,color:e.text,marginBottom:4,lineHeight:1.3},children:n?d.jsx(H,{value:o.title||"",placeholder:"Title",onCommit:l=>i(o.id,{title:l}),style:{display:"block",width:"100%"}}):o.url?d.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},children:o.title}):o.title}),d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,color:e.muted,letterSpacing:"0.1em",textTransform:"uppercase",marginBottom:4},children:n?d.jsx(H,{value:o.source||"",placeholder:"Source",onCommit:l=>i(o.id,{source:l}),style:{display:"block",width:"100%",color:e.muted}}):o.source}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.muted,margin:0,lineHeight:1.5},children:n?d.jsx(H,{value:o.summary||"",placeholder:"Summary",multiline:!0,onCommit:l=>i(o.id,{summary:l}),style:{minHeight:18,color:e.muted}}):o.summary})]}),o.url&&d.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",style:{flexShrink:0,fontFamily:e.fontBody,fontSize:11,color:e.accent,fontWeight:600,textDecoration:"none"},children:"Read "})]},o.id))})]})}function bz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=t.imageDataUrl||t.imageUrl,o=t.imageFit||"contain",s=t.imageHeight;return d.jsx("div",{style:ht(28,40),children:d.jsxs("div",{style:{background:`linear-gradient(135deg, ${e.background}, ${e.surface})`,border:`1px solid ${e.border}`,borderRadius:16,overflow:"hidden"},children:[d.jsxs("div",{style:{padding:"16px 18px",borderBottom:`1px solid ${e.border}`,display:"flex",alignItems:"center",gap:10},children:[d.jsx("span",{style:{fontSize:18},children:""}),d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:20,color:e.text,fontWeight:400},children:n?d.jsx(H,{value:t.heading||"Humor",placeholder:"Humor",onCommit:l=>r({heading:l}),style:{display:"block",width:"100%"}}):t.heading||"Humor"})]}),i&&d.jsxs("div",{style:{position:"relative"},children:[d.jsx("img",{src:i,alt:"Humor block",style:{width:"100%",display:"block",height:s?`${s}px`:"auto",objectFit:s?o:void 0}}),n&&d.jsxs("div",{style:{position:"absolute",bottom:8,right:8,display:"flex",gap:6,alignItems:"center",background:"rgba(0,0,0,0.55)",borderRadius:8,padding:"5px 10px"},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:10,color:"#fff",whiteSpace:"nowrap"},children:s?`${s}px`:"Auto"}),d.jsx("input",{type:"range",min:80,max:600,step:20,value:s||300,onChange:l=>r({imageHeight:Number(l.target.value)}),style:{width:80,accentColor:e.accent,cursor:"pointer"},title:"Drag to set image height"}),d.jsxs("select",{value:o,onChange:l=>r({imageFit:l.target.value}),style:{fontFamily:e.fontMono,fontSize:10,background:"rgba(255,255,255,0.15)",color:"#fff",border:"none",borderRadius:4,padding:"2px 4px",cursor:"pointer"},title:"Image fit mode",children:[d.jsx("option",{value:"contain",children:"Fit (show all)"}),d.jsx("option",{value:"cover",children:"Fill (crop edges)"}),d.jsx("option",{value:"fill",children:"Stretch"})]}),s&&d.jsx("button",{onClick:()=>r({imageHeight:void 0}),style:{fontFamily:e.fontMono,fontSize:10,background:"rgba(255,255,255,0.2)",color:"#fff",border:"none",borderRadius:4,padding:"2px 6px",cursor:"pointer"},title:"Reset to auto height (show full image)",children:"Auto "})]})]}),d.jsxs("div",{style:{padding:"18px 22px",textAlign:"center"},children:[!i&&d.jsx("div",{style:{fontSize:44,marginBottom:10},children:t.emojiDecor||""}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,marginBottom:10},children:n?d.jsx(H,{value:t.attribution||"",placeholder:"Short caption (optional)",onCommit:l=>r({attribution:l}),style:{display:"block",width:"100%",color:e.muted}}):t.attribution}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:16,color:e.text,fontStyle:"italic",lineHeight:1.65,maxWidth:760,margin:"0 auto"},children:n?d.jsx(H,{value:t.content||"",placeholder:"Punchline",multiline:!0,onCommit:l=>r({content:l}),style:{minHeight:18}}):t.content}),t.sourceUrl&&d.jsx("div",{style:{marginTop:10},children:d.jsx("a",{href:t.sourceUrl,target:"_blank",rel:"noopener noreferrer",style:{fontFamily:e.fontBody,fontSize:12,color:e.accent,textDecoration:"none"},children:"Source "})})]})]})})}function Sz({block:t,theme:e}){return d.jsx("div",{style:{height:t.height,borderTop:t.showLine?`1px ${t.lineStyle} ${e.border}`:"none",margin:t.showLine?"0 40px":0}})}function wz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i=(s,l)=>{const a=(t.updates||[]).map(c=>c.id===s?{...c,...l}:c);r({updates:a})},o={critical:{color:"#C0392B",bg:"#FEF0EE",border:"#f5c6c0",label:"CRITICAL",icon:""},high:{color:"#C06500",bg:"#FFF4E6",border:"#F6D860",label:"HIGH",icon:""},medium:{color:"#0057A8",bg:"#EEF4FF",border:"#C8D9EE",label:"MEDIUM",icon:""},informational:{color:"#005F6B",bg:"#F0FAFA",border:"#B2E0E4",label:"INFO",icon:""}};return d.jsxs("div",{style:ht(28,40),children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap",gap:10},children:[d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[d.jsx("span",{style:{fontSize:18},children:""}),d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:"#C0392B"},children:"AI Safety Monitor"})]}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 4px",fontWeight:400},children:n?d.jsx(H,{value:t.heading||"",placeholder:"Heading",onCommit:s=>r({heading:s}),style:{display:"block",width:"100%"}}):t.heading}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:0},children:n?d.jsx(H,{value:t.subheading||"",placeholder:"Subheading",multiline:!0,onCommit:s=>r({subheading:s}),style:{minHeight:18,color:e.muted}}):t.subheading})]}),t.showLastUpdated&&d.jsxs("div",{style:{fontFamily:e.fontMono,fontSize:10,color:e.muted,textAlign:"right",lineHeight:1.4},children:["Last updated",d.jsx("br",{}),new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:(t.updates||[]).map(s=>{const l=o[s.severity]||o.informational;return d.jsx("div",{style:{border:`1px solid ${l.border}`,borderRadius:10,background:l.bg,overflow:"hidden"},children:d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:"14px 16px"},children:[d.jsxs("div",{style:{flexShrink:0,display:"flex",flexDirection:"column",alignItems:"center",gap:4,paddingTop:2},children:[d.jsx("span",{style:{fontSize:14},children:l.icon}),d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:8,letterSpacing:"0.1em",textTransform:"uppercase",color:l.color,fontWeight:700},children:l.label})]}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:9,letterSpacing:"0.1em",textTransform:"uppercase",color:l.color,padding:"2px 7px",background:l.color+"18",borderRadius:999},children:n?d.jsx(H,{value:s.category||"",placeholder:"Category",onCommit:a=>i(s.id,{category:["FDA","Policy","Incident","Guideline","Alert","Research"].includes(a)?a:void 0}),style:{display:"block",width:"100%",color:l.color}}):s.category}),d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:10,color:e.muted},children:n?d.jsx(H,{value:s.date||"",placeholder:"Date",onCommit:a=>i(s.id,{date:a}),style:{display:"block",width:"100%",color:e.muted}}):s.date})]}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:14,fontWeight:600,color:e.text,marginBottom:4},children:n?d.jsx(H,{value:s.title||"",placeholder:"Title",onCommit:a=>i(s.id,{title:a}),style:{display:"block",width:"100%"}}):s.url?d.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},children:s.title}):s.title}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:13,color:e.muted,margin:0,lineHeight:1.55},children:n?d.jsx(H,{value:s.summary||"",placeholder:"Summary",multiline:!0,onCommit:a=>i(s.id,{summary:a}),style:{minHeight:18,color:e.muted}}):s.summary}),s.url&&d.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",marginTop:8,fontFamily:e.fontBody,fontSize:11,color:l.color,fontWeight:600},children:"View full guidance "})]})]})},s.id)})})]})}function kz({block:t,theme:e}){return d.jsxs("div",{style:ht(28,40),children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:6},children:[d.jsx("div",{style:{width:28,height:28,background:e.primary,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:d.jsx("span",{style:{fontSize:14},children:""})}),d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.18em",textTransform:"uppercase",color:e.primary},children:t.institutionLabel||"Your Institution"})]}),d.jsx("h2",{style:{fontFamily:e.fontDisplay,fontSize:26,color:e.text,margin:"0 0 4px",fontWeight:400},children:t.heading}),t.subheading&&d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:14,color:e.muted,margin:"0 0 20px"},children:t.subheading}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:14},children:(t.items||[]).slice(0,t.maxItems||6).map(n=>d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:10,overflow:"hidden",background:e.surface,display:"flex",flexDirection:"column"},children:[n.imageUrl&&d.jsx("div",{style:{height:120,overflow:"hidden"},children:d.jsx("img",{src:n.imageUrl,alt:n.title,style:{width:"100%",height:"100%",objectFit:"cover"}})}),d.jsxs("div",{style:{padding:14,flex:1,display:"flex",flexDirection:"column"},children:[n.category&&d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:9,letterSpacing:"0.12em",textTransform:"uppercase",color:e.accent,marginBottom:6,display:"block"},children:n.category}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:13,fontWeight:600,color:e.text,marginBottom:6,lineHeight:1.35,flex:1,minWidth:0},children:n.url?d.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},children:n.title}):n.title}),n.summary&&d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:12,color:e.muted,margin:"0 0 8px",lineHeight:1.5},children:n.summary}),n.pubDate&&d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,color:e.muted},children:new Date(n.pubDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),n.url&&d.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",style:{marginTop:8,fontFamily:e.fontBody,fontSize:11,color:e.accent,fontWeight:600,textDecoration:"none"},children:"Read more "})]})]},n.id))})]})}function Cz({block:t,theme:e,editable:n,onUpdateBlock:r}){const i="https://api.allorigins.win/get?url=",[o,s]=S.useState(t.items||[]),[l,a]=S.useState(t.lastFetched||""),c=S.useCallback((p,h)=>{try{const g=new DOMParser().parseFromString(p,"text/xml");if(g.querySelector("parsererror"))return[];const v=Array.from(g.querySelectorAll("item"));return v.length?v.map(x=>{var b,w,C,E,k,M,$,O;return{title:((w=(b=x.querySelector("title"))==null?void 0:b.textContent)==null?void 0:w.trim())||"",url:((E=(C=x.querySelector("link"))==null?void 0:C.textContent)==null?void 0:E.trim())||"",pubDate:((M=(k=x.querySelector("pubDate"))==null?void 0:k.textContent)==null?void 0:M.trim())||"",source:((O=($=x.querySelector("source"))==null?void 0:$.textContent)==null?void 0:O.trim())||h}}).filter(x=>!!x.title):Array.from(g.querySelectorAll("entry")).map(x=>{var b,w,C,E,k,M,$,O,_,oe,ae;return{title:((w=(b=x.querySelector("title"))==null?void 0:b.textContent)==null?void 0:w.trim())||"",url:((C=x.querySelector("link"))==null?void 0:C.getAttribute("href"))||((k=(E=x.querySelector("link"))==null?void 0:E.textContent)==null?void 0:k.trim())||"",pubDate:(($=(M=x.querySelector("updated"))==null?void 0:M.textContent)==null?void 0:$.trim())||((_=(O=x.querySelector("published"))==null?void 0:O.textContent)==null?void 0:_.trim())||"",source:((ae=(oe=g.querySelector("feed > title"))==null?void 0:oe.textContent)==null?void 0:ae.trim())||h}}).filter(x=>!!x.title)}catch{return[]}},[]);S.useEffect(()=>{let p=!1;async function h(){if(!t.refreshOnView)return;const m=(t.feedUrls||[]).filter(Boolean);if(!m.length||typeof navigator<"u"&&navigator.onLine===!1)return;const g=[];for(const b of m)try{const w=await fetch(i+encodeURIComponent(b),{cache:"no-store"});if(!w.ok)continue;const C=await w.json(),E=C&&typeof C.contents=="string"?C.contents:"";g.push(...c(E,b))}catch{}const v=new Set,y=g.filter(b=>!b.url||v.has(b.url)?!1:(v.add(b.url),!0));y.sort((b,w)=>(Date.parse(w.pubDate)||0)-(Date.parse(b.pubDate)||0));const x=new Date().toISOString();p||(s(y),a(x),n&&r({items:y,lastFetched:x}))}return h(),()=>{p=!0}},[i,t.feedUrls,t.refreshOnView,n,r,c]);const u=t.refreshOnView?o:t.items||[],f=t.refreshOnView?l:t.lastFetched||"";return d.jsx("div",{className:"nap-rss-sidebar",style:{padding:"24px 40px"},children:d.jsx("div",{className:"nap-rss-config",children:d.jsxs("div",{style:{border:`1px solid ${e.border}`,borderRadius:12,overflow:"hidden",background:e.surface},children:[d.jsxs("div",{style:{background:e.primary,padding:"12px 18px",display:"flex",alignItems:"center",gap:8},children:[d.jsx("span",{style:{fontSize:14},children:""}),d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:11,letterSpacing:"0.14em",textTransform:"uppercase",color:"rgba(255,255,255,0.9)"},children:t.heading}),f&&d.jsxs("span",{style:{marginLeft:"auto",fontFamily:e.fontMono,fontSize:9,color:"rgba(255,255,255,0.5)"},children:["Updated ",new Date(f).toLocaleDateString()]})]}),d.jsx("div",{className:"nap-rss-scroll",style:{maxHeight:t.enableScroll?420:"none",overflowY:t.enableScroll?"auto":"visible"},children:(u||[]).length===0?d.jsx("div",{style:{padding:"24px 18px",textAlign:"center",color:e.muted,fontFamily:e.fontBody,fontSize:13},children:"No feed items yet  configure feeds in Block Settings and refresh."}):(u||[]).slice(0,t.maxItems||8).map((p,h)=>d.jsxs("div",{style:{padding:"11px 18px",borderBottom:`1px solid ${e.border}`,display:"flex",gap:10,alignItems:"flex-start"},children:[d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:12,color:e.accent,flexShrink:0,minWidth:20,marginTop:1},children:String(h+1).padStart(2,"0")}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:13,fontWeight:600,color:e.text,lineHeight:1.3,marginBottom:3},children:p.url?d.jsx("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",style:{color:e.text,textDecoration:"none"},onMouseEnter:m=>m.currentTarget.style.color=e.accent,onMouseLeave:m=>m.currentTarget.style.color=e.text,children:p.title}):p.title}),d.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[p.source&&d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:9,color:e.muted,textTransform:"uppercase",letterSpacing:"0.08em"},children:p.source}),p.pubDate&&d.jsx("span",{style:{fontFamily:e.fontMono,fontSize:9,color:e.muted},children:new Date(p.pubDate).toLocaleDateString()})]})]}),p.url&&d.jsx("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",style:{flexShrink:0,fontFamily:e.fontBody,fontSize:11,color:e.accent,fontWeight:600,textDecoration:"none",paddingTop:1},children:""})]},h))})]})})})}function Ez({block:t,theme:e}){const n=t.contactEmail?`mailto:${t.contactEmail}?subject=${encodeURIComponent("Newsletter Feedback")}`:"#";return d.jsxs("div",{className:"nap-white-section",style:{background:e.primary,padding:"44px 40px 36px",textAlign:"center",color:"#fff"},children:[(t.nextIssueDate||t.nextIssueTeaser)&&d.jsxs("div",{style:{background:"rgba(255,255,255,0.12)",borderRadius:10,padding:"14px 20px",marginBottom:28,display:"inline-block"},children:[d.jsx("div",{style:{fontFamily:e.fontMono,fontSize:10,letterSpacing:"0.14em",textTransform:"uppercase",color:"rgba(255,255,255,0.75)",marginBottom:4},children:"Next Issue"}),d.jsxs("div",{style:{fontFamily:e.fontBody,fontSize:14,color:"#fff"},children:[t.nextIssueDate,t.nextIssueTeaser?`  ${t.nextIssueTeaser}`:""]})]}),d.jsx("div",{style:{fontFamily:e.fontDisplay,fontSize:22,color:"#fff",marginBottom:4,fontWeight:400},children:t.institution}),d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:14,color:"rgba(255,255,255,0.85)",marginBottom:4},children:t.department}),t.editors&&d.jsx("div",{style:{fontFamily:e.fontBody,fontSize:13,color:"rgba(255,255,255,0.75)",marginBottom:22},children:t.editors}),d.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:22},children:d.jsxs("a",{href:n,style:{display:"inline-flex",alignItems:"center",gap:10,fontFamily:e.fontBody,fontSize:13,fontWeight:700,color:"#fff",textDecoration:"none",padding:"10px 16px",borderRadius:12,border:"1px solid rgba(255,255,255,0.35)",background:"rgba(255,255,255,0.10)"},children:["Contact Us",d.jsx("span",{style:{opacity:.8},children:""})]})}),d.jsx("div",{style:{height:1,background:"rgba(255,255,255,0.18)",maxWidth:240,margin:"0 auto 18px"}}),d.jsx("p",{style:{fontFamily:e.fontBody,fontSize:11,color:"rgba(255,255,255,0.75)",margin:"0 0 8px",maxWidth:580,marginLeft:"auto",marginRight:"auto",lineHeight:1.6},children:t.disclaimer}),d.jsxs("p",{style:{fontFamily:e.fontMono,fontSize:10,color:"rgba(255,255,255,0.65)",margin:0,letterSpacing:"0.1em"},children:[" ",t.copyrightYear," ",t.institution]})]})}function lx({block:t,theme:e,newsletter:n,editable:r,onUpdateBlock:i,onUpdateArticle:o,onDeleteArticle:s,onMoveArticle:l,onAddArticle:a}){const c={theme:e,newsletter:n,editable:r,onUpdateBlock:i},u={onUpdateArticle:(f,p)=>o(t.id,f,p),onDeleteArticle:f=>s(t.id,f),onMoveArticle:(f,p)=>l(t.id,f,p),onAddArticle:()=>a(t.id)};switch(t.type){case"header":return d.jsx(nz,{block:t,...c});case"ticker":return d.jsx(rz,{block:t,...c});case"section-divider":return d.jsx(iz,{block:t,...c});case"article-grid":return d.jsx(oz,{block:t,...c,...u});case"spotlight":return d.jsx(lz,{block:t,...c,...u});case"ethics-split":return d.jsx(az,{block:t,...c});case"image":return d.jsx(cz,{block:t,...c});case"text":return d.jsx(dz,{block:t,...c});case"html-embed":return d.jsx(uz,{block:t,...c});case"prompt-masterclass":return d.jsx(fz,{block:t,...c});case"sbar-prompt":return d.jsx(pz,{block:t,...c});case"prompt-template":return d.jsx(hz,{block:t,...c});case"safety-reminders":return d.jsx(mz,{block:t,...c});case"clinical-prompt-templates":return d.jsx(gz,{block:t,...c});case"term-of-month":return d.jsx(yz,{block:t,...c});case"ai-case-file":return d.jsx(xz,{block:t,...c});case"quick-hits":return d.jsx(vz,{block:t,...c});case"humor":return d.jsx(bz,{block:t,...c});case"spacer":return d.jsx(Sz,{block:t,...c});case"footer":return d.jsx(Ez,{block:t,...c});case"ai-safety":return d.jsx(wz,{block:t,...c});case"institutional-spotlight":return d.jsx(kz,{block:t,...c});case"rss-sidebar":return d.jsx(Cz,{block:t,...c});default:return d.jsxs("div",{style:{padding:16,fontFamily:"monospace",fontSize:12,color:"#999"},children:["Unknown block: ",t.type]})}}function ax({newsletter:t,editorState:e,isMobile:n,onSelectBlock:r,onMoveBlock:i,onDeleteBlock:o,onDuplicateBlock:s,onAddBlock:l,onUpdateBlock:a,onUpdateArticle:c,onDeleteArticle:u,onMoveArticle:f,onAddArticle:p}){const{blockOrder:h,blocks:m,theme:g}=t,{selectedBlockId:v,previewMode:y,zoom:x}=e,b=AE(Mg(fh,{activationConstraint:{distance:6}}),Mg(dh)),w=S.useCallback(M=>{const{active:$,over:O}=M;if(!O||$.id===O.id)return;const _=h.indexOf(String($.id)),oe=h.indexOf(String(O.id));_!==-1&&oe!==-1&&i(_,oe)},[h,i]),C=n?100:x,E=n?void 0:800,k=C/100;return d.jsx("div",{className:n?"nap-canvas-scroll":"",style:{flex:1,overflow:"auto",background:"var(--color-bg)",display:"flex",flexDirection:"column",alignItems:"center",padding:n?y?"0 0 70px":"12px 0 80px":y?"32px 0":"24px 0 80px",WebkitOverflowScrolling:"touch"},children:d.jsx("div",{style:{width:E?E*k:"100%",transformOrigin:"top center",transform:k!==1?`scale(${k})`:void 0,marginBottom:k<1?`calc((${k} - 1) * 100%)`:0,maxWidth:n?"100%":void 0},children:d.jsxs("div",{id:"nap-paper",style:{width:n?"100%":E,background:g.surface,boxShadow:y||n?"none":"0 0 0 1px rgba(0,0,0,0.05), 0 8px 40px rgba(0,0,0,0.12)",borderRadius:y||n?0:12,overflow:"hidden",minHeight:400},children:[d.jsx($M,{sensors:b,collisionDetection:OE,onDragEnd:w,children:d.jsx(qM,{items:h,strategy:WM,children:h.map((M,$)=>{const O=m[M];return O?d.jsx(Mz,{id:M,block:O,idx:$,total:h.length,selected:v===M,previewMode:y,isMobile:n,theme:t.theme,newsletter:t,onSelect:()=>r(v===M?null:M),onDelete:()=>o(M),onDuplicate:()=>s(M),onMoveUp:()=>i($,$-1),onMoveDown:()=>i($,$+1),onAddAfter:_=>l(_,M),onUpdateBlock:_=>a(M,_),onUpdateArticle:c,onDeleteArticle:u,onMoveArticle:f,onAddArticle:p},M):null})})}),h.length===0&&d.jsxs("div",{style:{padding:80,textAlign:"center",color:"var(--color-muted)",fontFamily:"var(--font-body)"},children:[d.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),d.jsx("div",{style:{fontSize:18,fontFamily:"var(--font-display)",marginBottom:8},children:"Empty newsletter"}),d.jsx("div",{style:{fontSize:14},children:"Use the Blocks panel to add your first block."})]})]})})})}function Mz({id:t,block:e,idx:n,total:r,selected:i,previewMode:o,isMobile:s,theme:l,newsletter:a,onSelect:c,onDelete:u,onDuplicate:f,onMoveUp:p,onMoveDown:h,onAddAfter:m,onUpdateBlock:g,onUpdateArticle:v,onDeleteArticle:y,onMoveArticle:x,onAddArticle:b}){const{attributes:w,listeners:C,setNodeRef:E,transform:k,transition:M,isDragging:$}=eT({id:t}),O={transform:_s.Transform.toString(k),transition:M,opacity:$?.4:1,position:"relative"};return o?d.jsx("div",{ref:E,style:O,children:d.jsx(lx,{block:e,theme:l,newsletter:a,editable:!1,onUpdateBlock:g,onUpdateArticle:v,onDeleteArticle:y,onMoveArticle:x,onAddArticle:b})}):d.jsxs("div",{ref:E,style:O,children:[d.jsxs("div",{onClick:c,style:{position:"relative",cursor:"pointer",outline:i?"2px solid var(--color-accent)":"2px solid transparent",outlineOffset:-2,transition:"outline 0.1s"},children:[d.jsx(lx,{block:e,theme:l,newsletter:a,editable:i,onUpdateBlock:g,onUpdateArticle:v,onDeleteArticle:y,onMoveArticle:x,onAddArticle:b}),i&&d.jsxs("div",{onClick:_=>_.stopPropagation(),style:{position:"absolute",top:6,right:6,display:"flex",alignItems:"center",gap:s?6:4,background:"var(--color-primary)",borderRadius:8,padding:s?"6px 8px":"4px 6px",boxShadow:"0 4px 16px rgba(0,0,0,0.2)",zIndex:10},children:[d.jsx(Tz,{block:e}),d.jsx("div",{style:{width:1,height:16,background:"rgba(255,255,255,0.2)",margin:"0 2px"}}),d.jsx(_o,{icon:d.jsx(h2,{size:12}),onClick:p,disabled:n===0,title:"Move up"}),d.jsx(_o,{icon:d.jsx(A1,{size:12}),onClick:h,disabled:n===r-1,title:"Move down"}),d.jsx(_o,{icon:d.jsx(m2,{size:12}),onClick:f,title:"Duplicate"}),d.jsx(_o,{icon:d.jsx(R1,{size:12}),onClick:c,title:"Settings",highlight:!0}),d.jsx(_o,{icon:d.jsx(wo,{size:12}),onClick:()=>{confirm("Delete this block?")&&u()},title:"Delete",danger:!0})]}),i&&!s&&d.jsx("div",{...w,...C,onClick:_=>_.stopPropagation(),style:{position:"absolute",top:6,left:6,background:"var(--color-primary)",borderRadius:6,padding:"4px 6px",cursor:"grab",color:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",zIndex:10},title:"Drag to reorder",children:d.jsx(S2,{size:14})})]}),i&&d.jsx(jz,{onAdd:m})]})}function Tz({block:t}){const e=Mf[t.type]||t.type,n=e.split("  ")[0],r=e.split("  ").slice(1).join("").trim();return d.jsxs("span",{style:{fontFamily:"var(--font-mono)",fontSize:10,color:"rgba(255,255,255,0.7)",letterSpacing:"0.1em",textTransform:"uppercase"},children:[n," ",r]})}function _o({icon:t,onClick:e,disabled:n,title:r,highlight:i,danger:o}){return d.jsx("button",{onClick:e,disabled:n,title:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:26,height:26,background:o?"rgba(192,57,43,0.4)":i?"rgba(0,156,222,0.5)":"rgba(255,255,255,0.12)",border:"none",borderRadius:6,color:"#fff",cursor:n?"not-allowed":"pointer",opacity:n?.4:1,transition:"background 0.12s"},onMouseEnter:s=>{n||(s.currentTarget.style.background=o?"rgba(192,57,43,0.65)":"rgba(255,255,255,0.25)")},onMouseLeave:s=>{s.currentTarget.style.background=o?"rgba(192,57,43,0.4)":i?"rgba(0,156,222,0.5)":"rgba(255,255,255,0.12)"},children:t})}function jz({onAdd:t}){const[e,n]=ee.useState(!1),r=[{type:"article-grid",label:" Article Grid"},{type:"spotlight",label:" Spotlight"},{type:"text",label:" Text"},{type:"image",label:" Image"},{type:"section-divider",label:" Divider"},{type:"spacer",label:" Spacer"},{type:"quick-hits",label:" Quick Hits"},{type:"ai-safety",label:" AI Safety"},{type:"institutional-spotlight",label:" Institutional"},{type:"rss-sidebar",label:" RSS Feed"},{type:"prompt-template",label:" Template Prompt"},{type:"safety-reminders",label:" Safety Reminders"},{type:"clinical-prompt-templates",label:" Prompts"},{type:"html-embed",label:" HTML"}];return d.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:32,zIndex:5},children:[d.jsx("div",{style:{position:"absolute",left:0,right:0,top:"50%",height:1,background:"var(--color-accent)",opacity:.3}}),d.jsxs("button",{onClick:i=>{i.stopPropagation(),n(o=>!o)},style:{position:"relative",display:"flex",alignItems:"center",gap:5,padding:"4px 12px",background:"var(--color-accent)",border:"none",borderRadius:999,color:"#fff",fontSize:11,fontFamily:"var(--font-body)",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[d.jsx(Pr,{size:11})," Add block here"]}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:4,background:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:10,boxShadow:"0 8px 32px rgba(0,0,0,0.15)",zIndex:100,padding:8,display:"flex",flexWrap:"wrap",gap:4,width:340},onClick:i=>i.stopPropagation(),children:r.map(({type:i,label:o})=>d.jsx("button",{onClick:()=>{t(i),n(!1)},style:{padding:"6px 10px",background:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:6,fontFamily:"var(--font-body)",fontSize:12,color:"var(--color-text)",cursor:"pointer"},onMouseEnter:s=>{s.currentTarget.style.borderColor="var(--color-accent)"},onMouseLeave:s=>{s.currentTarget.style.borderColor="var(--color-border)"},children:o},i))})]})}function cx(){return(window.location.hash||"").startsWith("#/preview")}function Dz(){const t=()=>({isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024}),[e,n]=S.useState(t);return S.useEffect(()=>{const r=()=>n(t());return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),e}function Az(){const{newsletter:t,load:e,addBlock:n,deleteBlock:r,updateBlock:i,moveBlock:o,duplicateBlock:s,updateTheme:l,updateMeta:a,addArticle:c,updateArticle:u,deleteArticle:f,moveArticle:p,addQuickHit:h,updateQuickHit:m,deleteQuickHit:g}=o2(),{autosave:v,loadAutosave:y,saveVersion:x,deleteVersion:b,versions:w,importJSON:C}=s2(),E=u2(),{isMobile:k,isTablet:M}=Dz(),[$,O]=S.useState(null),[_,oe]=S.useState(cx()),[ae,me]=S.useState(!1),[Oe,Ee]=S.useState({selectedBlockId:null,activePanel:"blocks",previewMode:!1,zoom:100}),[ue,N]=S.useState(""),[U,W]=S.useState("");S.useEffect(()=>{n2(t.theme)},[t.theme]),S.useEffect(()=>{!k&&!M&&me(!1)},[k,M]),S.useEffect(()=>{const q=()=>oe(cx());return window.addEventListener("hashchange",q),()=>window.removeEventListener("hashchange",q)},[]),S.useEffect(()=>{if(_){if(window.__NAP_NEWSLETTER__){O(window.__NAP_NEWSLETTER__),e(window.__NAP_NEWSLETTER__);return}fetch("./newsletter.json",{cache:"no-store"}).then(q=>q.ok?q.json():Promise.reject(new Error(`HTTP ${q.status}`))).then(q=>{O(q),e(q)}).catch(()=>O(null))}},[_,e]),S.useEffect(()=>{if(_)return;const q=y();q&&(e(q),N("Loaded autosave"))},[]),l2(t,q=>{_||v(q)});const X=S.useCallback(q=>{W(q),setTimeout(()=>W(""),3e3)},[]),Z=S.useCallback(()=>{v(t),N(new Date().toLocaleTimeString()),X("Saved ")},[t,v,X]),tt=S.useCallback(()=>{const q=prompt("Version name (optional):")||void 0;x(t,q),X("Version saved")},[t,x,X]),Ue=S.useCallback(async q=>{try{const Se=await C(q);e(Se),X("Imported ")}catch(Se){X(`Import failed: ${Se.message}`)}},[C,e,X]),tn=S.useCallback(q=>{Ee(Se=>({...Se,activePanel:q})),(k||M)&&me(!0)},[k,M]),ye=S.useCallback(q=>{Ee(Se=>({...Se,selectedBlockId:q})),q&&(k||M)&&(Ee(Se=>({...Se,selectedBlockId:q,activePanel:"blocks"})),me(!0))},[k,M]),nn=S.useCallback(()=>Ee(q=>({...q,previewMode:!q.previewMode,selectedBlockId:null})),[]),mn=S.useCallback(q=>Ee(Se=>({...Se,zoom:q})),[]),Ft=_||Oe.previewMode;if(_)return $?d.jsx("div",{style:{height:"100vh",background:"var(--color-bg)",fontFamily:"var(--font-body)",overflow:"auto"},children:d.jsx(ax,{newsletter:t,editorState:{...Oe,previewMode:!0,selectedBlockId:null,zoom:100},isMobile:k,onSelectBlock:()=>{},onMoveBlock:()=>{},onDeleteBlock:()=>{},onDuplicateBlock:()=>{},onAddBlock:()=>{},onUpdateBlock:()=>{},onUpdateArticle:()=>{},onDeleteArticle:()=>{},onMoveArticle:()=>{},onAddArticle:()=>{}})}):d.jsxs("div",{style:{padding:24,fontFamily:"var(--font-body)",background:"var(--color-bg)",minHeight:"100vh"},children:[d.jsx("h2",{style:{margin:0},children:"Preview not available"}),d.jsx("p",{style:{opacity:.8},children:"Could not load newsletter.json. Place it next to index.html in your hosted folder."})]});const ie={newsletter:t,editorState:Oe,rss:E,versions:w,isMobile:k,isTablet:M,drawerOpen:ae,onCloseDrawer:()=>me(!1),onSetPanel:tn,onAddBlock:n,onSelectBlock:ye,onUpdateBlock:i,onUpdateTheme:l,onRestoreVersion:q=>{e(q.newsletter),X("Version restored")},onDeleteVersion:b,onAddArticle:c,onUpdateArticle:u,onDeleteArticle:f,onAddQuickHit:h,onUpdateQuickHit:m,onDeleteQuickHit:g};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",background:"var(--color-bg)",fontFamily:"var(--font-body)",overflow:"hidden"},children:[d.jsx(LC,{newsletter:t,editorState:Oe,lastSaved:ue,isMobile:k,isTablet:M,drawerOpen:ae,onToggleDrawer:()=>me(q=>!q),onSave:Z,onSaveVersion:tt,onImport:Ue,onTogglePreview:nn,onZoomChange:mn,onUpdateMeta:a}),d.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden",position:"relative"},children:[!Ft&&d.jsx(dE,{...ie}),d.jsx(ax,{newsletter:t,editorState:{...Oe,previewMode:Ft},isMobile:k,onSelectBlock:ye,onMoveBlock:o,onDeleteBlock:r,onDuplicateBlock:s,onAddBlock:n,onUpdateBlock:i,onUpdateArticle:u,onDeleteArticle:f,onMoveArticle:p,onAddArticle:c}),ae&&(k||M)&&d.jsx("div",{className:"nap-drawer-scrim",onClick:()=>me(!1)})]}),U&&d.jsx("div",{style:{position:"fixed",bottom:k?72:24,right:24,zIndex:9999,background:"var(--color-primary)",color:"#fff",padding:"12px 20px",borderRadius:12,fontFamily:"var(--font-body)",fontSize:14,boxShadow:"0 8px 32px rgba(0,0,0,0.25)",animation:"fadeInUp 0.2s ease"},children:U})]})}Mu.createRoot(document.getElementById("root")).render(d.jsx(ee.StrictMode,{children:d.jsx(Az,{})}));
